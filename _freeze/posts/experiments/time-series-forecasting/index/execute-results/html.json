{
  "hash": "107c7c0077a17ba347ccffe560c20c3e",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: Time Series Forecasting with Prophet\nsubtitle: predicting the future with machine learning\ndate: 2024-04-20\ntags: \n  - Experiments\n  - Time Series Analysis\n  - Forecasting\n  - Prophet\n  - Machine Learning\ncategories:\n    - Experiments\n    - Time Series Analysis\n    - Machine Learning\njupyter: python3\n---\n\n\nForecasting future trends is a common application in time series analysis. In this experiment, we will use [Meta's Prophet](https://facebook.github.io/prophet/) library to predict trends for births in Malaysia, based on available public data. Prophet is a forecasting tool developed by Meta that is available in Python and R. It is designed for analyzing time series data with daily observations that display patterns on different time scales.\n\nProphet handles missing data, shifts in the trend, and large outliers in a robust manner. It provides a straightforward way to include the effects of holidays and seasonality in the forecast. It decomposes time series data into trend, seasonality, and holiday effects, making it easy to understand the impact of these components on the forecast.\n\nIn this experiment, we will incorporate additional regressors, such as temperature and pollutant levels, to see how these factors influence birth rates. The approach allows us to account for external variables that might affect the trend and seasonality of births.\n\n## Load the datasets\n\nWe will be using public Kaggle datasets, one containing weather data for Malaysia, and the other containing the number of births.\n\n::: {#fbf55edd .cell execution_count=2}\n``` {.python .cell-code}\n# Download https://www.kaggle.com/datasets/shahmirvarqha/weather-data-malaysia?select=full-weather.csv using the Kaggle API\n\n!kaggle datasets download -p .data/ shahmirvarqha/weather-data-malaysia --unzip\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nDataset URL: https://www.kaggle.com/datasets/shahmirvarqha/weather-data-malaysia\r\nLicense(s): Attribution 4.0 International (CC BY 4.0)\r\nDownloading weather-data-malaysia.zip to .data\r\n\r  0%|                                                | 0.00/311M [00:00<?, ?B/s]\r  0%|▏                                      | 1.00M/311M [00:00<01:59, 2.71MB/s]\r  1%|▎                                      | 2.00M/311M [00:00<01:11, 4.50MB/s]\r  1%|▍                                      | 3.00M/311M [00:00<00:57, 5.60MB/s]\r  1%|▌                                      | 4.00M/311M [00:00<00:51, 6.26MB/s]\r  2%|▋                                      | 5.00M/311M [00:00<00:46, 6.87MB/s]\r  2%|▊                                      | 6.00M/311M [00:01<00:43, 7.40MB/s]\r  2%|▉                                      | 7.00M/311M [00:01<00:43, 7.41MB/s]\r  3%|█                                      | 8.00M/311M [00:01<00:41, 7.61MB/s]\r  3%|█▏                                     | 9.00M/311M [00:01<00:40, 7.75MB/s]\r  3%|█▎                                     | 10.0M/311M [00:01<00:39, 8.05MB/s]\r  4%|█▍                                     | 11.0M/311M [00:01<00:38, 8.20MB/s]\r  4%|█▌                                     | 12.0M/311M [00:01<00:38, 8.25MB/s]\r  4%|█▋                                     | 13.0M/311M [00:01<00:37, 8.31MB/s]\r  5%|█▊                                     | 14.0M/311M [00:02<00:37, 8.21MB/s]\r  5%|█▉                                     | 15.0M/311M [00:02<00:38, 8.05MB/s]\r  5%|██                                     | 16.0M/311M [00:02<00:37, 8.14MB/s]\r  5%|██▏                                    | 17.0M/311M [00:02<00:38, 8.11MB/s]\r  6%|██▎                                    | 18.0M/311M [00:02<00:36, 8.40MB/s]\r  6%|██▍                                    | 19.0M/311M [00:02<00:36, 8.44MB/s]\r  6%|██▌                                    | 20.0M/311M [00:02<00:36, 8.36MB/s]\r  7%|██▋                                    | 21.0M/311M [00:02<00:36, 8.30MB/s]\r  7%|██▊                                    | 22.0M/311M [00:03<00:36, 8.27MB/s]\r  7%|██▉                                    | 23.0M/311M [00:03<00:37, 8.05MB/s]\r  8%|███                                    | 24.0M/311M [00:03<00:37, 8.05MB/s]\r  8%|███▏                                   | 25.0M/311M [00:03<00:37, 7.93MB/s]\r  8%|███▎                                   | 26.0M/311M [00:03<00:37, 7.92MB/s]\r  9%|███▍                                   | 27.0M/311M [00:03<00:37, 7.95MB/s]\r  9%|███▌                                   | 28.0M/311M [00:03<00:37, 7.99MB/s]\r  9%|███▋                                   | 29.0M/311M [00:03<00:37, 7.96MB/s]\r 10%|███▊                                   | 30.0M/311M [00:04<00:37, 7.87MB/s]\r 10%|███▉                                   | 31.0M/311M [00:04<00:37, 7.89MB/s]\r 10%|████                                   | 32.0M/311M [00:04<00:36, 8.00MB/s]\r 11%|████▏                                  | 33.0M/311M [00:04<00:36, 8.03MB/s]\r 11%|████▎                                  | 34.0M/311M [00:04<00:36, 7.99MB/s]\r 11%|████▍                                  | 35.0M/311M [00:04<00:36, 8.04MB/s]\r 12%|████▌                                  | 36.0M/311M [00:04<00:35, 8.12MB/s]\r 12%|████▋                                  | 37.0M/311M [00:05<00:35, 8.02MB/s]\r 12%|████▊                                  | 38.0M/311M [00:05<00:36, 7.94MB/s]\r 13%|████▉                                  | 39.0M/311M [00:05<00:35, 7.95MB/s]\r 13%|█████                                  | 40.0M/311M [00:05<00:46, 6.05MB/s]\r 13%|█████▏                                 | 41.0M/311M [00:05<00:42, 6.58MB/s]\r 14%|█████▎                                 | 42.0M/311M [00:05<00:41, 6.87MB/s]\r 14%|█████▍                                 | 43.0M/311M [00:05<00:38, 7.33MB/s]\r 14%|█████▌                                 | 44.0M/311M [00:06<00:37, 7.56MB/s]\r 14%|█████▋                                 | 45.0M/311M [00:06<00:35, 7.77MB/s]\r 15%|█████▊                                 | 46.0M/311M [00:06<00:35, 7.86MB/s]\r 15%|█████▉                                 | 47.0M/311M [00:06<00:35, 7.91MB/s]\r 15%|██████                                 | 48.0M/311M [00:06<00:34, 8.02MB/s]\r 16%|██████▏                                | 49.0M/311M [00:06<00:34, 7.99MB/s]\r 16%|██████▎                                | 50.0M/311M [00:06<00:34, 8.01MB/s]\r 16%|██████▍                                | 51.0M/311M [00:06<00:33, 8.10MB/s]\r 17%|██████▌                                | 52.0M/311M [00:07<00:32, 8.25MB/s]\r 17%|██████▋                                | 53.0M/311M [00:07<00:32, 8.20MB/s]\r 17%|██████▊                                | 54.0M/311M [00:07<00:33, 8.13MB/s]\r 18%|██████▉                                | 55.0M/311M [00:07<00:31, 8.47MB/s]\r 18%|███████                                | 56.0M/311M [00:07<00:31, 8.48MB/s]\r 18%|███████▏                               | 57.0M/311M [00:07<00:31, 8.53MB/s]\r 19%|███████▎                               | 58.0M/311M [00:07<00:31, 8.36MB/s]\r 19%|███████▍                               | 59.0M/311M [00:07<00:31, 8.51MB/s]\r 19%|███████▌                               | 60.0M/311M [00:08<00:30, 8.51MB/s]\r 20%|███████▋                               | 61.0M/311M [00:08<00:30, 8.54MB/s]\r 20%|███████▊                               | 62.0M/311M [00:08<00:31, 8.40MB/s]\r 20%|███████▉                               | 63.0M/311M [00:08<00:31, 8.20MB/s]\r 21%|████████                               | 64.0M/311M [00:08<00:30, 8.49MB/s]\r 21%|████████▏                              | 65.0M/311M [00:08<00:30, 8.40MB/s]\r 21%|████████▎                              | 66.0M/311M [00:08<00:30, 8.53MB/s]\r 22%|████████▍                              | 67.0M/311M [00:08<00:30, 8.49MB/s]\r 22%|████████▌                              | 68.0M/311M [00:09<00:30, 8.32MB/s]\r 22%|████████▋                              | 69.0M/311M [00:09<00:30, 8.37MB/s]\r 23%|████████▊                              | 70.0M/311M [00:09<00:29, 8.48MB/s]\r 23%|████████▉                              | 71.0M/311M [00:09<00:29, 8.51MB/s]\r 23%|█████████                              | 72.0M/311M [00:09<00:29, 8.56MB/s]\r 23%|█████████▏                             | 73.0M/311M [00:09<00:29, 8.57MB/s]\r 24%|█████████▎                             | 74.0M/311M [00:09<00:29, 8.41MB/s]\r 24%|█████████▍                             | 75.0M/311M [00:09<00:29, 8.45MB/s]\r 24%|█████████▌                             | 76.0M/311M [00:10<00:29, 8.28MB/s]\r 25%|█████████▋                             | 77.0M/311M [00:10<00:29, 8.30MB/s]\r 25%|█████████▊                             | 78.0M/311M [00:10<00:29, 8.33MB/s]\r 25%|█████████▉                             | 79.0M/311M [00:10<00:28, 8.43MB/s]\r 26%|██████████                             | 80.0M/311M [00:10<00:39, 6.08MB/s]\r 26%|██████████▏                            | 81.0M/311M [00:10<00:36, 6.63MB/s]\r 26%|██████████▎                            | 82.0M/311M [00:11<00:33, 7.09MB/s]\r 27%|██████████▍                            | 83.0M/311M [00:11<00:32, 7.46MB/s]\r 27%|██████████▌                            | 84.0M/311M [00:11<00:30, 7.76MB/s]\r 27%|██████████▋                            | 85.0M/311M [00:11<00:29, 8.03MB/s]\r 28%|██████████▊                            | 86.0M/311M [00:11<00:28, 8.17MB/s]\r 28%|██████████▉                            | 87.0M/311M [00:11<00:28, 8.23MB/s]\r 28%|███████████                            | 88.0M/311M [00:11<00:27, 8.38MB/s]\r 29%|███████████▏                           | 89.0M/311M [00:11<00:27, 8.38MB/s]\r 29%|███████████▎                           | 90.0M/311M [00:11<00:27, 8.51MB/s]\r 29%|███████████▍                           | 91.0M/311M [00:12<00:27, 8.37MB/s]\r 30%|███████████▌                           | 92.0M/311M [00:12<00:27, 8.35MB/s]\r 30%|███████████▋                           | 93.0M/311M [00:12<00:27, 8.35MB/s]\r 30%|███████████▊                           | 94.0M/311M [00:12<00:26, 8.54MB/s]\r 31%|███████████▉                           | 95.0M/311M [00:12<00:26, 8.40MB/s]\r 31%|████████████                           | 96.0M/311M [00:12<00:26, 8.53MB/s]\r 31%|████████████▏                          | 97.0M/311M [00:12<00:26, 8.55MB/s]\r 32%|████████████▎                          | 98.0M/311M [00:13<00:27, 8.09MB/s]\r 32%|████████████▍                          | 99.0M/311M [00:13<00:26, 8.42MB/s]\r 32%|████████████▊                           | 100M/311M [00:13<00:27, 8.03MB/s]\r 32%|████████████▉                           | 101M/311M [00:13<00:28, 7.85MB/s]\r 33%|█████████████                           | 102M/311M [00:13<00:28, 7.73MB/s]\r 33%|█████████████▎                          | 103M/311M [00:13<00:28, 7.67MB/s]\r 33%|█████████████▍                          | 104M/311M [00:13<00:28, 7.50MB/s]\r 34%|█████████████▌                          | 105M/311M [00:13<00:28, 7.52MB/s]\r 34%|█████████████▋                          | 106M/311M [00:14<00:28, 7.59MB/s]\r 34%|█████████████▊                          | 107M/311M [00:14<00:28, 7.58MB/s]\r 35%|█████████████▉                          | 108M/311M [00:14<00:27, 7.75MB/s]\r 35%|██████████████                          | 109M/311M [00:14<00:26, 7.96MB/s]\r 35%|██████████████▏                         | 110M/311M [00:14<00:26, 7.97MB/s]\r 36%|██████████████▎                         | 111M/311M [00:14<00:26, 8.04MB/s]\r 36%|██████████████▍                         | 112M/311M [00:14<00:25, 8.18MB/s]\r 36%|██████████████▌                         | 113M/311M [00:14<00:24, 8.39MB/s]\r 37%|██████████████▋                         | 114M/311M [00:15<00:24, 8.37MB/s]\r 37%|██████████████▊                         | 115M/311M [00:15<00:28, 7.29MB/s]\r 37%|██████████████▉                         | 116M/311M [00:15<00:28, 7.26MB/s]\r 38%|███████████████                         | 117M/311M [00:15<00:27, 7.38MB/s]\r 38%|███████████████▏                        | 118M/311M [00:15<00:26, 7.73MB/s]\r 38%|███████████████▎                        | 119M/311M [00:15<00:25, 7.85MB/s]\r 39%|███████████████▍                        | 120M/311M [00:15<00:25, 7.89MB/s]\r 39%|███████████████▌                        | 121M/311M [00:16<00:24, 8.00MB/s]\r 39%|███████████████▋                        | 122M/311M [00:16<00:25, 7.92MB/s]\r 40%|███████████████▊                        | 123M/311M [00:16<00:25, 7.81MB/s]\r 40%|███████████████▉                        | 124M/311M [00:16<00:24, 8.13MB/s]\r 40%|████████████████                        | 125M/311M [00:16<00:23, 8.23MB/s]\r 41%|████████████████▏                       | 126M/311M [00:16<00:23, 8.35MB/s]\r 41%|████████████████▎                       | 127M/311M [00:16<00:23, 8.32MB/s]\r 41%|████████████████▍                       | 128M/311M [00:16<00:23, 8.33MB/s]\r 41%|████████████████▌                       | 129M/311M [00:17<00:23, 8.13MB/s]\r 42%|████████████████▋                       | 130M/311M [00:17<00:23, 8.08MB/s]\r 42%|████████████████▊                       | 131M/311M [00:17<00:23, 8.12MB/s]\r 42%|████████████████▉                       | 132M/311M [00:17<00:23, 8.02MB/s]\r 43%|█████████████████                       | 133M/311M [00:17<00:23, 8.00MB/s]\r 43%|█████████████████▏                      | 134M/311M [00:17<00:23, 8.00MB/s]\r 43%|█████████████████▎                      | 135M/311M [00:17<00:22, 8.12MB/s]\r 44%|█████████████████▍                      | 136M/311M [00:18<00:22, 8.30MB/s]\r 44%|█████████████████▋                      | 137M/311M [00:18<00:21, 8.34MB/s]\r 44%|█████████████████▊                      | 138M/311M [00:18<00:21, 8.43MB/s]\r 45%|█████████████████▉                      | 139M/311M [00:18<00:28, 6.24MB/s]\r 45%|██████████████████                      | 140M/311M [00:18<00:26, 6.75MB/s]\r 45%|██████████████████▏                     | 141M/311M [00:18<00:25, 7.12MB/s]\r 46%|██████████████████▎                     | 142M/311M [00:18<00:23, 7.50MB/s]\r 46%|██████████████████▍                     | 143M/311M [00:19<00:23, 7.57MB/s]\r 46%|██████████████████▌                     | 144M/311M [00:19<00:22, 7.72MB/s]\r 47%|██████████████████▋                     | 145M/311M [00:19<00:21, 7.91MB/s]\r 47%|██████████████████▊                     | 146M/311M [00:19<00:21, 7.95MB/s]\r 47%|██████████████████▉                     | 147M/311M [00:19<00:21, 7.94MB/s]\r 48%|███████████████████                     | 148M/311M [00:19<00:21, 8.07MB/s]\r 48%|███████████████████▏                    | 149M/311M [00:19<00:20, 8.09MB/s]\r 48%|███████████████████▎                    | 150M/311M [00:19<00:20, 8.21MB/s]\r 49%|███████████████████▍                    | 151M/311M [00:20<00:20, 8.24MB/s]\r 49%|███████████████████▌                    | 152M/311M [00:20<00:20, 8.23MB/s]\r 49%|███████████████████▋                    | 153M/311M [00:20<00:20, 8.21MB/s]\r 50%|███████████████████▊                    | 154M/311M [00:20<00:19, 8.34MB/s]\r 50%|███████████████████▉                    | 155M/311M [00:20<00:19, 8.40MB/s]\r 50%|████████████████████                    | 156M/311M [00:20<00:19, 8.46MB/s]\r 51%|████████████████████▏                   | 157M/311M [00:20<00:19, 8.42MB/s]\r 51%|████████████████████▎                   | 158M/311M [00:20<00:19, 8.41MB/s]\r 51%|████████████████████▍                   | 159M/311M [00:21<00:19, 8.33MB/s]\r 51%|████████████████████▌                   | 160M/311M [00:21<00:18, 8.41MB/s]\r 52%|████████████████████▋                   | 161M/311M [00:21<00:18, 8.37MB/s]\r 52%|████████████████████▊                   | 162M/311M [00:21<00:18, 8.30MB/s]\r 52%|████████████████████▉                   | 163M/311M [00:21<00:19, 8.04MB/s]\r 53%|█████████████████████                   | 164M/311M [00:21<00:18, 8.13MB/s]\r 53%|█████████████████████▏                  | 165M/311M [00:21<00:19, 7.94MB/s]\r 53%|█████████████████████▎                  | 166M/311M [00:21<00:18, 8.17MB/s]\r 54%|█████████████████████▍                  | 167M/311M [00:22<00:18, 8.09MB/s]\r 54%|█████████████████████▌                  | 168M/311M [00:22<00:18, 8.11MB/s]\r 54%|█████████████████████▋                  | 169M/311M [00:22<00:18, 8.08MB/s]\r 55%|█████████████████████▊                  | 170M/311M [00:22<00:18, 8.04MB/s]\r 55%|██████████████████████                  | 171M/311M [00:22<00:18, 8.04MB/s]\r 55%|██████████████████████▏                 | 172M/311M [00:22<00:18, 8.06MB/s]\r 56%|██████████████████████▎                 | 173M/311M [00:22<00:17, 8.09MB/s]\r 56%|██████████████████████▍                 | 174M/311M [00:23<00:17, 8.22MB/s]\r 56%|██████████████████████▌                 | 175M/311M [00:23<00:17, 8.17MB/s]\r 57%|██████████████████████▋                 | 176M/311M [00:23<00:17, 8.16MB/s]\r 57%|██████████████████████▊                 | 177M/311M [00:23<00:17, 8.22MB/s]\r 57%|██████████████████████▉                 | 178M/311M [00:23<00:16, 8.34MB/s]\r 58%|███████████████████████                 | 179M/311M [00:23<00:22, 6.24MB/s]\r 58%|███████████████████████▏                | 180M/311M [00:23<00:20, 6.77MB/s]\r 58%|███████████████████████▎                | 181M/311M [00:24<00:18, 7.25MB/s]\r 59%|███████████████████████▍                | 182M/311M [00:24<00:17, 7.55MB/s]\r 59%|███████████████████████▌                | 183M/311M [00:24<00:17, 7.69MB/s]\r 59%|███████████████████████▋                | 184M/311M [00:24<00:17, 7.71MB/s]\r 60%|███████████████████████▊                | 185M/311M [00:24<00:16, 7.92MB/s]\r 60%|███████████████████████▉                | 186M/311M [00:24<00:16, 7.94MB/s]\r 60%|████████████████████████                | 187M/311M [00:24<00:16, 8.07MB/s]\r 60%|████████████████████████▏               | 188M/311M [00:24<00:15, 8.25MB/s]\r 61%|████████████████████████▎               | 189M/311M [00:25<00:15, 8.32MB/s]\r 61%|████████████████████████▍               | 190M/311M [00:25<00:15, 8.25MB/s]\r 61%|████████████████████████▌               | 191M/311M [00:25<00:15, 8.23MB/s]\r 62%|████████████████████████▋               | 192M/311M [00:25<00:15, 8.20MB/s]\r 62%|████████████████████████▊               | 193M/311M [00:25<00:14, 8.32MB/s]\r 62%|████████████████████████▉               | 194M/311M [00:25<00:14, 8.35MB/s]\r 63%|█████████████████████████               | 195M/311M [00:25<00:14, 8.33MB/s]\r 63%|█████████████████████████▏              | 196M/311M [00:25<00:14, 8.38MB/s]\r 63%|█████████████████████████▎              | 197M/311M [00:26<00:14, 8.41MB/s]\r 64%|█████████████████████████▍              | 198M/311M [00:26<00:14, 8.41MB/s]\r 64%|█████████████████████████▌              | 199M/311M [00:26<00:14, 8.27MB/s]\r 64%|█████████████████████████▋              | 200M/311M [00:26<00:14, 8.23MB/s]\r 65%|█████████████████████████▊              | 201M/311M [00:26<00:14, 8.16MB/s]\r 65%|█████████████████████████▉              | 202M/311M [00:26<00:14, 8.12MB/s]\r 65%|██████████████████████████              | 203M/311M [00:26<00:13, 8.15MB/s]\r 66%|██████████████████████████▏             | 204M/311M [00:26<00:13, 8.22MB/s]\r 66%|██████████████████████████▍             | 205M/311M [00:27<00:13, 8.28MB/s]\r 66%|██████████████████████████▌             | 206M/311M [00:27<00:13, 8.15MB/s]\r 67%|██████████████████████████▋             | 207M/311M [00:27<00:13, 8.26MB/s]\r 67%|██████████████████████████▊             | 208M/311M [00:27<00:13, 8.17MB/s]\r 67%|██████████████████████████▉             | 209M/311M [00:27<00:13, 8.14MB/s]\r 68%|███████████████████████████             | 210M/311M [00:27<00:13, 8.06MB/s]\r 68%|███████████████████████████▏            | 211M/311M [00:27<00:13, 8.03MB/s]\r 68%|███████████████████████████▎            | 212M/311M [00:27<00:12, 8.14MB/s]\r 69%|███████████████████████████▍            | 213M/311M [00:28<00:12, 8.09MB/s]\r 69%|███████████████████████████▌            | 214M/311M [00:28<00:12, 8.12MB/s]\r 69%|███████████████████████████▋            | 215M/311M [00:28<00:12, 8.27MB/s]\r 69%|███████████████████████████▊            | 216M/311M [00:28<00:11, 8.37MB/s]\r 70%|███████████████████████████▉            | 217M/311M [00:28<00:11, 8.45MB/s]\r 70%|████████████████████████████            | 218M/311M [00:28<00:11, 8.42MB/s]\r 70%|████████████████████████████▏           | 219M/311M [00:29<00:15, 6.18MB/s]\r 71%|████████████████████████████▎           | 220M/311M [00:29<00:14, 6.71MB/s]\r 71%|████████████████████████████▍           | 221M/311M [00:29<00:13, 7.07MB/s]\r 71%|████████████████████████████▌           | 222M/311M [00:29<00:12, 7.30MB/s]\r 72%|████████████████████████████▋           | 223M/311M [00:29<00:12, 7.50MB/s]\r 72%|████████████████████████████▊           | 224M/311M [00:29<00:11, 7.84MB/s]\r 72%|████████████████████████████▉           | 225M/311M [00:29<00:11, 8.01MB/s]\r 73%|█████████████████████████████           | 226M/311M [00:29<00:11, 7.98MB/s]\r 73%|█████████████████████████████▏          | 227M/311M [00:30<00:10, 8.09MB/s]\r 73%|█████████████████████████████▎          | 228M/311M [00:30<00:10, 8.12MB/s]\r 74%|█████████████████████████████▍          | 229M/311M [00:30<00:11, 7.70MB/s]\r 74%|█████████████████████████████▌          | 230M/311M [00:30<00:10, 7.81MB/s]\r 74%|█████████████████████████████▋          | 231M/311M [00:30<00:10, 7.98MB/s]\r 75%|█████████████████████████████▊          | 232M/311M [00:30<00:10, 7.78MB/s]\r 75%|█████████████████████████████▉          | 233M/311M [00:30<00:10, 7.63MB/s]\r 75%|██████████████████████████████          | 234M/311M [00:30<00:10, 7.72MB/s]\r 76%|██████████████████████████████▏         | 235M/311M [00:31<00:10, 7.83MB/s]\r 76%|██████████████████████████████▎         | 236M/311M [00:31<00:09, 7.91MB/s]\r 76%|██████████████████████████████▍         | 237M/311M [00:31<00:09, 8.23MB/s]\r 77%|██████████████████████████████▌         | 238M/311M [00:31<00:09, 8.26MB/s]\r 77%|██████████████████████████████▊         | 239M/311M [00:31<00:08, 8.40MB/s]\r 77%|██████████████████████████████▉         | 240M/311M [00:31<00:08, 8.51MB/s]\r 78%|███████████████████████████████         | 241M/311M [00:31<00:08, 8.53MB/s]\r 78%|███████████████████████████████▏        | 242M/311M [00:31<00:08, 8.59MB/s]\r 78%|███████████████████████████████▎        | 243M/311M [00:32<00:08, 8.45MB/s]\r 78%|███████████████████████████████▍        | 244M/311M [00:32<00:08, 8.49MB/s]\r 79%|███████████████████████████████▌        | 245M/311M [00:32<00:08, 8.37MB/s]\r 79%|███████████████████████████████▋        | 246M/311M [00:32<00:08, 8.35MB/s]\r 79%|███████████████████████████████▊        | 247M/311M [00:32<00:08, 8.20MB/s]\r 80%|███████████████████████████████▉        | 248M/311M [00:32<00:07, 8.27MB/s]\r 80%|████████████████████████████████        | 249M/311M [00:32<00:07, 8.33MB/s]\r 80%|████████████████████████████████▏       | 250M/311M [00:32<00:07, 8.33MB/s]\r 81%|████████████████████████████████▎       | 251M/311M [00:33<00:07, 8.19MB/s]\r 81%|████████████████████████████████▍       | 252M/311M [00:33<00:07, 8.23MB/s]\r 81%|████████████████████████████████▌       | 253M/311M [00:33<00:07, 8.12MB/s]\r 82%|████████████████████████████████▋       | 254M/311M [00:33<00:07, 8.22MB/s]\r 82%|████████████████████████████████▊       | 255M/311M [00:33<00:06, 8.41MB/s]\r 82%|████████████████████████████████▉       | 256M/311M [00:33<00:06, 8.41MB/s]\r 83%|█████████████████████████████████       | 257M/311M [00:33<00:06, 8.34MB/s]\r 83%|█████████████████████████████████▏      | 258M/311M [00:33<00:06, 8.58MB/s]\r 83%|█████████████████████████████████▎      | 259M/311M [00:34<00:08, 6.28MB/s]\r 84%|█████████████████████████████████▍      | 260M/311M [00:34<00:07, 6.76MB/s]\r 84%|█████████████████████████████████▌      | 261M/311M [00:34<00:07, 7.16MB/s]\r 84%|█████████████████████████████████▋      | 262M/311M [00:34<00:06, 7.53MB/s]\r 85%|█████████████████████████████████▊      | 263M/311M [00:34<00:06, 7.76MB/s]\r 85%|█████████████████████████████████▉      | 264M/311M [00:34<00:06, 7.93MB/s]\r 85%|██████████████████████████████████      | 265M/311M [00:34<00:05, 8.03MB/s]\r 86%|██████████████████████████████████▏     | 266M/311M [00:35<00:05, 8.01MB/s]\r 86%|██████████████████████████████████▎     | 267M/311M [00:35<00:05, 8.01MB/s]\r 86%|██████████████████████████████████▍     | 268M/311M [00:35<00:05, 8.17MB/s]\r 87%|██████████████████████████████████▌     | 269M/311M [00:35<00:05, 8.17MB/s]\r 87%|██████████████████████████████████▋     | 270M/311M [00:35<00:05, 8.22MB/s]\r 87%|██████████████████████████████████▊     | 271M/311M [00:35<00:05, 8.25MB/s]\r 87%|██████████████████████████████████▉     | 272M/311M [00:35<00:04, 8.38MB/s]\r 88%|███████████████████████████████████▏    | 273M/311M [00:36<00:04, 8.29MB/s]\r 88%|███████████████████████████████████▎    | 274M/311M [00:36<00:04, 8.24MB/s]\r 88%|███████████████████████████████████▍    | 275M/311M [00:36<00:04, 8.33MB/s]\r 89%|███████████████████████████████████▌    | 276M/311M [00:36<00:04, 8.49MB/s]\r 89%|███████████████████████████████████▋    | 277M/311M [00:36<00:04, 8.43MB/s]\r 89%|███████████████████████████████████▊    | 278M/311M [00:36<00:04, 8.20MB/s]\r 90%|███████████████████████████████████▉    | 279M/311M [00:36<00:04, 8.08MB/s]\r 90%|████████████████████████████████████    | 280M/311M [00:36<00:03, 8.22MB/s]\r 90%|████████████████████████████████████▏   | 281M/311M [00:37<00:03, 8.12MB/s]\r 91%|████████████████████████████████████▎   | 282M/311M [00:37<00:03, 8.05MB/s]\r 91%|████████████████████████████████████▍   | 283M/311M [00:37<00:03, 8.18MB/s]\r 91%|████████████████████████████████████▌   | 284M/311M [00:37<00:03, 8.23MB/s]\r 92%|████████████████████████████████████▋   | 285M/311M [00:37<00:03, 8.19MB/s]\r 92%|████████████████████████████████████▊   | 286M/311M [00:37<00:03, 8.23MB/s]\r 92%|████████████████████████████████████▉   | 287M/311M [00:37<00:03, 8.25MB/s]\r 93%|█████████████████████████████████████   | 288M/311M [00:37<00:02, 8.17MB/s]\r 93%|█████████████████████████████████████▏  | 289M/311M [00:38<00:02, 8.24MB/s]\r 93%|█████████████████████████████████████▎  | 290M/311M [00:38<00:02, 8.27MB/s]\r 94%|█████████████████████████████████████▍  | 291M/311M [00:38<00:02, 8.30MB/s]\r 94%|█████████████████████████████████████▌  | 292M/311M [00:38<00:02, 8.32MB/s]\r 94%|█████████████████████████████████████▋  | 293M/311M [00:38<00:02, 8.24MB/s]\r 95%|█████████████████████████████████████▊  | 294M/311M [00:38<00:02, 8.19MB/s]\r 95%|█████████████████████████████████████▉  | 295M/311M [00:38<00:02, 8.16MB/s]\r 95%|██████████████████████████████████████  | 296M/311M [00:38<00:01, 8.24MB/s]\r 96%|██████████████████████████████████████▏ | 297M/311M [00:39<00:01, 7.97MB/s]\r 96%|██████████████████████████████████████▎ | 298M/311M [00:39<00:01, 8.02MB/s]\r 96%|██████████████████████████████████████▍ | 299M/311M [00:39<00:02, 5.94MB/s]\r 97%|██████████████████████████████████████▌ | 300M/311M [00:39<00:01, 6.47MB/s]\r 97%|██████████████████████████████████████▋ | 301M/311M [00:39<00:01, 6.97MB/s]\r 97%|██████████████████████████████████████▊ | 302M/311M [00:39<00:01, 7.28MB/s]\r 97%|██████████████████████████████████████▉ | 303M/311M [00:40<00:01, 7.44MB/s]\r 98%|███████████████████████████████████████ | 304M/311M [00:40<00:00, 7.60MB/s]\r 98%|███████████████████████████████████████▏| 305M/311M [00:40<00:00, 7.65MB/s]\r 98%|███████████████████████████████████████▎| 306M/311M [00:40<00:00, 7.87MB/s]\r 99%|███████████████████████████████████████▌| 307M/311M [00:40<00:00, 7.81MB/s]\r 99%|███████████████████████████████████████▋| 308M/311M [00:40<00:00, 8.01MB/s]\r 99%|███████████████████████████████████████▊| 309M/311M [00:40<00:00, 7.93MB/s]\r100%|███████████████████████████████████████▉| 310M/311M [00:40<00:00, 7.96MB/s]\r100%|████████████████████████████████████████| 311M/311M [00:41<00:00, 8.21MB/s]\r\n\r100%|████████████████████████████████████████| 311M/311M [00:41<00:00, 7.94MB/s]\r\n```\n:::\n:::\n\n\n::: {#799c1cce .cell execution_count=3}\n``` {.python .cell-code}\n# Download https://www.kaggle.com/datasets/jylim21/malaysia-public-data\n\n!kaggle datasets download -p .data/ jylim21/malaysia-public-data --unzip\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nDataset URL: https://www.kaggle.com/datasets/jylim21/malaysia-public-data\r\nLicense(s): Community Data License Agreement - Permissive - Version 1.0\r\nDownloading malaysia-public-data.zip to .data\r\n\r  0%|                                                | 0.00/156k [00:00<?, ?B/s]\r100%|█████████████████████████████████████████| 156k/156k [00:00<00:00, 650kB/s]\r\n\r100%|█████████████████████████████████████████| 156k/156k [00:00<00:00, 648kB/s]\r\n```\n:::\n:::\n\n\n::: {#bb98feb3 .cell execution_count=4}\n``` {.python .cell-code}\n# Disable all warnings\n\nimport warnings\n\nwarnings.filterwarnings('ignore')\n```\n:::\n\n\nLet's load these as dataframes and inspect the first few rows of each dataset.\n\n::: {#322f4857 .cell execution_count=5}\n``` {.python .cell-code}\n# Load full_weather.csv and births.csv\n\nimport pandas as pd\n\nweather = pd.read_csv('.data/full_weather.csv')\nbirths = pd.read_csv('.data/births.csv')\n```\n:::\n\n\n## Preprocessing the data\n\nWe will need to adjust the available data to fit our purposes, including filling in gaps and merging the data we are interested in.\n\n::: {#9ff862d0 .cell execution_count=6}\n``` {.python .cell-code}\n# Display the first 5 rows of each dataframe\n\nweather.head().style.background_gradient(cmap='Greens')\n```\n\n::: {.cell-output .cell-output-display execution_count=5}\n```{=html}\n<style type=\"text/css\">\n#T_934c8_row0_col4, #T_934c8_row0_col10 {\n  background-color: #006c2c;\n  color: #f1f1f1;\n}\n#T_934c8_row0_col5 {\n  background-color: #78c679;\n  color: #000000;\n}\n#T_934c8_row0_col6, #T_934c8_row0_col8, #T_934c8_row0_col12, #T_934c8_row0_col13, #T_934c8_row1_col5, #T_934c8_row1_col7, #T_934c8_row2_col13, #T_934c8_row3_col4, #T_934c8_row3_col10, #T_934c8_row3_col12, #T_934c8_row3_col13, #T_934c8_row4_col13 {\n  background-color: #00441b;\n  color: #f1f1f1;\n}\n#T_934c8_row0_col7 {\n  background-color: #d3eecd;\n  color: #000000;\n}\n#T_934c8_row0_col9, #T_934c8_row0_col11, #T_934c8_row0_col14, #T_934c8_row0_col15, #T_934c8_row0_col16, #T_934c8_row0_col17, #T_934c8_row1_col9, #T_934c8_row1_col11, #T_934c8_row1_col14, #T_934c8_row1_col15, #T_934c8_row1_col16, #T_934c8_row1_col17, #T_934c8_row2_col9, #T_934c8_row2_col11, #T_934c8_row2_col14, #T_934c8_row2_col15, #T_934c8_row2_col16, #T_934c8_row2_col17, #T_934c8_row3_col8, #T_934c8_row3_col9, #T_934c8_row3_col11, #T_934c8_row3_col14, #T_934c8_row3_col15, #T_934c8_row3_col16, #T_934c8_row3_col17, #T_934c8_row4_col4, #T_934c8_row4_col5, #T_934c8_row4_col6, #T_934c8_row4_col7, #T_934c8_row4_col9, #T_934c8_row4_col10, #T_934c8_row4_col11, #T_934c8_row4_col12, #T_934c8_row4_col14, #T_934c8_row4_col15, #T_934c8_row4_col16, #T_934c8_row4_col17 {\n  background-color: #000000;\n  color: #f1f1f1;\n}\n#T_934c8_row1_col4, #T_934c8_row1_col10, #T_934c8_row1_col12, #T_934c8_row1_col13, #T_934c8_row2_col6, #T_934c8_row2_col8, #T_934c8_row3_col5, #T_934c8_row3_col7 {\n  background-color: #f7fcf5;\n  color: #000000;\n}\n#T_934c8_row1_col6, #T_934c8_row2_col4, #T_934c8_row2_col10, #T_934c8_row2_col12, #T_934c8_row3_col6 {\n  background-color: #73c476;\n  color: #000000;\n}\n#T_934c8_row1_col8 {\n  background-color: #bce4b5;\n  color: #000000;\n}\n#T_934c8_row2_col5 {\n  background-color: #39a257;\n  color: #f1f1f1;\n}\n#T_934c8_row2_col7 {\n  background-color: #b4e1ad;\n  color: #000000;\n}\n#T_934c8_row4_col8 {\n  background-color: #2c944c;\n  color: #f1f1f1;\n}\n</style>\n<table id=\"T_934c8\">\n  <thead>\n    <tr>\n      <th class=\"blank level0\" >&nbsp;</th>\n      <th id=\"T_934c8_level0_col0\" class=\"col_heading level0 col0\" >datetime</th>\n      <th id=\"T_934c8_level0_col1\" class=\"col_heading level0 col1\" >place</th>\n      <th id=\"T_934c8_level0_col2\" class=\"col_heading level0 col2\" >city</th>\n      <th id=\"T_934c8_level0_col3\" class=\"col_heading level0 col3\" >state</th>\n      <th id=\"T_934c8_level0_col4\" class=\"col_heading level0 col4\" >temperature</th>\n      <th id=\"T_934c8_level0_col5\" class=\"col_heading level0 col5\" >pressure</th>\n      <th id=\"T_934c8_level0_col6\" class=\"col_heading level0 col6\" >dew_point</th>\n      <th id=\"T_934c8_level0_col7\" class=\"col_heading level0 col7\" >humidity</th>\n      <th id=\"T_934c8_level0_col8\" class=\"col_heading level0 col8\" >wind_speed</th>\n      <th id=\"T_934c8_level0_col9\" class=\"col_heading level0 col9\" >gust</th>\n      <th id=\"T_934c8_level0_col10\" class=\"col_heading level0 col10\" >wind_chill</th>\n      <th id=\"T_934c8_level0_col11\" class=\"col_heading level0 col11\" >uv_index</th>\n      <th id=\"T_934c8_level0_col12\" class=\"col_heading level0 col12\" >feels_like_temperature</th>\n      <th id=\"T_934c8_level0_col13\" class=\"col_heading level0 col13\" >visibility</th>\n      <th id=\"T_934c8_level0_col14\" class=\"col_heading level0 col14\" >solar_radiation</th>\n      <th id=\"T_934c8_level0_col15\" class=\"col_heading level0 col15\" >pollutant_value</th>\n      <th id=\"T_934c8_level0_col16\" class=\"col_heading level0 col16\" >precipitation_rate</th>\n      <th id=\"T_934c8_level0_col17\" class=\"col_heading level0 col17\" >precipitation_total</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th id=\"T_934c8_level0_row0\" class=\"row_heading level0 row0\" >0</th>\n      <td id=\"T_934c8_row0_col0\" class=\"data row0 col0\" >1996-08-09 13:30:00</td>\n      <td id=\"T_934c8_row0_col1\" class=\"data row0 col1\" >Tanjung Aru</td>\n      <td id=\"T_934c8_row0_col2\" class=\"data row0 col2\" >Kota Kinabalu</td>\n      <td id=\"T_934c8_row0_col3\" class=\"data row0 col3\" >Sabah</td>\n      <td id=\"T_934c8_row0_col4\" class=\"data row0 col4\" >32.000000</td>\n      <td id=\"T_934c8_row0_col5\" class=\"data row0 col5\" >1006.160000</td>\n      <td id=\"T_934c8_row0_col6\" class=\"data row0 col6\" >25.000000</td>\n      <td id=\"T_934c8_row0_col7\" class=\"data row0 col7\" >66.000000</td>\n      <td id=\"T_934c8_row0_col8\" class=\"data row0 col8\" >9.000000</td>\n      <td id=\"T_934c8_row0_col9\" class=\"data row0 col9\" >nan</td>\n      <td id=\"T_934c8_row0_col10\" class=\"data row0 col10\" >32.000000</td>\n      <td id=\"T_934c8_row0_col11\" class=\"data row0 col11\" >nan</td>\n      <td id=\"T_934c8_row0_col12\" class=\"data row0 col12\" >39.000000</td>\n      <td id=\"T_934c8_row0_col13\" class=\"data row0 col13\" >9.000000</td>\n      <td id=\"T_934c8_row0_col14\" class=\"data row0 col14\" >nan</td>\n      <td id=\"T_934c8_row0_col15\" class=\"data row0 col15\" >nan</td>\n      <td id=\"T_934c8_row0_col16\" class=\"data row0 col16\" >nan</td>\n      <td id=\"T_934c8_row0_col17\" class=\"data row0 col17\" >nan</td>\n    </tr>\n    <tr>\n      <th id=\"T_934c8_level0_row1\" class=\"row_heading level0 row1\" >1</th>\n      <td id=\"T_934c8_row1_col0\" class=\"data row1 col0\" >1996-08-09 13:30:00</td>\n      <td id=\"T_934c8_row1_col1\" class=\"data row1 col1\" >Batu Maung</td>\n      <td id=\"T_934c8_row1_col2\" class=\"data row1 col2\" >Bayan Lepas</td>\n      <td id=\"T_934c8_row1_col3\" class=\"data row1 col3\" >Pulau Pinang</td>\n      <td id=\"T_934c8_row1_col4\" class=\"data row1 col4\" >25.000000</td>\n      <td id=\"T_934c8_row1_col5\" class=\"data row1 col5\" >1008.640000</td>\n      <td id=\"T_934c8_row1_col6\" class=\"data row1 col6\" >24.000000</td>\n      <td id=\"T_934c8_row1_col7\" class=\"data row1 col7\" >94.000000</td>\n      <td id=\"T_934c8_row1_col8\" class=\"data row1 col8\" >4.000000</td>\n      <td id=\"T_934c8_row1_col9\" class=\"data row1 col9\" >nan</td>\n      <td id=\"T_934c8_row1_col10\" class=\"data row1 col10\" >25.000000</td>\n      <td id=\"T_934c8_row1_col11\" class=\"data row1 col11\" >nan</td>\n      <td id=\"T_934c8_row1_col12\" class=\"data row1 col12\" >25.000000</td>\n      <td id=\"T_934c8_row1_col13\" class=\"data row1 col13\" >6.000000</td>\n      <td id=\"T_934c8_row1_col14\" class=\"data row1 col14\" >nan</td>\n      <td id=\"T_934c8_row1_col15\" class=\"data row1 col15\" >nan</td>\n      <td id=\"T_934c8_row1_col16\" class=\"data row1 col16\" >nan</td>\n      <td id=\"T_934c8_row1_col17\" class=\"data row1 col17\" >nan</td>\n    </tr>\n    <tr>\n      <th id=\"T_934c8_level0_row2\" class=\"row_heading level0 row2\" >2</th>\n      <td id=\"T_934c8_row2_col0\" class=\"data row2 col0\" >1996-08-09 13:30:00</td>\n      <td id=\"T_934c8_row2_col1\" class=\"data row2 col1\" >Sepang</td>\n      <td id=\"T_934c8_row2_col2\" class=\"data row2 col2\" >Sepang</td>\n      <td id=\"T_934c8_row2_col3\" class=\"data row2 col3\" >Kuala Lumpur</td>\n      <td id=\"T_934c8_row2_col4\" class=\"data row2 col4\" >29.000000</td>\n      <td id=\"T_934c8_row2_col5\" class=\"data row2 col5\" >1006.970000</td>\n      <td id=\"T_934c8_row2_col6\" class=\"data row2 col6\" >23.000000</td>\n      <td id=\"T_934c8_row2_col7\" class=\"data row2 col7\" >70.000000</td>\n      <td id=\"T_934c8_row2_col8\" class=\"data row2 col8\" >2.000000</td>\n      <td id=\"T_934c8_row2_col9\" class=\"data row2 col9\" >nan</td>\n      <td id=\"T_934c8_row2_col10\" class=\"data row2 col10\" >29.000000</td>\n      <td id=\"T_934c8_row2_col11\" class=\"data row2 col11\" >nan</td>\n      <td id=\"T_934c8_row2_col12\" class=\"data row2 col12\" >32.000000</td>\n      <td id=\"T_934c8_row2_col13\" class=\"data row2 col13\" >9.000000</td>\n      <td id=\"T_934c8_row2_col14\" class=\"data row2 col14\" >nan</td>\n      <td id=\"T_934c8_row2_col15\" class=\"data row2 col15\" >nan</td>\n      <td id=\"T_934c8_row2_col16\" class=\"data row2 col16\" >nan</td>\n      <td id=\"T_934c8_row2_col17\" class=\"data row2 col17\" >nan</td>\n    </tr>\n    <tr>\n      <th id=\"T_934c8_level0_row3\" class=\"row_heading level0 row3\" >3</th>\n      <td id=\"T_934c8_row3_col0\" class=\"data row3 col0\" >1996-08-09 13:30:00</td>\n      <td id=\"T_934c8_row3_col1\" class=\"data row3 col1\" >Kota Sentosa</td>\n      <td id=\"T_934c8_row3_col2\" class=\"data row3 col2\" >Kuching</td>\n      <td id=\"T_934c8_row3_col3\" class=\"data row3 col3\" >Sarawak</td>\n      <td id=\"T_934c8_row3_col4\" class=\"data row3 col4\" >33.000000</td>\n      <td id=\"T_934c8_row3_col5\" class=\"data row3 col5\" >1003.780000</td>\n      <td id=\"T_934c8_row3_col6\" class=\"data row3 col6\" >24.000000</td>\n      <td id=\"T_934c8_row3_col7\" class=\"data row3 col7\" >59.000000</td>\n      <td id=\"T_934c8_row3_col8\" class=\"data row3 col8\" >nan</td>\n      <td id=\"T_934c8_row3_col9\" class=\"data row3 col9\" >nan</td>\n      <td id=\"T_934c8_row3_col10\" class=\"data row3 col10\" >33.000000</td>\n      <td id=\"T_934c8_row3_col11\" class=\"data row3 col11\" >nan</td>\n      <td id=\"T_934c8_row3_col12\" class=\"data row3 col12\" >39.000000</td>\n      <td id=\"T_934c8_row3_col13\" class=\"data row3 col13\" >9.000000</td>\n      <td id=\"T_934c8_row3_col14\" class=\"data row3 col14\" >nan</td>\n      <td id=\"T_934c8_row3_col15\" class=\"data row3 col15\" >nan</td>\n      <td id=\"T_934c8_row3_col16\" class=\"data row3 col16\" >nan</td>\n      <td id=\"T_934c8_row3_col17\" class=\"data row3 col17\" >nan</td>\n    </tr>\n    <tr>\n      <th id=\"T_934c8_level0_row4\" class=\"row_heading level0 row4\" >4</th>\n      <td id=\"T_934c8_row4_col0\" class=\"data row4 col0\" >1996-08-09 14:30:00</td>\n      <td id=\"T_934c8_row4_col1\" class=\"data row4 col1\" >Sepang</td>\n      <td id=\"T_934c8_row4_col2\" class=\"data row4 col2\" >Sepang</td>\n      <td id=\"T_934c8_row4_col3\" class=\"data row4 col3\" >Kuala Lumpur</td>\n      <td id=\"T_934c8_row4_col4\" class=\"data row4 col4\" >nan</td>\n      <td id=\"T_934c8_row4_col5\" class=\"data row4 col5\" >nan</td>\n      <td id=\"T_934c8_row4_col6\" class=\"data row4 col6\" >nan</td>\n      <td id=\"T_934c8_row4_col7\" class=\"data row4 col7\" >nan</td>\n      <td id=\"T_934c8_row4_col8\" class=\"data row4 col8\" >7.000000</td>\n      <td id=\"T_934c8_row4_col9\" class=\"data row4 col9\" >nan</td>\n      <td id=\"T_934c8_row4_col10\" class=\"data row4 col10\" >nan</td>\n      <td id=\"T_934c8_row4_col11\" class=\"data row4 col11\" >nan</td>\n      <td id=\"T_934c8_row4_col12\" class=\"data row4 col12\" >nan</td>\n      <td id=\"T_934c8_row4_col13\" class=\"data row4 col13\" >9.000000</td>\n      <td id=\"T_934c8_row4_col14\" class=\"data row4 col14\" >nan</td>\n      <td id=\"T_934c8_row4_col15\" class=\"data row4 col15\" >nan</td>\n      <td id=\"T_934c8_row4_col16\" class=\"data row4 col16\" >nan</td>\n      <td id=\"T_934c8_row4_col17\" class=\"data row4 col17\" >nan</td>\n    </tr>\n  </tbody>\n</table>\n```\n:::\n:::\n\n\n::: {#ca4f701d .cell execution_count=7}\n``` {.python .cell-code}\nbirths.head().style.background_gradient(cmap='Greens')\n```\n\n::: {.cell-output .cell-output-display execution_count=6}\n```{=html}\n<style type=\"text/css\">\n#T_fc8a7_row0_col2 {\n  background-color: #f0f9ed;\n  color: #000000;\n}\n#T_fc8a7_row1_col2 {\n  background-color: #00441b;\n  color: #f1f1f1;\n}\n#T_fc8a7_row2_col2 {\n  background-color: #157f3b;\n  color: #f1f1f1;\n}\n#T_fc8a7_row3_col2 {\n  background-color: #b8e3b2;\n  color: #000000;\n}\n#T_fc8a7_row4_col2 {\n  background-color: #f7fcf5;\n  color: #000000;\n}\n</style>\n<table id=\"T_fc8a7\">\n  <thead>\n    <tr>\n      <th class=\"blank level0\" >&nbsp;</th>\n      <th id=\"T_fc8a7_level0_col0\" class=\"col_heading level0 col0\" >date</th>\n      <th id=\"T_fc8a7_level0_col1\" class=\"col_heading level0 col1\" >state</th>\n      <th id=\"T_fc8a7_level0_col2\" class=\"col_heading level0 col2\" >births</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th id=\"T_fc8a7_level0_row0\" class=\"row_heading level0 row0\" >0</th>\n      <td id=\"T_fc8a7_row0_col0\" class=\"data row0 col0\" >1920-01-01</td>\n      <td id=\"T_fc8a7_row0_col1\" class=\"data row0 col1\" >Malaysia</td>\n      <td id=\"T_fc8a7_row0_col2\" class=\"data row0 col2\" >96</td>\n    </tr>\n    <tr>\n      <th id=\"T_fc8a7_level0_row1\" class=\"row_heading level0 row1\" >1</th>\n      <td id=\"T_fc8a7_row1_col0\" class=\"data row1 col0\" >1920-01-02</td>\n      <td id=\"T_fc8a7_row1_col1\" class=\"data row1 col1\" >Malaysia</td>\n      <td id=\"T_fc8a7_row1_col2\" class=\"data row1 col2\" >115</td>\n    </tr>\n    <tr>\n      <th id=\"T_fc8a7_level0_row2\" class=\"row_heading level0 row2\" >2</th>\n      <td id=\"T_fc8a7_row2_col0\" class=\"data row2 col0\" >1920-01-03</td>\n      <td id=\"T_fc8a7_row2_col1\" class=\"data row2 col1\" >Malaysia</td>\n      <td id=\"T_fc8a7_row2_col2\" class=\"data row2 col2\" >111</td>\n    </tr>\n    <tr>\n      <th id=\"T_fc8a7_level0_row3\" class=\"row_heading level0 row3\" >3</th>\n      <td id=\"T_fc8a7_row3_col0\" class=\"data row3 col0\" >1920-01-04</td>\n      <td id=\"T_fc8a7_row3_col1\" class=\"data row3 col1\" >Malaysia</td>\n      <td id=\"T_fc8a7_row3_col2\" class=\"data row3 col2\" >101</td>\n    </tr>\n    <tr>\n      <th id=\"T_fc8a7_level0_row4\" class=\"row_heading level0 row4\" >4</th>\n      <td id=\"T_fc8a7_row4_col0\" class=\"data row4 col0\" >1920-01-05</td>\n      <td id=\"T_fc8a7_row4_col1\" class=\"data row4 col1\" >Malaysia</td>\n      <td id=\"T_fc8a7_row4_col2\" class=\"data row4 col2\" >95</td>\n    </tr>\n  </tbody>\n</table>\n```\n:::\n:::\n\n\nThe `datetime` column is a string, which we want to convert to a Pandas datetime object.\n\n::: {#6dab683b .cell execution_count=8}\n``` {.python .cell-code}\n# Convert the 'date' column in both dataframes to datetime\n\nweather['datetime'] = pd.to_datetime(weather['datetime'])\nbirths['date'] = pd.to_datetime(births['date'])\n```\n:::\n\n\nThe weather dataset contains multiple measurements in a single day, which we will need to aggregate to daily values. Also, different measurements are available for different locations - we will average these to get a single value for the whole country, as births are recorded at the national level.\n\n::: {#8f20f6d8 .cell execution_count=9}\n``` {.python .cell-code}\n# Average all features in the weather dataframe by day\n\nweather['date'] = weather['datetime'].dt.date\nbirths['date'] = births['date'].dt.date\n\n# Drop the columns 'place', 'city', 'state', and 'datetime'\nweather.drop(columns=['place', 'city', 'state', 'datetime'], inplace=True)\n\n# Group by date and calculate the mean\ndaily_average = weather.groupby('date').mean().reset_index()\n\n# Replace the original DataFrame with the new one\nweather = daily_average\n```\n:::\n\n\nLet's check what each column of the weather dataset now looks like, and statistics for each column.\n\n::: {#4e245209 .cell execution_count=10}\n``` {.python .cell-code}\nweather.describe().drop('count').style.background_gradient(cmap='Greens')\n```\n\n::: {.cell-output .cell-output-display execution_count=9}\n```{=html}\n<style type=\"text/css\">\n#T_fe424_row0_col0 {\n  background-color: #0c7735;\n  color: #f1f1f1;\n}\n#T_fe424_row0_col1, #T_fe424_row3_col1, #T_fe424_row4_col1 {\n  background-color: #00471c;\n  color: #f1f1f1;\n}\n#T_fe424_row0_col2 {\n  background-color: #006529;\n  color: #f1f1f1;\n}\n#T_fe424_row0_col3, #T_fe424_row5_col0 {\n  background-color: #087432;\n  color: #f1f1f1;\n}\n#T_fe424_row0_col4 {\n  background-color: #e2f4dd;\n  color: #000000;\n}\n#T_fe424_row0_col5, #T_fe424_row1_col13 {\n  background-color: #f1faee;\n  color: #000000;\n}\n#T_fe424_row0_col6, #T_fe424_row3_col3, #T_fe424_row4_col0, #T_fe424_row4_col6 {\n  background-color: #0d7836;\n  color: #f1f1f1;\n}\n#T_fe424_row0_col7 {\n  background-color: #cbebc5;\n  color: #000000;\n}\n#T_fe424_row0_col8 {\n  background-color: #228a44;\n  color: #f1f1f1;\n}\n#T_fe424_row0_col9 {\n  background-color: #005321;\n  color: #f1f1f1;\n}\n#T_fe424_row0_col10 {\n  background-color: #a9dca3;\n  color: #000000;\n}\n#T_fe424_row0_col11 {\n  background-color: #c6e8bf;\n  color: #000000;\n}\n#T_fe424_row0_col12, #T_fe424_row1_col0, #T_fe424_row1_col1, #T_fe424_row1_col2, #T_fe424_row1_col3, #T_fe424_row1_col6, #T_fe424_row1_col8, #T_fe424_row1_col9, #T_fe424_row1_col11, #T_fe424_row2_col4, #T_fe424_row2_col5, #T_fe424_row2_col7, #T_fe424_row2_col10, #T_fe424_row2_col12, #T_fe424_row2_col13, #T_fe424_row3_col7, #T_fe424_row3_col12, #T_fe424_row3_col13, #T_fe424_row4_col7, #T_fe424_row4_col12, #T_fe424_row4_col13, #T_fe424_row5_col12, #T_fe424_row5_col13 {\n  background-color: #f7fcf5;\n  color: #000000;\n}\n#T_fe424_row0_col13, #T_fe424_row3_col5 {\n  background-color: #f6fcf4;\n  color: #000000;\n}\n#T_fe424_row1_col4, #T_fe424_row1_col5, #T_fe424_row1_col12, #T_fe424_row2_col11 {\n  background-color: #f2faf0;\n  color: #000000;\n}\n#T_fe424_row1_col7, #T_fe424_row3_col10, #T_fe424_row5_col11 {\n  background-color: #b8e3b2;\n  color: #000000;\n}\n#T_fe424_row1_col10 {\n  background-color: #eaf7e6;\n  color: #000000;\n}\n#T_fe424_row2_col0, #T_fe424_row2_col6 {\n  background-color: #2f974e;\n  color: #f1f1f1;\n}\n#T_fe424_row2_col1 {\n  background-color: #00491d;\n  color: #f1f1f1;\n}\n#T_fe424_row2_col2 {\n  background-color: #73c476;\n  color: #000000;\n}\n#T_fe424_row2_col3 {\n  background-color: #e8f6e3;\n  color: #000000;\n}\n#T_fe424_row2_col8 {\n  background-color: #53b466;\n  color: #f1f1f1;\n}\n#T_fe424_row2_col9 {\n  background-color: #c1e6ba;\n  color: #000000;\n}\n#T_fe424_row3_col0, #T_fe424_row3_col6 {\n  background-color: #127c39;\n  color: #f1f1f1;\n}\n#T_fe424_row3_col2 {\n  background-color: #00692a;\n  color: #f1f1f1;\n}\n#T_fe424_row3_col4 {\n  background-color: #e6f5e1;\n  color: #000000;\n}\n#T_fe424_row3_col8 {\n  background-color: #29914a;\n  color: #f1f1f1;\n}\n#T_fe424_row3_col9 {\n  background-color: #005522;\n  color: #f1f1f1;\n}\n#T_fe424_row3_col11 {\n  background-color: #d2edcc;\n  color: #000000;\n}\n#T_fe424_row4_col2 {\n  background-color: #006428;\n  color: #f1f1f1;\n}\n#T_fe424_row4_col3 {\n  background-color: #05712f;\n  color: #f1f1f1;\n}\n#T_fe424_row4_col4 {\n  background-color: #def2d9;\n  color: #000000;\n}\n#T_fe424_row4_col5 {\n  background-color: #eff9ec;\n  color: #000000;\n}\n#T_fe424_row4_col8 {\n  background-color: #238b45;\n  color: #f1f1f1;\n}\n#T_fe424_row4_col9 {\n  background-color: #005020;\n  color: #f1f1f1;\n}\n#T_fe424_row4_col10 {\n  background-color: #a7dba0;\n  color: #000000;\n}\n#T_fe424_row4_col11 {\n  background-color: #c9eac2;\n  color: #000000;\n}\n#T_fe424_row5_col1 {\n  background-color: #00451c;\n  color: #f1f1f1;\n}\n#T_fe424_row5_col2 {\n  background-color: #005f26;\n  color: #f1f1f1;\n}\n#T_fe424_row5_col3 {\n  background-color: #006b2b;\n  color: #f1f1f1;\n}\n#T_fe424_row5_col4 {\n  background-color: #daf0d4;\n  color: #000000;\n}\n#T_fe424_row5_col5 {\n  background-color: #edf8ea;\n  color: #000000;\n}\n#T_fe424_row5_col6 {\n  background-color: #097532;\n  color: #f1f1f1;\n}\n#T_fe424_row5_col7 {\n  background-color: #60ba6c;\n  color: #f1f1f1;\n}\n#T_fe424_row5_col8 {\n  background-color: #1a843f;\n  color: #f1f1f1;\n}\n#T_fe424_row5_col9 {\n  background-color: #004c1e;\n  color: #f1f1f1;\n}\n#T_fe424_row5_col10 {\n  background-color: #97d492;\n  color: #000000;\n}\n#T_fe424_row6_col0, #T_fe424_row6_col1, #T_fe424_row6_col2, #T_fe424_row6_col3, #T_fe424_row6_col4, #T_fe424_row6_col5, #T_fe424_row6_col6, #T_fe424_row6_col7, #T_fe424_row6_col8, #T_fe424_row6_col9, #T_fe424_row6_col10, #T_fe424_row6_col11, #T_fe424_row6_col12, #T_fe424_row6_col13 {\n  background-color: #00441b;\n  color: #f1f1f1;\n}\n</style>\n<table id=\"T_fe424\">\n  <thead>\n    <tr>\n      <th class=\"blank level0\" >&nbsp;</th>\n      <th id=\"T_fe424_level0_col0\" class=\"col_heading level0 col0\" >temperature</th>\n      <th id=\"T_fe424_level0_col1\" class=\"col_heading level0 col1\" >pressure</th>\n      <th id=\"T_fe424_level0_col2\" class=\"col_heading level0 col2\" >dew_point</th>\n      <th id=\"T_fe424_level0_col3\" class=\"col_heading level0 col3\" >humidity</th>\n      <th id=\"T_fe424_level0_col4\" class=\"col_heading level0 col4\" >wind_speed</th>\n      <th id=\"T_fe424_level0_col5\" class=\"col_heading level0 col5\" >gust</th>\n      <th id=\"T_fe424_level0_col6\" class=\"col_heading level0 col6\" >wind_chill</th>\n      <th id=\"T_fe424_level0_col7\" class=\"col_heading level0 col7\" >uv_index</th>\n      <th id=\"T_fe424_level0_col8\" class=\"col_heading level0 col8\" >feels_like_temperature</th>\n      <th id=\"T_fe424_level0_col9\" class=\"col_heading level0 col9\" >visibility</th>\n      <th id=\"T_fe424_level0_col10\" class=\"col_heading level0 col10\" >solar_radiation</th>\n      <th id=\"T_fe424_level0_col11\" class=\"col_heading level0 col11\" >pollutant_value</th>\n      <th id=\"T_fe424_level0_col12\" class=\"col_heading level0 col12\" >precipitation_rate</th>\n      <th id=\"T_fe424_level0_col13\" class=\"col_heading level0 col13\" >precipitation_total</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th id=\"T_fe424_level0_row0\" class=\"row_heading level0 row0\" >mean</th>\n      <td id=\"T_fe424_row0_col0\" class=\"data row0 col0\" >27.543296</td>\n      <td id=\"T_fe424_row0_col1\" class=\"data row0 col1\" >1008.099890</td>\n      <td id=\"T_fe424_row0_col2\" class=\"data row0 col2\" >23.834273</td>\n      <td id=\"T_fe424_row0_col3\" class=\"data row0 col3\" >81.327786</td>\n      <td id=\"T_fe424_row0_col4\" class=\"data row0 col4\" >6.376730</td>\n      <td id=\"T_fe424_row0_col5\" class=\"data row0 col5\" >26.282709</td>\n      <td id=\"T_fe424_row0_col6\" class=\"data row0 col6\" >27.471683</td>\n      <td id=\"T_fe424_row0_col7\" class=\"data row0 col7\" >0.687915</td>\n      <td id=\"T_fe424_row0_col8\" class=\"data row0 col8\" >30.504578</td>\n      <td id=\"T_fe424_row0_col9\" class=\"data row0 col9\" >8.582930</td>\n      <td id=\"T_fe424_row0_col10\" class=\"data row0 col10\" >146.499316</td>\n      <td id=\"T_fe424_row0_col11\" class=\"data row0 col11\" >42.956782</td>\n      <td id=\"T_fe424_row0_col12\" class=\"data row0 col12\" >5.215477</td>\n      <td id=\"T_fe424_row0_col13\" class=\"data row0 col13\" >11.674262</td>\n    </tr>\n    <tr>\n      <th id=\"T_fe424_level0_row1\" class=\"row_heading level0 row1\" >std</th>\n      <td id=\"T_fe424_row1_col0\" class=\"data row1 col0\" >0.889741</td>\n      <td id=\"T_fe424_row1_col1\" class=\"data row1 col1\" >2.010950</td>\n      <td id=\"T_fe424_row1_col2\" class=\"data row1 col2\" >1.144247</td>\n      <td id=\"T_fe424_row1_col3\" class=\"data row1 col3\" >5.867251</td>\n      <td id=\"T_fe424_row1_col4\" class=\"data row1 col4\" >2.388884</td>\n      <td id=\"T_fe424_row1_col5\" class=\"data row1 col5\" >19.768379</td>\n      <td id=\"T_fe424_row1_col6\" class=\"data row1 col6\" >0.835277</td>\n      <td id=\"T_fe424_row1_col7\" class=\"data row1 col7\" >0.891434</td>\n      <td id=\"T_fe424_row1_col8\" class=\"data row1 col8\" >1.526218</td>\n      <td id=\"T_fe424_row1_col9\" class=\"data row1 col9\" >0.458520</td>\n      <td id=\"T_fe424_row1_col10\" class=\"data row1 col10\" >38.194387</td>\n      <td id=\"T_fe424_row1_col11\" class=\"data row1 col11\" >10.978799</td>\n      <td id=\"T_fe424_row1_col12\" class=\"data row1 col12\" >81.753558</td>\n      <td id=\"T_fe424_row1_col13\" class=\"data row1 col13\" >109.725370</td>\n    </tr>\n    <tr>\n      <th id=\"T_fe424_level0_row2\" class=\"row_heading level0 row2\" >min</th>\n      <td id=\"T_fe424_row2_col0\" class=\"data row2 col0\" >23.444444</td>\n      <td id=\"T_fe424_row2_col1\" class=\"data row2 col1\" >997.887076</td>\n      <td id=\"T_fe424_row2_col2\" class=\"data row2 col2\" >13.897368</td>\n      <td id=\"T_fe424_row2_col3\" class=\"data row2 col3\" >15.484936</td>\n      <td id=\"T_fe424_row2_col4\" class=\"data row2 col4\" >1.163329</td>\n      <td id=\"T_fe424_row2_col5\" class=\"data row2 col5\" >0.220339</td>\n      <td id=\"T_fe424_row2_col6\" class=\"data row2 col6\" >23.361953</td>\n      <td id=\"T_fe424_row2_col7\" class=\"data row2 col7\" >0.000000</td>\n      <td id=\"T_fe424_row2_col8\" class=\"data row2 col8\" >23.777778</td>\n      <td id=\"T_fe424_row2_col9\" class=\"data row2 col9\" >2.786753</td>\n      <td id=\"T_fe424_row2_col10\" class=\"data row2 col10\" >0.000000</td>\n      <td id=\"T_fe424_row2_col11\" class=\"data row2 col11\" >15.125438</td>\n      <td id=\"T_fe424_row2_col12\" class=\"data row2 col12\" >0.000000</td>\n      <td id=\"T_fe424_row2_col13\" class=\"data row2 col13\" >0.000000</td>\n    </tr>\n    <tr>\n      <th id=\"T_fe424_level0_row3\" class=\"row_heading level0 row3\" >25%</th>\n      <td id=\"T_fe424_row3_col0\" class=\"data row3 col0\" >26.934070</td>\n      <td id=\"T_fe424_row3_col1\" class=\"data row3 col1\" >1006.932785</td>\n      <td id=\"T_fe424_row3_col2\" class=\"data row3 col2\" >23.573865</td>\n      <td id=\"T_fe424_row3_col3\" class=\"data row3 col3\" >79.582090</td>\n      <td id=\"T_fe424_row3_col4\" class=\"data row3 col4\" >5.683849</td>\n      <td id=\"T_fe424_row3_col5\" class=\"data row3 col5\" >3.380416</td>\n      <td id=\"T_fe424_row3_col6\" class=\"data row3 col6\" >26.909586</td>\n      <td id=\"T_fe424_row3_col7\" class=\"data row3 col7\" >0.000000</td>\n      <td id=\"T_fe424_row3_col8\" class=\"data row3 col8\" >29.448357</td>\n      <td id=\"T_fe424_row3_col9\" class=\"data row3 col9\" >8.538924</td>\n      <td id=\"T_fe424_row3_col10\" class=\"data row3 col10\" >124.749915</td>\n      <td id=\"T_fe424_row3_col11\" class=\"data row3 col11\" >36.769231</td>\n      <td id=\"T_fe424_row3_col12\" class=\"data row3 col12\" >0.031584</td>\n      <td id=\"T_fe424_row3_col13\" class=\"data row3 col13\" >0.390435</td>\n    </tr>\n    <tr>\n      <th id=\"T_fe424_level0_row4\" class=\"row_heading level0 row4\" >50%</th>\n      <td id=\"T_fe424_row4_col0\" class=\"data row4 col0\" >27.457458</td>\n      <td id=\"T_fe424_row4_col1\" class=\"data row4 col1\" >1008.033583</td>\n      <td id=\"T_fe424_row4_col2\" class=\"data row4 col2\" >24.001509</td>\n      <td id=\"T_fe424_row4_col3\" class=\"data row4 col3\" >82.568477</td>\n      <td id=\"T_fe424_row4_col4\" class=\"data row4 col4\" >6.919926</td>\n      <td id=\"T_fe424_row4_col5\" class=\"data row4 col5\" >33.250000</td>\n      <td id=\"T_fe424_row4_col6\" class=\"data row4 col6\" >27.404160</td>\n      <td id=\"T_fe424_row4_col7\" class=\"data row4 col7\" >0.000000</td>\n      <td id=\"T_fe424_row4_col8\" class=\"data row4 col8\" >30.364568</td>\n      <td id=\"T_fe424_row4_col9\" class=\"data row4 col9\" >8.681920</td>\n      <td id=\"T_fe424_row4_col10\" class=\"data row4 col10\" >149.442652</td>\n      <td id=\"T_fe424_row4_col11\" class=\"data row4 col11\" >41.880000</td>\n      <td id=\"T_fe424_row4_col12\" class=\"data row4 col12\" >0.212534</td>\n      <td id=\"T_fe424_row4_col13\" class=\"data row4 col13\" >2.106173</td>\n    </tr>\n    <tr>\n      <th id=\"T_fe424_level0_row5\" class=\"row_heading level0 row5\" >75%</th>\n      <td id=\"T_fe424_row5_col0\" class=\"data row5 col0\" >28.073267</td>\n      <td id=\"T_fe424_row5_col1\" class=\"data row5 col1\" >1009.330966</td>\n      <td id=\"T_fe424_row5_col2\" class=\"data row5 col2\" >24.411568</td>\n      <td id=\"T_fe424_row5_col3\" class=\"data row5 col3\" >84.750354</td>\n      <td id=\"T_fe424_row5_col4\" class=\"data row5 col4\" >7.739110</td>\n      <td id=\"T_fe424_row5_col5\" class=\"data row5 col5\" >40.400000</td>\n      <td id=\"T_fe424_row5_col6\" class=\"data row5 col6\" >27.971838</td>\n      <td id=\"T_fe424_row5_col7\" class=\"data row5 col7\" >1.635242</td>\n      <td id=\"T_fe424_row5_col8\" class=\"data row5 col8\" >31.464080</td>\n      <td id=\"T_fe424_row5_col9\" class=\"data row5 col9\" >8.786272</td>\n      <td id=\"T_fe424_row5_col10\" class=\"data row5 col10\" >170.528152</td>\n      <td id=\"T_fe424_row5_col11\" class=\"data row5 col11\" >48.311878</td>\n      <td id=\"T_fe424_row5_col12\" class=\"data row5 col12\" >0.543907</td>\n      <td id=\"T_fe424_row5_col13\" class=\"data row5 col13\" >5.624009</td>\n    </tr>\n    <tr>\n      <th id=\"T_fe424_level0_row6\" class=\"row_heading level0 row6\" >max</th>\n      <td id=\"T_fe424_row6_col0\" class=\"data row6 col0\" >33.000000</td>\n      <td id=\"T_fe424_row6_col1\" class=\"data row6 col1\" >1016.209393</td>\n      <td id=\"T_fe424_row6_col2\" class=\"data row6 col2\" >26.504087</td>\n      <td id=\"T_fe424_row6_col3\" class=\"data row6 col3\" >95.250709</td>\n      <td id=\"T_fe424_row6_col4\" class=\"data row6 col4\" >38.743243</td>\n      <td id=\"T_fe424_row6_col5\" class=\"data row6 col5\" >593.000000</td>\n      <td id=\"T_fe424_row6_col6\" class=\"data row6 col6\" >33.000000</td>\n      <td id=\"T_fe424_row6_col7\" class=\"data row6 col7\" >2.972896</td>\n      <td id=\"T_fe424_row6_col8\" class=\"data row6 col8\" >40.000000</td>\n      <td id=\"T_fe424_row6_col9\" class=\"data row6 col9\" >9.000000</td>\n      <td id=\"T_fe424_row6_col10\" class=\"data row6 col10\" >419.813559</td>\n      <td id=\"T_fe424_row6_col11\" class=\"data row6 col11\" >136.627451</td>\n      <td id=\"T_fe424_row6_col12\" class=\"data row6 col12\" >2539.750000</td>\n      <td id=\"T_fe424_row6_col13\" class=\"data row6 col13\" >2539.750000</td>\n    </tr>\n  </tbody>\n</table>\n```\n:::\n:::\n\n\nWe have two separate datasets, one for weather and one for births. Let us merge these on the date column.\n\n::: {#25fe2027 .cell execution_count=11}\n``` {.python .cell-code}\n# Merge the two dataframes on the 'date' column, where the date is a datetime64 type\n\ndata = pd.merge(births, weather, on='date')\ndata.drop(columns=['state'], inplace=True)\n```\n:::\n\n\n::: {#5abd2227 .cell execution_count=12}\n``` {.python .cell-code}\ndata.head().style.background_gradient(cmap='Greens')\n```\n\n::: {.cell-output .cell-output-display execution_count=11}\n```{=html}\n<style type=\"text/css\">\n#T_de62f_row0_col1 {\n  background-color: #bbe4b4;\n  color: #000000;\n}\n#T_de62f_row0_col2 {\n  background-color: #42ab5d;\n  color: #f1f1f1;\n}\n#T_de62f_row0_col3 {\n  background-color: #3ba458;\n  color: #f1f1f1;\n}\n#T_de62f_row0_col4, #T_de62f_row1_col5, #T_de62f_row2_col3, #T_de62f_row3_col1, #T_de62f_row4_col2, #T_de62f_row4_col6, #T_de62f_row4_col8, #T_de62f_row4_col10, #T_de62f_row4_col11 {\n  background-color: #00441b;\n  color: #f1f1f1;\n}\n#T_de62f_row0_col5 {\n  background-color: #a3da9d;\n  color: #000000;\n}\n#T_de62f_row0_col6 {\n  background-color: #f0f9ec;\n  color: #000000;\n}\n#T_de62f_row0_col7, #T_de62f_row0_col12, #T_de62f_row0_col13, #T_de62f_row0_col14, #T_de62f_row0_col15, #T_de62f_row1_col7, #T_de62f_row1_col12, #T_de62f_row1_col13, #T_de62f_row1_col14, #T_de62f_row1_col15, #T_de62f_row2_col7, #T_de62f_row2_col12, #T_de62f_row2_col13, #T_de62f_row2_col14, #T_de62f_row2_col15, #T_de62f_row3_col7, #T_de62f_row3_col12, #T_de62f_row3_col13, #T_de62f_row3_col14, #T_de62f_row3_col15, #T_de62f_row4_col7, #T_de62f_row4_col12, #T_de62f_row4_col13, #T_de62f_row4_col14, #T_de62f_row4_col15 {\n  background-color: #000000;\n  color: #f1f1f1;\n}\n#T_de62f_row0_col8, #T_de62f_row0_col10 {\n  background-color: #43ac5e;\n  color: #f1f1f1;\n}\n#T_de62f_row0_col9, #T_de62f_row1_col2, #T_de62f_row1_col8, #T_de62f_row1_col9, #T_de62f_row1_col10, #T_de62f_row1_col11, #T_de62f_row2_col1, #T_de62f_row2_col4, #T_de62f_row2_col9, #T_de62f_row3_col6, #T_de62f_row3_col9, #T_de62f_row4_col3, #T_de62f_row4_col5, #T_de62f_row4_col9 {\n  background-color: #f7fcf5;\n  color: #000000;\n}\n#T_de62f_row0_col11 {\n  background-color: #52b365;\n  color: #f1f1f1;\n}\n#T_de62f_row1_col1 {\n  background-color: #a9dca3;\n  color: #000000;\n}\n#T_de62f_row1_col3 {\n  background-color: #004c1e;\n  color: #f1f1f1;\n}\n#T_de62f_row1_col4 {\n  background-color: #58b668;\n  color: #f1f1f1;\n}\n#T_de62f_row1_col6 {\n  background-color: #78c679;\n  color: #000000;\n}\n#T_de62f_row2_col2, #T_de62f_row2_col10 {\n  background-color: #eaf7e6;\n  color: #000000;\n}\n#T_de62f_row2_col5 {\n  background-color: #05712f;\n  color: #f1f1f1;\n}\n#T_de62f_row2_col6 {\n  background-color: #c1e6ba;\n  color: #000000;\n}\n#T_de62f_row2_col8, #T_de62f_row3_col2, #T_de62f_row3_col8 {\n  background-color: #f1faee;\n  color: #000000;\n}\n#T_de62f_row2_col11 {\n  background-color: #b6e2af;\n  color: #000000;\n}\n#T_de62f_row3_col3 {\n  background-color: #5eb96b;\n  color: #f1f1f1;\n}\n#T_de62f_row3_col4 {\n  background-color: #83cb82;\n  color: #000000;\n}\n#T_de62f_row3_col5 {\n  background-color: #005622;\n  color: #f1f1f1;\n}\n#T_de62f_row3_col10 {\n  background-color: #f2faef;\n  color: #000000;\n}\n#T_de62f_row3_col11 {\n  background-color: #56b567;\n  color: #f1f1f1;\n}\n#T_de62f_row4_col1 {\n  background-color: #3ca559;\n  color: #f1f1f1;\n}\n#T_de62f_row4_col4 {\n  background-color: #319a50;\n  color: #f1f1f1;\n}\n</style>\n<table id=\"T_de62f\">\n  <thead>\n    <tr>\n      <th class=\"blank level0\" >&nbsp;</th>\n      <th id=\"T_de62f_level0_col0\" class=\"col_heading level0 col0\" >date</th>\n      <th id=\"T_de62f_level0_col1\" class=\"col_heading level0 col1\" >births</th>\n      <th id=\"T_de62f_level0_col2\" class=\"col_heading level0 col2\" >temperature</th>\n      <th id=\"T_de62f_level0_col3\" class=\"col_heading level0 col3\" >pressure</th>\n      <th id=\"T_de62f_level0_col4\" class=\"col_heading level0 col4\" >dew_point</th>\n      <th id=\"T_de62f_level0_col5\" class=\"col_heading level0 col5\" >humidity</th>\n      <th id=\"T_de62f_level0_col6\" class=\"col_heading level0 col6\" >wind_speed</th>\n      <th id=\"T_de62f_level0_col7\" class=\"col_heading level0 col7\" >gust</th>\n      <th id=\"T_de62f_level0_col8\" class=\"col_heading level0 col8\" >wind_chill</th>\n      <th id=\"T_de62f_level0_col9\" class=\"col_heading level0 col9\" >uv_index</th>\n      <th id=\"T_de62f_level0_col10\" class=\"col_heading level0 col10\" >feels_like_temperature</th>\n      <th id=\"T_de62f_level0_col11\" class=\"col_heading level0 col11\" >visibility</th>\n      <th id=\"T_de62f_level0_col12\" class=\"col_heading level0 col12\" >solar_radiation</th>\n      <th id=\"T_de62f_level0_col13\" class=\"col_heading level0 col13\" >pollutant_value</th>\n      <th id=\"T_de62f_level0_col14\" class=\"col_heading level0 col14\" >precipitation_rate</th>\n      <th id=\"T_de62f_level0_col15\" class=\"col_heading level0 col15\" >precipitation_total</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th id=\"T_de62f_level0_row0\" class=\"row_heading level0 row0\" >0</th>\n      <td id=\"T_de62f_row0_col0\" class=\"data row0 col0\" >1996-08-09</td>\n      <td id=\"T_de62f_row0_col1\" class=\"data row0 col1\" >1520</td>\n      <td id=\"T_de62f_row0_col2\" class=\"data row0 col2\" >29.714286</td>\n      <td id=\"T_de62f_row0_col3\" class=\"data row0 col3\" >1005.877143</td>\n      <td id=\"T_de62f_row0_col4\" class=\"data row0 col4\" >24.000000</td>\n      <td id=\"T_de62f_row0_col5\" class=\"data row0 col5\" >72.571429</td>\n      <td id=\"T_de62f_row0_col6\" class=\"data row0 col6\" >5.857143</td>\n      <td id=\"T_de62f_row0_col7\" class=\"data row0 col7\" >nan</td>\n      <td id=\"T_de62f_row0_col8\" class=\"data row0 col8\" >29.714286</td>\n      <td id=\"T_de62f_row0_col9\" class=\"data row0 col9\" >nan</td>\n      <td id=\"T_de62f_row0_col10\" class=\"data row0 col10\" >33.571429</td>\n      <td id=\"T_de62f_row0_col11\" class=\"data row0 col11\" >8.625000</td>\n      <td id=\"T_de62f_row0_col12\" class=\"data row0 col12\" >nan</td>\n      <td id=\"T_de62f_row0_col13\" class=\"data row0 col13\" >nan</td>\n      <td id=\"T_de62f_row0_col14\" class=\"data row0 col14\" >nan</td>\n      <td id=\"T_de62f_row0_col15\" class=\"data row0 col15\" >nan</td>\n    </tr>\n    <tr>\n      <th id=\"T_de62f_level0_row1\" class=\"row_heading level0 row1\" >1</th>\n      <td id=\"T_de62f_row1_col0\" class=\"data row1 col0\" >1996-08-17</td>\n      <td id=\"T_de62f_row1_col1\" class=\"data row1 col1\" >1539</td>\n      <td id=\"T_de62f_row1_col2\" class=\"data row1 col2\" >25.407407</td>\n      <td id=\"T_de62f_row1_col3\" class=\"data row1 col3\" >1007.800690</td>\n      <td id=\"T_de62f_row1_col4\" class=\"data row1 col4\" >23.769231</td>\n      <td id=\"T_de62f_row1_col5\" class=\"data row1 col5\" >90.615385</td>\n      <td id=\"T_de62f_row1_col6\" class=\"data row1 col6\" >7.695652</td>\n      <td id=\"T_de62f_row1_col7\" class=\"data row1 col7\" >nan</td>\n      <td id=\"T_de62f_row1_col8\" class=\"data row1 col8\" >25.423077</td>\n      <td id=\"T_de62f_row1_col9\" class=\"data row1 col9\" >0.000000</td>\n      <td id=\"T_de62f_row1_col10\" class=\"data row1 col10\" >26.615385</td>\n      <td id=\"T_de62f_row1_col11\" class=\"data row1 col11\" >8.096774</td>\n      <td id=\"T_de62f_row1_col12\" class=\"data row1 col12\" >nan</td>\n      <td id=\"T_de62f_row1_col13\" class=\"data row1 col13\" >nan</td>\n      <td id=\"T_de62f_row1_col14\" class=\"data row1 col14\" >nan</td>\n      <td id=\"T_de62f_row1_col15\" class=\"data row1 col15\" >nan</td>\n    </tr>\n    <tr>\n      <th id=\"T_de62f_level0_row2\" class=\"row_heading level0 row2\" >2</th>\n      <td id=\"T_de62f_row2_col0\" class=\"data row2 col0\" >1996-08-18</td>\n      <td id=\"T_de62f_row2_col1\" class=\"data row2 col1\" >1423</td>\n      <td id=\"T_de62f_row2_col2\" class=\"data row2 col2\" >26.035714</td>\n      <td id=\"T_de62f_row2_col3\" class=\"data row2 col3\" >1007.954800</td>\n      <td id=\"T_de62f_row2_col4\" class=\"data row2 col4\" >23.464286</td>\n      <td id=\"T_de62f_row2_col5\" class=\"data row2 col5\" >86.500000</td>\n      <td id=\"T_de62f_row2_col6\" class=\"data row2 col6\" >6.775000</td>\n      <td id=\"T_de62f_row2_col7\" class=\"data row2 col7\" >nan</td>\n      <td id=\"T_de62f_row2_col8\" class=\"data row2 col8\" >25.700000</td>\n      <td id=\"T_de62f_row2_col9\" class=\"data row2 col9\" >0.000000</td>\n      <td id=\"T_de62f_row2_col10\" class=\"data row2 col10\" >27.660714</td>\n      <td id=\"T_de62f_row2_col11\" class=\"data row2 col11\" >8.372881</td>\n      <td id=\"T_de62f_row2_col12\" class=\"data row2 col12\" >nan</td>\n      <td id=\"T_de62f_row2_col13\" class=\"data row2 col13\" >nan</td>\n      <td id=\"T_de62f_row2_col14\" class=\"data row2 col14\" >nan</td>\n      <td id=\"T_de62f_row2_col15\" class=\"data row2 col15\" >nan</td>\n    </tr>\n    <tr>\n      <th id=\"T_de62f_level0_row3\" class=\"row_heading level0 row3\" >3</th>\n      <td id=\"T_de62f_row3_col0\" class=\"data row3 col0\" >1996-09-11</td>\n      <td id=\"T_de62f_row3_col1\" class=\"data row3 col1\" >1756</td>\n      <td id=\"T_de62f_row3_col2\" class=\"data row3 col2\" >25.709677</td>\n      <td id=\"T_de62f_row3_col3\" class=\"data row3 col3\" >1005.271724</td>\n      <td id=\"T_de62f_row3_col4\" class=\"data row3 col4\" >23.709677</td>\n      <td id=\"T_de62f_row3_col5\" class=\"data row3 col5\" >88.967742</td>\n      <td id=\"T_de62f_row3_col6\" class=\"data row3 col6\" >5.631579</td>\n      <td id=\"T_de62f_row3_col7\" class=\"data row3 col7\" >nan</td>\n      <td id=\"T_de62f_row3_col8\" class=\"data row3 col8\" >25.709677</td>\n      <td id=\"T_de62f_row3_col9\" class=\"data row3 col9\" >0.000000</td>\n      <td id=\"T_de62f_row3_col10\" class=\"data row3 col10\" >27.032258</td>\n      <td id=\"T_de62f_row3_col11\" class=\"data row3 col11\" >8.612903</td>\n      <td id=\"T_de62f_row3_col12\" class=\"data row3 col12\" >nan</td>\n      <td id=\"T_de62f_row3_col13\" class=\"data row3 col13\" >nan</td>\n      <td id=\"T_de62f_row3_col14\" class=\"data row3 col14\" >nan</td>\n      <td id=\"T_de62f_row3_col15\" class=\"data row3 col15\" >nan</td>\n    </tr>\n    <tr>\n      <th id=\"T_de62f_level0_row4\" class=\"row_heading level0 row4\" >4</th>\n      <td id=\"T_de62f_row4_col0\" class=\"data row4 col0\" >1996-09-12</td>\n      <td id=\"T_de62f_row4_col1\" class=\"data row4 col1\" >1638</td>\n      <td id=\"T_de62f_row4_col2\" class=\"data row4 col2\" >32.333333</td>\n      <td id=\"T_de62f_row4_col3\" class=\"data row4 col3\" >1001.980000</td>\n      <td id=\"T_de62f_row4_col4\" class=\"data row4 col4\" >23.833333</td>\n      <td id=\"T_de62f_row4_col5\" class=\"data row4 col5\" >62.000000</td>\n      <td id=\"T_de62f_row4_col6\" class=\"data row4 col6\" >9.833333</td>\n      <td id=\"T_de62f_row4_col7\" class=\"data row4 col7\" >nan</td>\n      <td id=\"T_de62f_row4_col8\" class=\"data row4 col8\" >32.333333</td>\n      <td id=\"T_de62f_row4_col9\" class=\"data row4 col9\" >nan</td>\n      <td id=\"T_de62f_row4_col10\" class=\"data row4 col10\" >37.833333</td>\n      <td id=\"T_de62f_row4_col11\" class=\"data row4 col11\" >9.000000</td>\n      <td id=\"T_de62f_row4_col12\" class=\"data row4 col12\" >nan</td>\n      <td id=\"T_de62f_row4_col13\" class=\"data row4 col13\" >nan</td>\n      <td id=\"T_de62f_row4_col14\" class=\"data row4 col14\" >nan</td>\n      <td id=\"T_de62f_row4_col15\" class=\"data row4 col15\" >nan</td>\n    </tr>\n  </tbody>\n</table>\n```\n:::\n:::\n\n\nLet us also fill in any missing values using the mean for each column to fill in the gaps. This is a simple approach, and in practice more sophisticated methods to fill in missing data would need to be considered. For the purposes of this experiment, it will suffice.\n\n::: {#e70e0e0a .cell execution_count=13}\n``` {.python .cell-code}\n# Fill in missing values for each numerical column with the mean of that column\n\nmean_values = data.select_dtypes(include='number').mean()\ndata.fillna(mean_values, inplace=True)\n```\n:::\n\n\n::: {#2c3a1255 .cell execution_count=14}\n``` {.python .cell-code}\ndata.head().style.background_gradient(cmap='Greens')\n```\n\n::: {.cell-output .cell-output-display execution_count=13}\n```{=html}\n<style type=\"text/css\">\n#T_1915a_row0_col1 {\n  background-color: #bbe4b4;\n  color: #000000;\n}\n#T_1915a_row0_col2 {\n  background-color: #42ab5d;\n  color: #f1f1f1;\n}\n#T_1915a_row0_col3 {\n  background-color: #3ba458;\n  color: #f1f1f1;\n}\n#T_1915a_row0_col4, #T_1915a_row0_col9, #T_1915a_row1_col5, #T_1915a_row2_col3, #T_1915a_row3_col1, #T_1915a_row4_col2, #T_1915a_row4_col6, #T_1915a_row4_col8, #T_1915a_row4_col9, #T_1915a_row4_col10, #T_1915a_row4_col11 {\n  background-color: #00441b;\n  color: #f1f1f1;\n}\n#T_1915a_row0_col5 {\n  background-color: #a3da9d;\n  color: #000000;\n}\n#T_1915a_row0_col6 {\n  background-color: #f0f9ec;\n  color: #000000;\n}\n#T_1915a_row0_col7, #T_1915a_row0_col12, #T_1915a_row0_col13, #T_1915a_row0_col14, #T_1915a_row0_col15, #T_1915a_row1_col2, #T_1915a_row1_col7, #T_1915a_row1_col8, #T_1915a_row1_col9, #T_1915a_row1_col10, #T_1915a_row1_col11, #T_1915a_row1_col12, #T_1915a_row1_col13, #T_1915a_row1_col14, #T_1915a_row1_col15, #T_1915a_row2_col1, #T_1915a_row2_col4, #T_1915a_row2_col7, #T_1915a_row2_col9, #T_1915a_row2_col12, #T_1915a_row2_col13, #T_1915a_row2_col14, #T_1915a_row2_col15, #T_1915a_row3_col6, #T_1915a_row3_col7, #T_1915a_row3_col9, #T_1915a_row3_col12, #T_1915a_row3_col13, #T_1915a_row3_col14, #T_1915a_row3_col15, #T_1915a_row4_col3, #T_1915a_row4_col5, #T_1915a_row4_col7, #T_1915a_row4_col12, #T_1915a_row4_col13, #T_1915a_row4_col14, #T_1915a_row4_col15 {\n  background-color: #f7fcf5;\n  color: #000000;\n}\n#T_1915a_row0_col8, #T_1915a_row0_col10 {\n  background-color: #43ac5e;\n  color: #f1f1f1;\n}\n#T_1915a_row0_col11 {\n  background-color: #52b365;\n  color: #f1f1f1;\n}\n#T_1915a_row1_col1 {\n  background-color: #a9dca3;\n  color: #000000;\n}\n#T_1915a_row1_col3 {\n  background-color: #004c1e;\n  color: #f1f1f1;\n}\n#T_1915a_row1_col4 {\n  background-color: #58b668;\n  color: #f1f1f1;\n}\n#T_1915a_row1_col6 {\n  background-color: #78c679;\n  color: #000000;\n}\n#T_1915a_row2_col2, #T_1915a_row2_col10 {\n  background-color: #eaf7e6;\n  color: #000000;\n}\n#T_1915a_row2_col5 {\n  background-color: #05712f;\n  color: #f1f1f1;\n}\n#T_1915a_row2_col6 {\n  background-color: #c1e6ba;\n  color: #000000;\n}\n#T_1915a_row2_col8, #T_1915a_row3_col2, #T_1915a_row3_col8 {\n  background-color: #f1faee;\n  color: #000000;\n}\n#T_1915a_row2_col11 {\n  background-color: #b6e2af;\n  color: #000000;\n}\n#T_1915a_row3_col3 {\n  background-color: #5eb96b;\n  color: #f1f1f1;\n}\n#T_1915a_row3_col4 {\n  background-color: #83cb82;\n  color: #000000;\n}\n#T_1915a_row3_col5 {\n  background-color: #005622;\n  color: #f1f1f1;\n}\n#T_1915a_row3_col10 {\n  background-color: #f2faef;\n  color: #000000;\n}\n#T_1915a_row3_col11 {\n  background-color: #56b567;\n  color: #f1f1f1;\n}\n#T_1915a_row4_col1 {\n  background-color: #3ca559;\n  color: #f1f1f1;\n}\n#T_1915a_row4_col4 {\n  background-color: #319a50;\n  color: #f1f1f1;\n}\n</style>\n<table id=\"T_1915a\">\n  <thead>\n    <tr>\n      <th class=\"blank level0\" >&nbsp;</th>\n      <th id=\"T_1915a_level0_col0\" class=\"col_heading level0 col0\" >date</th>\n      <th id=\"T_1915a_level0_col1\" class=\"col_heading level0 col1\" >births</th>\n      <th id=\"T_1915a_level0_col2\" class=\"col_heading level0 col2\" >temperature</th>\n      <th id=\"T_1915a_level0_col3\" class=\"col_heading level0 col3\" >pressure</th>\n      <th id=\"T_1915a_level0_col4\" class=\"col_heading level0 col4\" >dew_point</th>\n      <th id=\"T_1915a_level0_col5\" class=\"col_heading level0 col5\" >humidity</th>\n      <th id=\"T_1915a_level0_col6\" class=\"col_heading level0 col6\" >wind_speed</th>\n      <th id=\"T_1915a_level0_col7\" class=\"col_heading level0 col7\" >gust</th>\n      <th id=\"T_1915a_level0_col8\" class=\"col_heading level0 col8\" >wind_chill</th>\n      <th id=\"T_1915a_level0_col9\" class=\"col_heading level0 col9\" >uv_index</th>\n      <th id=\"T_1915a_level0_col10\" class=\"col_heading level0 col10\" >feels_like_temperature</th>\n      <th id=\"T_1915a_level0_col11\" class=\"col_heading level0 col11\" >visibility</th>\n      <th id=\"T_1915a_level0_col12\" class=\"col_heading level0 col12\" >solar_radiation</th>\n      <th id=\"T_1915a_level0_col13\" class=\"col_heading level0 col13\" >pollutant_value</th>\n      <th id=\"T_1915a_level0_col14\" class=\"col_heading level0 col14\" >precipitation_rate</th>\n      <th id=\"T_1915a_level0_col15\" class=\"col_heading level0 col15\" >precipitation_total</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th id=\"T_1915a_level0_row0\" class=\"row_heading level0 row0\" >0</th>\n      <td id=\"T_1915a_row0_col0\" class=\"data row0 col0\" >1996-08-09</td>\n      <td id=\"T_1915a_row0_col1\" class=\"data row0 col1\" >1520</td>\n      <td id=\"T_1915a_row0_col2\" class=\"data row0 col2\" >29.714286</td>\n      <td id=\"T_1915a_row0_col3\" class=\"data row0 col3\" >1005.877143</td>\n      <td id=\"T_1915a_row0_col4\" class=\"data row0 col4\" >24.000000</td>\n      <td id=\"T_1915a_row0_col5\" class=\"data row0 col5\" >72.571429</td>\n      <td id=\"T_1915a_row0_col6\" class=\"data row0 col6\" >5.857143</td>\n      <td id=\"T_1915a_row0_col7\" class=\"data row0 col7\" >27.890241</td>\n      <td id=\"T_1915a_row0_col8\" class=\"data row0 col8\" >29.714286</td>\n      <td id=\"T_1915a_row0_col9\" class=\"data row0 col9\" >0.651795</td>\n      <td id=\"T_1915a_row0_col10\" class=\"data row0 col10\" >33.571429</td>\n      <td id=\"T_1915a_row0_col11\" class=\"data row0 col11\" >8.625000</td>\n      <td id=\"T_1915a_row0_col12\" class=\"data row0 col12\" >145.609684</td>\n      <td id=\"T_1915a_row0_col13\" class=\"data row0 col13\" >42.495870</td>\n      <td id=\"T_1915a_row0_col14\" class=\"data row0 col14\" >5.762057</td>\n      <td id=\"T_1915a_row0_col15\" class=\"data row0 col15\" >12.349303</td>\n    </tr>\n    <tr>\n      <th id=\"T_1915a_level0_row1\" class=\"row_heading level0 row1\" >1</th>\n      <td id=\"T_1915a_row1_col0\" class=\"data row1 col0\" >1996-08-17</td>\n      <td id=\"T_1915a_row1_col1\" class=\"data row1 col1\" >1539</td>\n      <td id=\"T_1915a_row1_col2\" class=\"data row1 col2\" >25.407407</td>\n      <td id=\"T_1915a_row1_col3\" class=\"data row1 col3\" >1007.800690</td>\n      <td id=\"T_1915a_row1_col4\" class=\"data row1 col4\" >23.769231</td>\n      <td id=\"T_1915a_row1_col5\" class=\"data row1 col5\" >90.615385</td>\n      <td id=\"T_1915a_row1_col6\" class=\"data row1 col6\" >7.695652</td>\n      <td id=\"T_1915a_row1_col7\" class=\"data row1 col7\" >27.890241</td>\n      <td id=\"T_1915a_row1_col8\" class=\"data row1 col8\" >25.423077</td>\n      <td id=\"T_1915a_row1_col9\" class=\"data row1 col9\" >0.000000</td>\n      <td id=\"T_1915a_row1_col10\" class=\"data row1 col10\" >26.615385</td>\n      <td id=\"T_1915a_row1_col11\" class=\"data row1 col11\" >8.096774</td>\n      <td id=\"T_1915a_row1_col12\" class=\"data row1 col12\" >145.609684</td>\n      <td id=\"T_1915a_row1_col13\" class=\"data row1 col13\" >42.495870</td>\n      <td id=\"T_1915a_row1_col14\" class=\"data row1 col14\" >5.762057</td>\n      <td id=\"T_1915a_row1_col15\" class=\"data row1 col15\" >12.349303</td>\n    </tr>\n    <tr>\n      <th id=\"T_1915a_level0_row2\" class=\"row_heading level0 row2\" >2</th>\n      <td id=\"T_1915a_row2_col0\" class=\"data row2 col0\" >1996-08-18</td>\n      <td id=\"T_1915a_row2_col1\" class=\"data row2 col1\" >1423</td>\n      <td id=\"T_1915a_row2_col2\" class=\"data row2 col2\" >26.035714</td>\n      <td id=\"T_1915a_row2_col3\" class=\"data row2 col3\" >1007.954800</td>\n      <td id=\"T_1915a_row2_col4\" class=\"data row2 col4\" >23.464286</td>\n      <td id=\"T_1915a_row2_col5\" class=\"data row2 col5\" >86.500000</td>\n      <td id=\"T_1915a_row2_col6\" class=\"data row2 col6\" >6.775000</td>\n      <td id=\"T_1915a_row2_col7\" class=\"data row2 col7\" >27.890241</td>\n      <td id=\"T_1915a_row2_col8\" class=\"data row2 col8\" >25.700000</td>\n      <td id=\"T_1915a_row2_col9\" class=\"data row2 col9\" >0.000000</td>\n      <td id=\"T_1915a_row2_col10\" class=\"data row2 col10\" >27.660714</td>\n      <td id=\"T_1915a_row2_col11\" class=\"data row2 col11\" >8.372881</td>\n      <td id=\"T_1915a_row2_col12\" class=\"data row2 col12\" >145.609684</td>\n      <td id=\"T_1915a_row2_col13\" class=\"data row2 col13\" >42.495870</td>\n      <td id=\"T_1915a_row2_col14\" class=\"data row2 col14\" >5.762057</td>\n      <td id=\"T_1915a_row2_col15\" class=\"data row2 col15\" >12.349303</td>\n    </tr>\n    <tr>\n      <th id=\"T_1915a_level0_row3\" class=\"row_heading level0 row3\" >3</th>\n      <td id=\"T_1915a_row3_col0\" class=\"data row3 col0\" >1996-09-11</td>\n      <td id=\"T_1915a_row3_col1\" class=\"data row3 col1\" >1756</td>\n      <td id=\"T_1915a_row3_col2\" class=\"data row3 col2\" >25.709677</td>\n      <td id=\"T_1915a_row3_col3\" class=\"data row3 col3\" >1005.271724</td>\n      <td id=\"T_1915a_row3_col4\" class=\"data row3 col4\" >23.709677</td>\n      <td id=\"T_1915a_row3_col5\" class=\"data row3 col5\" >88.967742</td>\n      <td id=\"T_1915a_row3_col6\" class=\"data row3 col6\" >5.631579</td>\n      <td id=\"T_1915a_row3_col7\" class=\"data row3 col7\" >27.890241</td>\n      <td id=\"T_1915a_row3_col8\" class=\"data row3 col8\" >25.709677</td>\n      <td id=\"T_1915a_row3_col9\" class=\"data row3 col9\" >0.000000</td>\n      <td id=\"T_1915a_row3_col10\" class=\"data row3 col10\" >27.032258</td>\n      <td id=\"T_1915a_row3_col11\" class=\"data row3 col11\" >8.612903</td>\n      <td id=\"T_1915a_row3_col12\" class=\"data row3 col12\" >145.609684</td>\n      <td id=\"T_1915a_row3_col13\" class=\"data row3 col13\" >42.495870</td>\n      <td id=\"T_1915a_row3_col14\" class=\"data row3 col14\" >5.762057</td>\n      <td id=\"T_1915a_row3_col15\" class=\"data row3 col15\" >12.349303</td>\n    </tr>\n    <tr>\n      <th id=\"T_1915a_level0_row4\" class=\"row_heading level0 row4\" >4</th>\n      <td id=\"T_1915a_row4_col0\" class=\"data row4 col0\" >1996-09-12</td>\n      <td id=\"T_1915a_row4_col1\" class=\"data row4 col1\" >1638</td>\n      <td id=\"T_1915a_row4_col2\" class=\"data row4 col2\" >32.333333</td>\n      <td id=\"T_1915a_row4_col3\" class=\"data row4 col3\" >1001.980000</td>\n      <td id=\"T_1915a_row4_col4\" class=\"data row4 col4\" >23.833333</td>\n      <td id=\"T_1915a_row4_col5\" class=\"data row4 col5\" >62.000000</td>\n      <td id=\"T_1915a_row4_col6\" class=\"data row4 col6\" >9.833333</td>\n      <td id=\"T_1915a_row4_col7\" class=\"data row4 col7\" >27.890241</td>\n      <td id=\"T_1915a_row4_col8\" class=\"data row4 col8\" >32.333333</td>\n      <td id=\"T_1915a_row4_col9\" class=\"data row4 col9\" >0.651795</td>\n      <td id=\"T_1915a_row4_col10\" class=\"data row4 col10\" >37.833333</td>\n      <td id=\"T_1915a_row4_col11\" class=\"data row4 col11\" >9.000000</td>\n      <td id=\"T_1915a_row4_col12\" class=\"data row4 col12\" >145.609684</td>\n      <td id=\"T_1915a_row4_col13\" class=\"data row4 col13\" >42.495870</td>\n      <td id=\"T_1915a_row4_col14\" class=\"data row4 col14\" >5.762057</td>\n      <td id=\"T_1915a_row4_col15\" class=\"data row4 col15\" >12.349303</td>\n    </tr>\n  </tbody>\n</table>\n```\n:::\n:::\n\n\n::: {#c20b3a15 .cell execution_count=15}\n``` {.python .cell-code}\ndata.describe().drop('count').style.background_gradient(cmap='Greens')\n```\n\n::: {.cell-output .cell-output-display execution_count=14}\n```{=html}\n<style type=\"text/css\">\n#T_e180b_row0_col0 {\n  background-color: #48ae60;\n  color: #f1f1f1;\n}\n#T_e180b_row0_col1 {\n  background-color: #0c7735;\n  color: #f1f1f1;\n}\n#T_e180b_row0_col2, #T_e180b_row3_col2, #T_e180b_row4_col2 {\n  background-color: #00471c;\n  color: #f1f1f1;\n}\n#T_e180b_row0_col3 {\n  background-color: #006428;\n  color: #f1f1f1;\n}\n#T_e180b_row0_col4, #T_e180b_row5_col7 {\n  background-color: #097532;\n  color: #f1f1f1;\n}\n#T_e180b_row0_col5 {\n  background-color: #e1f3dc;\n  color: #000000;\n}\n#T_e180b_row0_col6, #T_e180b_row2_col12, #T_e180b_row3_col6, #T_e180b_row4_col6 {\n  background-color: #f1faee;\n  color: #000000;\n}\n#T_e180b_row0_col7, #T_e180b_row4_col1, #T_e180b_row4_col7 {\n  background-color: #0d7836;\n  color: #f1f1f1;\n}\n#T_e180b_row0_col8 {\n  background-color: #ceecc8;\n  color: #000000;\n}\n#T_e180b_row0_col9, #T_e180b_row4_col9 {\n  background-color: #228a44;\n  color: #f1f1f1;\n}\n#T_e180b_row0_col10 {\n  background-color: #005321;\n  color: #f1f1f1;\n}\n#T_e180b_row0_col11, #T_e180b_row3_col11, #T_e180b_row4_col11, #T_e180b_row5_col11 {\n  background-color: #aadda4;\n  color: #000000;\n}\n#T_e180b_row0_col12, #T_e180b_row4_col12 {\n  background-color: #c4e8bd;\n  color: #000000;\n}\n#T_e180b_row0_col13, #T_e180b_row1_col0, #T_e180b_row1_col1, #T_e180b_row1_col2, #T_e180b_row1_col3, #T_e180b_row1_col4, #T_e180b_row1_col7, #T_e180b_row1_col9, #T_e180b_row1_col10, #T_e180b_row1_col12, #T_e180b_row2_col5, #T_e180b_row2_col6, #T_e180b_row2_col8, #T_e180b_row2_col11, #T_e180b_row2_col13, #T_e180b_row2_col14, #T_e180b_row3_col8, #T_e180b_row3_col13, #T_e180b_row3_col14, #T_e180b_row4_col8, #T_e180b_row4_col13, #T_e180b_row5_col13 {\n  background-color: #f7fcf5;\n  color: #000000;\n}\n#T_e180b_row0_col14, #T_e180b_row4_col14, #T_e180b_row5_col14 {\n  background-color: #f6fcf4;\n  color: #000000;\n}\n#T_e180b_row1_col5, #T_e180b_row1_col14 {\n  background-color: #f3faf0;\n  color: #000000;\n}\n#T_e180b_row1_col6 {\n  background-color: #f4fbf1;\n  color: #000000;\n}\n#T_e180b_row1_col8 {\n  background-color: #bae3b3;\n  color: #000000;\n}\n#T_e180b_row1_col11 {\n  background-color: #f0f9ed;\n  color: #000000;\n}\n#T_e180b_row1_col13 {\n  background-color: #f4fbf2;\n  color: #000000;\n}\n#T_e180b_row2_col0 {\n  background-color: #c2e7bb;\n  color: #000000;\n}\n#T_e180b_row2_col1, #T_e180b_row2_col7 {\n  background-color: #2f974e;\n  color: #f1f1f1;\n}\n#T_e180b_row2_col2 {\n  background-color: #00491d;\n  color: #f1f1f1;\n}\n#T_e180b_row2_col3 {\n  background-color: #70c274;\n  color: #000000;\n}\n#T_e180b_row2_col4 {\n  background-color: #e8f6e3;\n  color: #000000;\n}\n#T_e180b_row2_col9 {\n  background-color: #53b466;\n  color: #f1f1f1;\n}\n#T_e180b_row2_col10 {\n  background-color: #c1e6ba;\n  color: #000000;\n}\n#T_e180b_row3_col0 {\n  background-color: #5bb86a;\n  color: #f1f1f1;\n}\n#T_e180b_row3_col1, #T_e180b_row3_col7 {\n  background-color: #127c39;\n  color: #f1f1f1;\n}\n#T_e180b_row3_col3 {\n  background-color: #006729;\n  color: #f1f1f1;\n}\n#T_e180b_row3_col4 {\n  background-color: #0e7936;\n  color: #f1f1f1;\n}\n#T_e180b_row3_col5 {\n  background-color: #e3f4de;\n  color: #000000;\n}\n#T_e180b_row3_col9 {\n  background-color: #289049;\n  color: #f1f1f1;\n}\n#T_e180b_row3_col10 {\n  background-color: #005522;\n  color: #f1f1f1;\n}\n#T_e180b_row3_col12 {\n  background-color: #ccebc6;\n  color: #000000;\n}\n#T_e180b_row4_col0 {\n  background-color: #45ad5f;\n  color: #f1f1f1;\n}\n#T_e180b_row4_col3 {\n  background-color: #006227;\n  color: #f1f1f1;\n}\n#T_e180b_row4_col4 {\n  background-color: #05712f;\n  color: #f1f1f1;\n}\n#T_e180b_row4_col5 {\n  background-color: #def2d9;\n  color: #000000;\n}\n#T_e180b_row4_col10 {\n  background-color: #005020;\n  color: #f1f1f1;\n}\n#T_e180b_row5_col0 {\n  background-color: #38a156;\n  color: #f1f1f1;\n}\n#T_e180b_row5_col1 {\n  background-color: #087432;\n  color: #f1f1f1;\n}\n#T_e180b_row5_col2 {\n  background-color: #00451c;\n  color: #f1f1f1;\n}\n#T_e180b_row5_col3 {\n  background-color: #005c25;\n  color: #f1f1f1;\n}\n#T_e180b_row5_col4 {\n  background-color: #006b2b;\n  color: #f1f1f1;\n}\n#T_e180b_row5_col5 {\n  background-color: #daf0d4;\n  color: #000000;\n}\n#T_e180b_row5_col6 {\n  background-color: #eff9eb;\n  color: #000000;\n}\n#T_e180b_row5_col8 {\n  background-color: #63bc6e;\n  color: #f1f1f1;\n}\n#T_e180b_row5_col9 {\n  background-color: #1c8540;\n  color: #f1f1f1;\n}\n#T_e180b_row5_col10 {\n  background-color: #004c1e;\n  color: #f1f1f1;\n}\n#T_e180b_row5_col12 {\n  background-color: #bee5b8;\n  color: #000000;\n}\n#T_e180b_row6_col0, #T_e180b_row6_col1, #T_e180b_row6_col2, #T_e180b_row6_col3, #T_e180b_row6_col4, #T_e180b_row6_col5, #T_e180b_row6_col6, #T_e180b_row6_col7, #T_e180b_row6_col8, #T_e180b_row6_col9, #T_e180b_row6_col10, #T_e180b_row6_col11, #T_e180b_row6_col12, #T_e180b_row6_col13, #T_e180b_row6_col14 {\n  background-color: #00441b;\n  color: #f1f1f1;\n}\n</style>\n<table id=\"T_e180b\">\n  <thead>\n    <tr>\n      <th class=\"blank level0\" >&nbsp;</th>\n      <th id=\"T_e180b_level0_col0\" class=\"col_heading level0 col0\" >births</th>\n      <th id=\"T_e180b_level0_col1\" class=\"col_heading level0 col1\" >temperature</th>\n      <th id=\"T_e180b_level0_col2\" class=\"col_heading level0 col2\" >pressure</th>\n      <th id=\"T_e180b_level0_col3\" class=\"col_heading level0 col3\" >dew_point</th>\n      <th id=\"T_e180b_level0_col4\" class=\"col_heading level0 col4\" >humidity</th>\n      <th id=\"T_e180b_level0_col5\" class=\"col_heading level0 col5\" >wind_speed</th>\n      <th id=\"T_e180b_level0_col6\" class=\"col_heading level0 col6\" >gust</th>\n      <th id=\"T_e180b_level0_col7\" class=\"col_heading level0 col7\" >wind_chill</th>\n      <th id=\"T_e180b_level0_col8\" class=\"col_heading level0 col8\" >uv_index</th>\n      <th id=\"T_e180b_level0_col9\" class=\"col_heading level0 col9\" >feels_like_temperature</th>\n      <th id=\"T_e180b_level0_col10\" class=\"col_heading level0 col10\" >visibility</th>\n      <th id=\"T_e180b_level0_col11\" class=\"col_heading level0 col11\" >solar_radiation</th>\n      <th id=\"T_e180b_level0_col12\" class=\"col_heading level0 col12\" >pollutant_value</th>\n      <th id=\"T_e180b_level0_col13\" class=\"col_heading level0 col13\" >precipitation_rate</th>\n      <th id=\"T_e180b_level0_col14\" class=\"col_heading level0 col14\" >precipitation_total</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th id=\"T_e180b_level0_row0\" class=\"row_heading level0 row0\" >mean</th>\n      <td id=\"T_e180b_row0_col0\" class=\"data row0 col0\" >1399.317195</td>\n      <td id=\"T_e180b_row0_col1\" class=\"data row0 col1\" >27.527325</td>\n      <td id=\"T_e180b_row0_col2\" class=\"data row0 col2\" >1007.996160</td>\n      <td id=\"T_e180b_row0_col3\" class=\"data row0 col3\" >23.783828</td>\n      <td id=\"T_e180b_row0_col4\" class=\"data row0 col4\" >81.213123</td>\n      <td id=\"T_e180b_row0_col5\" class=\"data row0 col5\" >6.569408</td>\n      <td id=\"T_e180b_row0_col6\" class=\"data row0 col6\" >27.890241</td>\n      <td id=\"T_e180b_row0_col7\" class=\"data row0 col7\" >27.451720</td>\n      <td id=\"T_e180b_row0_col8\" class=\"data row0 col8\" >0.651795</td>\n      <td id=\"T_e180b_row0_col9\" class=\"data row0 col9\" >30.441393</td>\n      <td id=\"T_e180b_row0_col10\" class=\"data row0 col10\" >8.582386</td>\n      <td id=\"T_e180b_row0_col11\" class=\"data row0 col11\" >145.609684</td>\n      <td id=\"T_e180b_row0_col12\" class=\"data row0 col12\" >42.495870</td>\n      <td id=\"T_e180b_row0_col13\" class=\"data row0 col13\" >5.762057</td>\n      <td id=\"T_e180b_row0_col14\" class=\"data row0 col14\" >12.349303</td>\n    </tr>\n    <tr>\n      <th id=\"T_e180b_level0_row1\" class=\"row_heading level0 row1\" >std</th>\n      <td id=\"T_e180b_row1_col0\" class=\"data row1 col0\" >151.534289</td>\n      <td id=\"T_e180b_row1_col1\" class=\"data row1 col1\" >0.879650</td>\n      <td id=\"T_e180b_row1_col2\" class=\"data row1 col2\" >1.962270</td>\n      <td id=\"T_e180b_row1_col3\" class=\"data row1 col3\" >1.131681</td>\n      <td id=\"T_e180b_row1_col4\" class=\"data row1 col4\" >5.905187</td>\n      <td id=\"T_e180b_row1_col5\" class=\"data row1 col5\" >2.211017</td>\n      <td id=\"T_e180b_row1_col6\" class=\"data row1 col6\" >15.385685</td>\n      <td id=\"T_e180b_row1_col7\" class=\"data row1 col7\" >0.804632</td>\n      <td id=\"T_e180b_row1_col8\" class=\"data row1 col8\" >0.871842</td>\n      <td id=\"T_e180b_row1_col9\" class=\"data row1 col9\" >1.454741</td>\n      <td id=\"T_e180b_row1_col10\" class=\"data row1 col10\" >0.455176</td>\n      <td id=\"T_e180b_row1_col11\" class=\"data row1 col11\" >20.630437</td>\n      <td id=\"T_e180b_row1_col12\" class=\"data row1 col12\" >9.242458</td>\n      <td id=\"T_e180b_row1_col13\" class=\"data row1 col13\" >53.834741</td>\n      <td id=\"T_e180b_row1_col14\" class=\"data row1 col14\" >72.250576</td>\n    </tr>\n    <tr>\n      <th id=\"T_e180b_level0_row2\" class=\"row_heading level0 row2\" >min</th>\n      <td id=\"T_e180b_row2_col0\" class=\"data row2 col0\" >697.000000</td>\n      <td id=\"T_e180b_row2_col1\" class=\"data row2 col1\" >23.444444</td>\n      <td id=\"T_e180b_row2_col2\" class=\"data row2 col2\" >997.887076</td>\n      <td id=\"T_e180b_row2_col3\" class=\"data row2 col3\" >13.897368</td>\n      <td id=\"T_e180b_row2_col4\" class=\"data row2 col4\" >15.484936</td>\n      <td id=\"T_e180b_row2_col5\" class=\"data row2 col5\" >1.163329</td>\n      <td id=\"T_e180b_row2_col6\" class=\"data row2 col6\" >0.220339</td>\n      <td id=\"T_e180b_row2_col7\" class=\"data row2 col7\" >23.361953</td>\n      <td id=\"T_e180b_row2_col8\" class=\"data row2 col8\" >0.000000</td>\n      <td id=\"T_e180b_row2_col9\" class=\"data row2 col9\" >23.777778</td>\n      <td id=\"T_e180b_row2_col10\" class=\"data row2 col10\" >2.786753</td>\n      <td id=\"T_e180b_row2_col11\" class=\"data row2 col11\" >0.000000</td>\n      <td id=\"T_e180b_row2_col12\" class=\"data row2 col12\" >15.125438</td>\n      <td id=\"T_e180b_row2_col13\" class=\"data row2 col13\" >0.000000</td>\n      <td id=\"T_e180b_row2_col14\" class=\"data row2 col14\" >0.000000</td>\n    </tr>\n    <tr>\n      <th id=\"T_e180b_level0_row3\" class=\"row_heading level0 row3\" >25%</th>\n      <td id=\"T_e180b_row3_col0\" class=\"data row3 col0\" >1299.000000</td>\n      <td id=\"T_e180b_row3_col1\" class=\"data row3 col1\" >26.930111</td>\n      <td id=\"T_e180b_row3_col2\" class=\"data row3 col2\" >1006.886622</td>\n      <td id=\"T_e180b_row3_col3\" class=\"data row3 col3\" >23.554108</td>\n      <td id=\"T_e180b_row3_col4\" class=\"data row3 col4\" >79.513711</td>\n      <td id=\"T_e180b_row3_col5\" class=\"data row3 col5\" >6.182207</td>\n      <td id=\"T_e180b_row3_col6\" class=\"data row3 col6\" >27.890241</td>\n      <td id=\"T_e180b_row3_col7\" class=\"data row3 col7\" >26.924528</td>\n      <td id=\"T_e180b_row3_col8\" class=\"data row3 col8\" >0.000000</td>\n      <td id=\"T_e180b_row3_col9\" class=\"data row3 col9\" >29.463124</td>\n      <td id=\"T_e180b_row3_col10\" class=\"data row3 col10\" >8.549533</td>\n      <td id=\"T_e180b_row3_col11\" class=\"data row3 col11\" >145.609684</td>\n      <td id=\"T_e180b_row3_col12\" class=\"data row3 col12\" >38.520319</td>\n      <td id=\"T_e180b_row3_col13\" class=\"data row3 col13\" >0.356371</td>\n      <td id=\"T_e180b_row3_col14\" class=\"data row3 col14\" >3.218137</td>\n    </tr>\n    <tr>\n      <th id=\"T_e180b_level0_row4\" class=\"row_heading level0 row4\" >50%</th>\n      <td id=\"T_e180b_row4_col0\" class=\"data row4 col0\" >1411.000000</td>\n      <td id=\"T_e180b_row4_col1\" class=\"data row4 col1\" >27.449486</td>\n      <td id=\"T_e180b_row4_col2\" class=\"data row4 col2\" >1007.970255</td>\n      <td id=\"T_e180b_row4_col3\" class=\"data row4 col3\" >23.967937</td>\n      <td id=\"T_e180b_row4_col4\" class=\"data row4 col4\" >82.460700</td>\n      <td id=\"T_e180b_row4_col5\" class=\"data row4 col5\" >6.919526</td>\n      <td id=\"T_e180b_row4_col6\" class=\"data row4 col6\" >27.890241</td>\n      <td id=\"T_e180b_row4_col7\" class=\"data row4 col7\" >27.435050</td>\n      <td id=\"T_e180b_row4_col8\" class=\"data row4 col8\" >0.000000</td>\n      <td id=\"T_e180b_row4_col9\" class=\"data row4 col9\" >30.406473</td>\n      <td id=\"T_e180b_row4_col10\" class=\"data row4 col10\" >8.672687</td>\n      <td id=\"T_e180b_row4_col11\" class=\"data row4 col11\" >145.609684</td>\n      <td id=\"T_e180b_row4_col12\" class=\"data row4 col12\" >42.495870</td>\n      <td id=\"T_e180b_row4_col13\" class=\"data row4 col13\" >5.762057</td>\n      <td id=\"T_e180b_row4_col14\" class=\"data row4 col14\" >12.349303</td>\n    </tr>\n    <tr>\n      <th id=\"T_e180b_level0_row5\" class=\"row_heading level0 row5\" >75%</th>\n      <td id=\"T_e180b_row5_col0\" class=\"data row5 col0\" >1509.000000</td>\n      <td id=\"T_e180b_row5_col1\" class=\"data row5 col1\" >28.041932</td>\n      <td id=\"T_e180b_row5_col2\" class=\"data row5 col2\" >1009.161633</td>\n      <td id=\"T_e180b_row5_col3\" class=\"data row5 col3\" >24.359104</td>\n      <td id=\"T_e180b_row5_col4\" class=\"data row5 col4\" >84.654464</td>\n      <td id=\"T_e180b_row5_col5\" class=\"data row5 col5\" >7.738506</td>\n      <td id=\"T_e180b_row5_col6\" class=\"data row5 col6\" >37.000000</td>\n      <td id=\"T_e180b_row5_col7\" class=\"data row5 col7\" >27.917808</td>\n      <td id=\"T_e180b_row5_col8\" class=\"data row5 col8\" >1.611262</td>\n      <td id=\"T_e180b_row5_col9\" class=\"data row5 col9\" >31.328596</td>\n      <td id=\"T_e180b_row5_col10\" class=\"data row5 col10\" >8.783403</td>\n      <td id=\"T_e180b_row5_col11\" class=\"data row5 col11\" >145.609684</td>\n      <td id=\"T_e180b_row5_col12\" class=\"data row5 col12\" >44.772431</td>\n      <td id=\"T_e180b_row5_col13\" class=\"data row5 col13\" >5.762057</td>\n      <td id=\"T_e180b_row5_col14\" class=\"data row5 col14\" >12.349303</td>\n    </tr>\n    <tr>\n      <th id=\"T_e180b_level0_row6\" class=\"row_heading level0 row6\" >max</th>\n      <td id=\"T_e180b_row6_col0\" class=\"data row6 col0\" >2200.000000</td>\n      <td id=\"T_e180b_row6_col1\" class=\"data row6 col1\" >33.000000</td>\n      <td id=\"T_e180b_row6_col2\" class=\"data row6 col2\" >1016.209393</td>\n      <td id=\"T_e180b_row6_col3\" class=\"data row6 col3\" >26.255048</td>\n      <td id=\"T_e180b_row6_col4\" class=\"data row6 col4\" >95.250709</td>\n      <td id=\"T_e180b_row6_col5\" class=\"data row6 col5\" >38.743243</td>\n      <td id=\"T_e180b_row6_col6\" class=\"data row6 col6\" >593.000000</td>\n      <td id=\"T_e180b_row6_col7\" class=\"data row6 col7\" >33.000000</td>\n      <td id=\"T_e180b_row6_col8\" class=\"data row6 col8\" >2.972896</td>\n      <td id=\"T_e180b_row6_col9\" class=\"data row6 col9\" >40.000000</td>\n      <td id=\"T_e180b_row6_col10\" class=\"data row6 col10\" >9.000000</td>\n      <td id=\"T_e180b_row6_col11\" class=\"data row6 col11\" >419.813559</td>\n      <td id=\"T_e180b_row6_col12\" class=\"data row6 col12\" >136.627451</td>\n      <td id=\"T_e180b_row6_col13\" class=\"data row6 col13\" >2539.750000</td>\n      <td id=\"T_e180b_row6_col14\" class=\"data row6 col14\" >2539.750000</td>\n    </tr>\n  </tbody>\n</table>\n```\n:::\n:::\n\n\n## Visualising a few features\n\nLet's visualise the data to get a better understanding of the trends and seasonality, and to develop an intuition of what we are trying to forecast. We will focus on births, temperature, and pollutant levels.\n\n::: {#8b421a8d .cell execution_count=16}\n``` {.python .cell-code}\nimport matplotlib.pyplot as plt\n\nfig, axs = plt.subplots(3, 1, figsize=(8, 9))\n\naxs[0].plot(data['date'], data['births'])\naxs[0].set_title('Daily Births')\naxs[0].set_xlabel('Date')\naxs[0].set_ylabel('Births')\n\naxs[1].plot(data['date'], data['temperature'])\naxs[1].set_title('Temperature')\naxs[1].set_xlabel('Date')\naxs[1].set_ylabel('Temperature')\n\naxs[2].plot(data['date'], data['pollutant_value'])\naxs[2].set_title('Pollution')\naxs[2].set_xlabel('Date')\naxs[2].set_ylabel('Pollution')\n\nplt.tight_layout()\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-16-output-1.png){}\n:::\n:::\n\n\n## Building the model\n\nWe can now build a Prophet model forecasting five years into the future, we will adjust Prophet's change point prior scale to make the model more flexible. First, we will forecast temperature and pollutant levels, and then we will forecast the number of births using these two features as regressors.\n\n::: {.callout-note}\n## About the Change Point Prior Scale\n\nThe change point prior scale parameter controls the flexibility of the model. A higher value makes the model more flexible, allowing it to capture more fluctuations in the data. However, this can lead to overfitting, so it is important to tune carefully.\n:::\n\nProphet requires the input data to have two columns: `ds` and `y`. The `ds` column contains dates, and the `y` column the values we want to forecast - in our case temperature, pollutant levels, and births.\n\n::: {#885528c5 .cell execution_count=17}\n``` {.python .cell-code}\nfrom prophet import Prophet\n\nfuture_period = 365*5\nprior_scale = 0.05\n\n# Prepare the data for Prophet\ndf_temperature = data[['date', 'temperature']].rename(columns={'date': 'ds', 'temperature': 'y'})\ndf_pollutant = data[['date', 'pollutant_value']].rename(columns={'date': 'ds', 'pollutant_value': 'y'})\n\n# Initialize the Prophet model\nmodel_temperature = Prophet(changepoint_prior_scale=prior_scale)\nmodel_pollutant = Prophet(changepoint_prior_scale=prior_scale)\n\n# Fit the model\nmodel_temperature.fit(df_temperature)\n\n# Make a dataframe to hold future predictions\nfuture_temperature = model_temperature.make_future_dataframe(periods=future_period)\nforecast_temperature = model_temperature.predict(future_temperature)\n\nmodel_pollutant.fit(df_pollutant)\nfuture_pollutant = model_pollutant.make_future_dataframe(periods=future_period)\nforecast_pollutant = model_pollutant.predict(future_pollutant)\n```\n:::\n\n\nProphet includes inbuilt methods to easily visuallise the forecasted values, as well as uncertainty intervals. We will also include change points in the forecast plot, which are the points where the trend changes direction.\n\n::: {.callout-note}\n## About Change Points\n\nProphet uses a piecewise linear model to capture the trend in the data. Change points are where the trend changes direction, and are automatically selected by the model. You can also manually specify individual change points if you have domain knowledge about the data.\n:::\n\n::: {#e2cedad9 .cell execution_count=18}\n``` {.python .cell-code}\nfrom prophet.plot import add_changepoints_to_plot\nimport matplotlib.pyplot as plt\n\n# Create a figure with a 2-row, 1-column grid\nfig, axs = plt.subplots(2, 1, figsize=(8, 9))\n\n# Plot the temperature forecast on the first subplot\nfig1 = model_temperature.plot(forecast_temperature, ax=axs[0], include_legend=True)\naxs[0].set_title('Temperature Forecast with Changepoints')\nadd_changepoints_to_plot(axs[0], model_temperature, forecast_temperature)\n\n# Plot the pollutant forecast on the second subplot\nfig2 = model_pollutant.plot(forecast_pollutant, ax=axs[1], include_legend=True)\naxs[1].set_title('Pollutant Forecast with Changepoints')\nadd_changepoints_to_plot(axs[1], model_pollutant, forecast_pollutant)\n\nplt.tight_layout()\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-18-output-1.png){}\n:::\n:::\n\n\nIn addition we can plot the components of the forecast, including the trend, seasonality, and holidays. It helps to understand how these components contribute to the forecast. Notice how in the yearly seasonality plot, the model captures the peaks in temperature and pollutant levels during certain months.\n\n::: {#16d454fa .cell execution_count=19}\n``` {.python .cell-code}\n# Visualise the components of each forecast\n\nfig3 = model_temperature.plot_components(forecast_temperature, figsize=(8, 6))\n_ = fig3.suptitle('Temperature Forecast Components', fontsize=14)\nfig4 = model_pollutant.plot_components(forecast_pollutant, figsize=(8, 6))\n_ = fig4.suptitle('Pollutant Forecast Components', fontsize=14)\n```\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-19-output-1.png){}\n:::\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-19-output-2.png){}\n:::\n:::\n\n\n# Predicting births\n\nWe now want to forecast the number of future births. In addition we want to use temperature and pollutant levels as regressors in the model. Let us build a new Prophet model that includes these regressors.\n\n::: {.callout-note}\n## About Regressors\n\nIncluding additional regressors gives the ability to account for external factors that might influence the trend and seasonality of the data. This can improve the accuracy of the forecast, especially if these factors have a significant impact on the target variable. In this case, we are including temperature and pollutant levels as regressors as an illustration of how to use this feature in Prophet, in practice these might not be the most relevant factors for predicting births.\n:::\n\n::: {#9f071a8e .cell execution_count=20}\n``` {.python .cell-code}\ndf_births = data[['date', 'births']].rename(columns={'date': 'ds', 'births': 'y'})\n\n# Add temperature and pollutant values to the dataframe\ndf_births['temperature'] = data['temperature']\ndf_births['pollutant_value'] = data['pollutant_value']\n```\n:::\n\n\nProphet also allows us to include factors such as holidays in the model. We can include public holidays in Malaysia, which will help the model to account for the impact of holidays on the number of births. We could also include other seasonalities or events that might affect the number of births, such as cultural or religious events. We are also including the temperature and pollutant levels as regressors in the model, as these might impact birth rates.\n\n::: {.callout-tip}\n## Other Regressors and Seasonalities\n\nAs an exercise, can you think of other regressors or seasonalities that might influence the number of births? For example, you could include certain economic indicators, social factors, or other external variables that might affect birth rates.\n:::\n\n::: {#c91435ed .cell execution_count=21}\n``` {.python .cell-code}\nmodel_births = Prophet(changepoint_prior_scale=prior_scale)\n\n# Add Malaysian holidays to the model\nmodel_births.add_country_holidays(country_name='MY')\n\n# Add a monthly seasonality to the model\nmodel_births.add_seasonality(name='monthly', period=30.5, fourier_order=5)\n\n# Add the temperature and pollutant value to the model as regressors\nmodel_births.add_regressor('temperature')\nmodel_births.add_regressor('pollutant_value')\n\n# Fit the model\nmodel_births.fit(df_births)\n\n# Make a dataframe to hold future predictions\nfuture_births = model_births.make_future_dataframe(periods=future_period)\n\n# Add forecasted temperature and pollutant values to future_births\nfuture_births['temperature'] = forecast_temperature['yhat'][-len(future_births):].reset_index(drop=True)\nfuture_births['pollutant_value'] = forecast_pollutant['yhat'][-len(future_births):].reset_index(drop=True)\n\n# Predict the future\nforecast_births = model_births.predict(future_births)\n```\n:::\n\n\nNow that we have completed a forecast, we can plot the predicted values, as well as uncertainty intervals, just as we did before for temperature and pollutant levels.\n\n::: {#40473496 .cell execution_count=22}\n``` {.python .cell-code}\n# Visualize the forecast\n\nfig5 = model_births.plot(forecast_births, include_legend=True, figsize=(8, 6))\nfig5.gca().set_title('Births Forecast with Changepoints')\n\n# Add changepoints to the plot\na = add_changepoints_to_plot(fig5.gca(), model_births, forecast_births)\n```\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-22-output-1.png){}\n:::\n:::\n\n\nLet us also plot the components of the forecast, including the trend, seasonality, holidays, and the impact of the regressors. This allows us to understand how these components contribute to the forecast and if and how the regressors influence the number of births.\n\n::: {#f43a836c .cell execution_count=23}\n``` {.python .cell-code}\n# Visualise the components of the forecast\n\nfig6 = model_births.plot_components(forecast_births, figsize=(8, 12))\n_ = fig6.suptitle('Births Forecast Components', fontsize=14)\n```\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-23-output-1.png){}\n:::\n:::\n\n\nInterestingly, there is a negative effect of many holidays on the number of births - this might be due to the fact that many births are planned, and people might avoid giving birth on holidays, or there might be other non-represented factors at play. Additionally we see that the number of births is highest between September and November.\n\n## Cross validating the model\n\nProphet provides a convenient way to cross-validate the model using historical data. This allows us to evaluate the performance of the model on past data and tune the hyperparameters accordingly. We will use cross-validation to assess the forecast accuracy of the model and identify any potential issues. Cross validation in Prophet works on a rolling forecast origin, where the model is trained on historical data up to a certain point and then used to forecast known future data. We can then compare the forecasted values with the actual values to evaluate the model's performance. The `initial` parameter specifies the size of the initial training period, and the `period` parameter specifies the size of the forecast `horizon`.\n\n::: {.callout-note}\n## About Cross Validation\n\nCross validation produces a dataframe with `yhat`, `yhat_lower`, `yhat_upper` and `y` columns. The `yhat` column contains the forecasted values, the `yhat_lower` and `yhat_upper` columns contain the uncertainty intervals, and the `y` column contains the actual values. We can use this dataframe to calculate evaluation metrics such as mean absolute error (MAE), mean squared error (MSE), and root mean squared error (RMSE).\n:::\n\n::: {#f4d28ab1 .cell execution_count=24}\n``` {.python .cell-code}\n# Cross validate the model\n\nfrom prophet.diagnostics import cross_validation\n\ndf_births_cv = cross_validation(model_births, initial='730 days', period='180 days', horizon = '365 days')\ndf_births_cv.head().style.background_gradient(cmap='Greens')\n```\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<script type=\"application/vnd.jupyter.widget-view+json\">\n{\"model_id\":\"f96111cbbfe1444f8a120b56a2f93b9f\",\"version_major\":2,\"version_minor\":0,\"quarto_mimetype\":\"application/vnd.jupyter.widget-view+json\"}\n</script>\n```\n:::\n\n::: {.cell-output .cell-output-display execution_count=23}\n```{=html}\n<style type=\"text/css\">\n#T_b4f12_row0_col1 {\n  background-color: #95d391;\n  color: #000000;\n}\n#T_b4f12_row0_col2 {\n  background-color: #98d594;\n  color: #000000;\n}\n#T_b4f12_row0_col3 {\n  background-color: #91d28e;\n  color: #000000;\n}\n#T_b4f12_row0_col4 {\n  background-color: #acdea6;\n  color: #000000;\n}\n#T_b4f12_row1_col1, #T_b4f12_row1_col2, #T_b4f12_row1_col3, #T_b4f12_row1_col4 {\n  background-color: #f7fcf5;\n  color: #000000;\n}\n#T_b4f12_row2_col1 {\n  background-color: #359e53;\n  color: #f1f1f1;\n}\n#T_b4f12_row2_col2 {\n  background-color: #3ca559;\n  color: #f1f1f1;\n}\n#T_b4f12_row2_col3 {\n  background-color: #3aa357;\n  color: #f1f1f1;\n}\n#T_b4f12_row2_col4 {\n  background-color: #18823d;\n  color: #f1f1f1;\n}\n#T_b4f12_row3_col1, #T_b4f12_row3_col3 {\n  background-color: #005723;\n  color: #f1f1f1;\n}\n#T_b4f12_row3_col2 {\n  background-color: #005924;\n  color: #f1f1f1;\n}\n#T_b4f12_row3_col4, #T_b4f12_row4_col1, #T_b4f12_row4_col2, #T_b4f12_row4_col3 {\n  background-color: #00441b;\n  color: #f1f1f1;\n}\n#T_b4f12_row4_col4 {\n  background-color: #004c1e;\n  color: #f1f1f1;\n}\n</style>\n<table id=\"T_b4f12\">\n  <thead>\n    <tr>\n      <th class=\"blank level0\" >&nbsp;</th>\n      <th id=\"T_b4f12_level0_col0\" class=\"col_heading level0 col0\" >ds</th>\n      <th id=\"T_b4f12_level0_col1\" class=\"col_heading level0 col1\" >yhat</th>\n      <th id=\"T_b4f12_level0_col2\" class=\"col_heading level0 col2\" >yhat_lower</th>\n      <th id=\"T_b4f12_level0_col3\" class=\"col_heading level0 col3\" >yhat_upper</th>\n      <th id=\"T_b4f12_level0_col4\" class=\"col_heading level0 col4\" >y</th>\n      <th id=\"T_b4f12_level0_col5\" class=\"col_heading level0 col5\" >cutoff</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th id=\"T_b4f12_level0_row0\" class=\"row_heading level0 row0\" >0</th>\n      <td id=\"T_b4f12_row0_col0\" class=\"data row0 col0\" >1998-12-05 00:00:00</td>\n      <td id=\"T_b4f12_row0_col1\" class=\"data row0 col1\" >1311.555304</td>\n      <td id=\"T_b4f12_row0_col2\" class=\"data row0 col2\" >1256.298492</td>\n      <td id=\"T_b4f12_row0_col3\" class=\"data row0 col3\" >1367.429416</td>\n      <td id=\"T_b4f12_row0_col4\" class=\"data row0 col4\" >1349</td>\n      <td id=\"T_b4f12_row0_col5\" class=\"data row0 col5\" >1998-12-04 00:00:00</td>\n    </tr>\n    <tr>\n      <th id=\"T_b4f12_level0_row1\" class=\"row_heading level0 row1\" >1</th>\n      <td id=\"T_b4f12_row1_col0\" class=\"data row1 col0\" >1998-12-06 00:00:00</td>\n      <td id=\"T_b4f12_row1_col1\" class=\"data row1 col1\" >1216.420565</td>\n      <td id=\"T_b4f12_row1_col2\" class=\"data row1 col2\" >1161.138190</td>\n      <td id=\"T_b4f12_row1_col3\" class=\"data row1 col3\" >1268.924482</td>\n      <td id=\"T_b4f12_row1_col4\" class=\"data row1 col4\" >1311</td>\n      <td id=\"T_b4f12_row1_col5\" class=\"data row1 col5\" >1998-12-04 00:00:00</td>\n    </tr>\n    <tr>\n      <th id=\"T_b4f12_level0_row2\" class=\"row_heading level0 row2\" >2</th>\n      <td id=\"T_b4f12_row2_col0\" class=\"data row2 col0\" >1998-12-07 00:00:00</td>\n      <td id=\"T_b4f12_row2_col1\" class=\"data row2 col1\" >1373.392566</td>\n      <td id=\"T_b4f12_row2_col2\" class=\"data row2 col2\" >1314.221541</td>\n      <td id=\"T_b4f12_row2_col3\" class=\"data row2 col3\" >1423.385528</td>\n      <td id=\"T_b4f12_row2_col4\" class=\"data row2 col4\" >1399</td>\n      <td id=\"T_b4f12_row2_col5\" class=\"data row2 col5\" >1998-12-04 00:00:00</td>\n    </tr>\n    <tr>\n      <th id=\"T_b4f12_level0_row3\" class=\"row_heading level0 row3\" >3</th>\n      <td id=\"T_b4f12_row3_col0\" class=\"data row3 col0\" >1998-12-08 00:00:00</td>\n      <td id=\"T_b4f12_row3_col1\" class=\"data row3 col1\" >1434.990681</td>\n      <td id=\"T_b4f12_row3_col2\" class=\"data row3 col2\" >1383.377583</td>\n      <td id=\"T_b4f12_row3_col3\" class=\"data row3 col3\" >1489.791256</td>\n      <td id=\"T_b4f12_row3_col4\" class=\"data row3 col4\" >1423</td>\n      <td id=\"T_b4f12_row3_col5\" class=\"data row3 col5\" >1998-12-04 00:00:00</td>\n    </tr>\n    <tr>\n      <th id=\"T_b4f12_level0_row4\" class=\"row_heading level0 row4\" >4</th>\n      <td id=\"T_b4f12_row4_col0\" class=\"data row4 col0\" >1998-12-09 00:00:00</td>\n      <td id=\"T_b4f12_row4_col1\" class=\"data row4 col1\" >1449.400677</td>\n      <td id=\"T_b4f12_row4_col2\" class=\"data row4 col2\" >1398.352673</td>\n      <td id=\"T_b4f12_row4_col3\" class=\"data row4 col3\" >1504.466093</td>\n      <td id=\"T_b4f12_row4_col4\" class=\"data row4 col4\" >1420</td>\n      <td id=\"T_b4f12_row4_col5\" class=\"data row4 col5\" >1998-12-04 00:00:00</td>\n    </tr>\n  </tbody>\n</table>\n```\n:::\n:::\n\n\nThese metrics provide a quantitative measure of the model's accuracy and can help us evaluate the performance of the model.\n\nWe are particularly interested in MAPE (Mean Absolute Percentage Error), which is a relative measure of the forecast accuracy. It is calculated as the average of the absolute percentage errors between the forecasted and actual values. A lower MAPE indicates a more accurate forecast.\n\n$MAPE = \\frac{1}{n} \\sum_{i=1}^{n} \\left| \\frac{y_i - \\hat{y}_i}{y_i} \\right| \\times 100$\n\nAs an example, a MAPE of 0.046 would indicate that the forecast is 4.6% off from the actual value.\n\n::: {#9729a60d .cell execution_count=25}\n``` {.python .cell-code}\nfrom prophet.diagnostics import performance_metrics\n\ndf_births_cv_p = performance_metrics(df_births_cv)\ndf_births_cv_p.head().style.background_gradient(cmap='Greens')\n```\n\n::: {.cell-output .cell-output-display execution_count=24}\n```{=html}\n<style type=\"text/css\">\n#T_77309_row0_col0, #T_77309_row0_col1, #T_77309_row0_col2, #T_77309_row0_col3, #T_77309_row0_col4, #T_77309_row0_col6, #T_77309_row1_col5, #T_77309_row4_col7 {\n  background-color: #f7fcf5;\n  color: #000000;\n}\n#T_77309_row0_col5 {\n  background-color: #9ed798;\n  color: #000000;\n}\n#T_77309_row0_col7, #T_77309_row4_col0, #T_77309_row4_col1, #T_77309_row4_col2, #T_77309_row4_col3, #T_77309_row4_col4, #T_77309_row4_col5, #T_77309_row4_col6 {\n  background-color: #00441b;\n  color: #f1f1f1;\n}\n#T_77309_row1_col0 {\n  background-color: #c7e9c0;\n  color: #000000;\n}\n#T_77309_row1_col1, #T_77309_row1_col2 {\n  background-color: #dbf1d6;\n  color: #000000;\n}\n#T_77309_row1_col3 {\n  background-color: #e8f6e4;\n  color: #000000;\n}\n#T_77309_row1_col4, #T_77309_row1_col6 {\n  background-color: #eff9ec;\n  color: #000000;\n}\n#T_77309_row1_col7 {\n  background-color: #248c46;\n  color: #f1f1f1;\n}\n#T_77309_row2_col0 {\n  background-color: #73c476;\n  color: #000000;\n}\n#T_77309_row2_col1, #T_77309_row2_col2, #T_77309_row3_col7 {\n  background-color: #bbe4b4;\n  color: #000000;\n}\n#T_77309_row2_col3 {\n  background-color: #d0edca;\n  color: #000000;\n}\n#T_77309_row2_col4 {\n  background-color: #def2d9;\n  color: #000000;\n}\n#T_77309_row2_col5 {\n  background-color: #91d28e;\n  color: #000000;\n}\n#T_77309_row2_col6 {\n  background-color: #dff3da;\n  color: #000000;\n}\n#T_77309_row2_col7 {\n  background-color: #3ca559;\n  color: #f1f1f1;\n}\n#T_77309_row3_col0 {\n  background-color: #228a44;\n  color: #f1f1f1;\n}\n#T_77309_row3_col1, #T_77309_row3_col2 {\n  background-color: #006328;\n  color: #f1f1f1;\n}\n#T_77309_row3_col3 {\n  background-color: #17813d;\n  color: #f1f1f1;\n}\n#T_77309_row3_col4 {\n  background-color: #117b38;\n  color: #f1f1f1;\n}\n#T_77309_row3_col5 {\n  background-color: #0c7735;\n  color: #f1f1f1;\n}\n#T_77309_row3_col6 {\n  background-color: #137d39;\n  color: #f1f1f1;\n}\n</style>\n<table id=\"T_77309\">\n  <thead>\n    <tr>\n      <th class=\"blank level0\" >&nbsp;</th>\n      <th id=\"T_77309_level0_col0\" class=\"col_heading level0 col0\" >horizon</th>\n      <th id=\"T_77309_level0_col1\" class=\"col_heading level0 col1\" >mse</th>\n      <th id=\"T_77309_level0_col2\" class=\"col_heading level0 col2\" >rmse</th>\n      <th id=\"T_77309_level0_col3\" class=\"col_heading level0 col3\" >mae</th>\n      <th id=\"T_77309_level0_col4\" class=\"col_heading level0 col4\" >mape</th>\n      <th id=\"T_77309_level0_col5\" class=\"col_heading level0 col5\" >mdape</th>\n      <th id=\"T_77309_level0_col6\" class=\"col_heading level0 col6\" >smape</th>\n      <th id=\"T_77309_level0_col7\" class=\"col_heading level0 col7\" >coverage</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th id=\"T_77309_level0_row0\" class=\"row_heading level0 row0\" >0</th>\n      <td id=\"T_77309_row0_col0\" class=\"data row0 col0\" >37 days 00:00:00</td>\n      <td id=\"T_77309_row0_col1\" class=\"data row0 col1\" >7044.649211</td>\n      <td id=\"T_77309_row0_col2\" class=\"data row0 col2\" >83.932409</td>\n      <td id=\"T_77309_row0_col3\" class=\"data row0 col3\" >64.313467</td>\n      <td id=\"T_77309_row0_col4\" class=\"data row0 col4\" >0.046796</td>\n      <td id=\"T_77309_row0_col5\" class=\"data row0 col5\" >0.037140</td>\n      <td id=\"T_77309_row0_col6\" class=\"data row0 col6\" >0.045922</td>\n      <td id=\"T_77309_row0_col7\" class=\"data row0 col7\" >0.681334</td>\n    </tr>\n    <tr>\n      <th id=\"T_77309_level0_row1\" class=\"row_heading level0 row1\" >1</th>\n      <td id=\"T_77309_row1_col0\" class=\"data row1 col0\" >38 days 00:00:00</td>\n      <td id=\"T_77309_row1_col1\" class=\"data row1 col1\" >7065.587597</td>\n      <td id=\"T_77309_row1_col2\" class=\"data row1 col2\" >84.057050</td>\n      <td id=\"T_77309_row1_col3\" class=\"data row1 col3\" >64.387762</td>\n      <td id=\"T_77309_row1_col4\" class=\"data row1 col4\" >0.046818</td>\n      <td id=\"T_77309_row1_col5\" class=\"data row1 col5\" >0.036911</td>\n      <td id=\"T_77309_row1_col6\" class=\"data row1 col6\" >0.045946</td>\n      <td id=\"T_77309_row1_col7\" class=\"data row1 col7\" >0.679283</td>\n    </tr>\n    <tr>\n      <th id=\"T_77309_level0_row2\" class=\"row_heading level0 row2\" >2</th>\n      <td id=\"T_77309_row2_col0\" class=\"data row2 col0\" >39 days 00:00:00</td>\n      <td id=\"T_77309_row2_col1\" class=\"data row2 col1\" >7081.623627</td>\n      <td id=\"T_77309_row2_col2\" class=\"data row2 col2\" >84.152383</td>\n      <td id=\"T_77309_row2_col3\" class=\"data row2 col3\" >64.466984</td>\n      <td id=\"T_77309_row2_col4\" class=\"data row2 col4\" >0.046857</td>\n      <td id=\"T_77309_row2_col5\" class=\"data row2 col5\" >0.037161</td>\n      <td id=\"T_77309_row2_col6\" class=\"data row2 col6\" >0.045984</td>\n      <td id=\"T_77309_row2_col7\" class=\"data row2 col7\" >0.678496</td>\n    </tr>\n    <tr>\n      <th id=\"T_77309_level0_row3\" class=\"row_heading level0 row3\" >3</th>\n      <td id=\"T_77309_row3_col0\" class=\"data row3 col0\" >40 days 00:00:00</td>\n      <td id=\"T_77309_row3_col1\" class=\"data row3 col1\" >7159.995715</td>\n      <td id=\"T_77309_row3_col2\" class=\"data row3 col2\" >84.616758</td>\n      <td id=\"T_77309_row3_col3\" class=\"data row3 col3\" >64.878598</td>\n      <td id=\"T_77309_row3_col4\" class=\"data row3 col4\" >0.047116</td>\n      <td id=\"T_77309_row3_col5\" class=\"data row3 col5\" >0.037406</td>\n      <td id=\"T_77309_row3_col6\" class=\"data row3 col6\" >0.046254</td>\n      <td id=\"T_77309_row3_col7\" class=\"data row3 col7\" >0.675635</td>\n    </tr>\n    <tr>\n      <th id=\"T_77309_level0_row4\" class=\"row_heading level0 row4\" >4</th>\n      <td id=\"T_77309_row4_col0\" class=\"data row4 col0\" >41 days 00:00:00</td>\n      <td id=\"T_77309_row4_col1\" class=\"data row4 col1\" >7172.213365</td>\n      <td id=\"T_77309_row4_col2\" class=\"data row4 col2\" >84.688921</td>\n      <td id=\"T_77309_row4_col3\" class=\"data row4 col3\" >65.028362</td>\n      <td id=\"T_77309_row4_col4\" class=\"data row4 col4\" >0.047190</td>\n      <td id=\"T_77309_row4_col5\" class=\"data row4 col5\" >0.037506</td>\n      <td id=\"T_77309_row4_col6\" class=\"data row4 col6\" >0.046333</td>\n      <td id=\"T_77309_row4_col7\" class=\"data row4 col7\" >0.673288</td>\n    </tr>\n  </tbody>\n</table>\n```\n:::\n:::\n\n\nWe can plot the MAPE values for each forecast horizon to see how the forecast accuracy changes over time.\n\n::: {#9462d2ae .cell execution_count=26}\n``` {.python .cell-code}\n# Plot the MAPE performance metric\n\nfrom prophet.plot import plot_cross_validation_metric\n\nfig7 = plot_cross_validation_metric(df_births_cv, metric='mape', figsize=(8, 6))\n```\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-26-output-1.png){}\n:::\n:::\n\n\nNotice how this metric stays relatively stable over time, around or just below 5%. This indicates that the model is performing well and providing accurate forecasts.\n\nLet us now plot the output of the cross-validation, showing the actual values and forecasted values superimposed on each other. This allows us to visually inspect the accuracy of the forecast over the period and horizon of the cross-validation.\n\n::: {#77fe499b .cell execution_count=27}\n``` {.python .cell-code}\n# Create a figure and axis\n\nplt.figure(figsize=(8, 6))\n\n# Plot actual values (y) as a scatter plot\nplt.scatter(df_births_cv['ds'], df_births_cv['y'], color='blue', label='Actual Births (y)', alpha=1.0)\n\n# Plot predicted values (yhat) as a scatter plot\nplt.scatter(df_births_cv['ds'], df_births_cv['yhat'], color='red', label='Predicted Births (yhat)', alpha=0.5)\n\n# Add labels and title\nplt.xlabel('Date (ds)')\nplt.ylabel('Births')\nplt.title('Actual vs Predicted Births Over Time')\nplt.legend()\n\n# Show plot\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-27-output-1.png){}\n:::\n:::\n\n\n# Final remarks\n\nThis experiment demonstrates how Prophet can be effectively used to forecast births in Malaysia by combining historical data with external factors such as temperature and pollutant levels. Integrating these regressors enabled the model to better capture seasonal patterns and underlying trends, as evidenced by the consistent performance across cross-validation metrics—including a stable MAPE of around 5%. Overall, the approach not only validates the robustness of Prophet for time series forecasting but also lays the groundwork for further enhancements. Future work might explore additional variables, like economic or social indicators, to refine predictions even further.\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js\" integrity=\"sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js\" integrity=\"sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==\" crossorigin=\"anonymous\" data-relocate-top=\"true\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n<script src=\"https://unpkg.com/@jupyter-widgets/html-manager@*/dist/embed-amd.js\" crossorigin=\"anonymous\"></script>\n"
      ],
      "include-after-body": [
        "<script type=application/vnd.jupyter.widget-state+json>\n{\"state\":{\"1eb612f72dd54855a4723b35a4f5efb6\":{\"model_module\":\"@jupyter-widgets/controls\",\"model_module_version\":\"2.0.0\",\"model_name\":\"FloatProgressModel\",\"state\":{\"_dom_classes\":[],\"_model_module\":\"@jupyter-widgets/controls\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"FloatProgressModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/controls\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"ProgressView\",\"bar_style\":\"success\",\"description\":\"\",\"description_allow_html\":false,\"layout\":\"IPY_MODEL_f305e1dac9824d4bb46bfb029d3a398e\",\"max\":49,\"min\":0,\"orientation\":\"horizontal\",\"style\":\"IPY_MODEL_d833fd5c1971429184453cd1356b6eea\",\"tabbable\":null,\"tooltip\":null,\"value\":49}},\"62fdfcb4bae74ad89f4ebc06e6195203\":{\"model_module\":\"@jupyter-widgets/controls\",\"model_module_version\":\"2.0.0\",\"model_name\":\"HTMLModel\",\"state\":{\"_dom_classes\":[],\"_model_module\":\"@jupyter-widgets/controls\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"HTMLModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/controls\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"HTMLView\",\"description\":\"\",\"description_allow_html\":false,\"layout\":\"IPY_MODEL_9debd754aa144fc38e21f94bf7a314d2\",\"placeholder\":\"​\",\"style\":\"IPY_MODEL_e2d93ccd31fc45b6bf324761498449f2\",\"tabbable\":null,\"tooltip\":null,\"value\":\"100%\"}},\"79ac37bfd34c49e1ace948c75f3dd42a\":{\"model_module\":\"@jupyter-widgets/base\",\"model_module_version\":\"2.0.0\",\"model_name\":\"LayoutModel\",\"state\":{\"_model_module\":\"@jupyter-widgets/base\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"LayoutModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/base\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"LayoutView\",\"align_content\":null,\"align_items\":null,\"align_self\":null,\"border_bottom\":null,\"border_left\":null,\"border_right\":null,\"border_top\":null,\"bottom\":null,\"display\":null,\"flex\":null,\"flex_flow\":null,\"grid_area\":null,\"grid_auto_columns\":null,\"grid_auto_flow\":null,\"grid_auto_rows\":null,\"grid_column\":null,\"grid_gap\":null,\"grid_row\":null,\"grid_template_areas\":null,\"grid_template_columns\":null,\"grid_template_rows\":null,\"height\":null,\"justify_content\":null,\"justify_items\":null,\"left\":null,\"margin\":null,\"max_height\":null,\"max_width\":null,\"min_height\":null,\"min_width\":null,\"object_fit\":null,\"object_position\":null,\"order\":null,\"overflow\":null,\"padding\":null,\"right\":null,\"top\":null,\"visibility\":null,\"width\":null}},\"7ba2993def1b41a5af61c6e9988f562e\":{\"model_module\":\"@jupyter-widgets/base\",\"model_module_version\":\"2.0.0\",\"model_name\":\"LayoutModel\",\"state\":{\"_model_module\":\"@jupyter-widgets/base\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"LayoutModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/base\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"LayoutView\",\"align_content\":null,\"align_items\":null,\"align_self\":null,\"border_bottom\":null,\"border_left\":null,\"border_right\":null,\"border_top\":null,\"bottom\":null,\"display\":null,\"flex\":null,\"flex_flow\":null,\"grid_area\":null,\"grid_auto_columns\":null,\"grid_auto_flow\":null,\"grid_auto_rows\":null,\"grid_column\":null,\"grid_gap\":null,\"grid_row\":null,\"grid_template_areas\":null,\"grid_template_columns\":null,\"grid_template_rows\":null,\"height\":null,\"justify_content\":null,\"justify_items\":null,\"left\":null,\"margin\":null,\"max_height\":null,\"max_width\":null,\"min_height\":null,\"min_width\":null,\"object_fit\":null,\"object_position\":null,\"order\":null,\"overflow\":null,\"padding\":null,\"right\":null,\"top\":null,\"visibility\":null,\"width\":null}},\"9debd754aa144fc38e21f94bf7a314d2\":{\"model_module\":\"@jupyter-widgets/base\",\"model_module_version\":\"2.0.0\",\"model_name\":\"LayoutModel\",\"state\":{\"_model_module\":\"@jupyter-widgets/base\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"LayoutModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/base\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"LayoutView\",\"align_content\":null,\"align_items\":null,\"align_self\":null,\"border_bottom\":null,\"border_left\":null,\"border_right\":null,\"border_top\":null,\"bottom\":null,\"display\":null,\"flex\":null,\"flex_flow\":null,\"grid_area\":null,\"grid_auto_columns\":null,\"grid_auto_flow\":null,\"grid_auto_rows\":null,\"grid_column\":null,\"grid_gap\":null,\"grid_row\":null,\"grid_template_areas\":null,\"grid_template_columns\":null,\"grid_template_rows\":null,\"height\":null,\"justify_content\":null,\"justify_items\":null,\"left\":null,\"margin\":null,\"max_height\":null,\"max_width\":null,\"min_height\":null,\"min_width\":null,\"object_fit\":null,\"object_position\":null,\"order\":null,\"overflow\":null,\"padding\":null,\"right\":null,\"top\":null,\"visibility\":null,\"width\":null}},\"d833fd5c1971429184453cd1356b6eea\":{\"model_module\":\"@jupyter-widgets/controls\",\"model_module_version\":\"2.0.0\",\"model_name\":\"ProgressStyleModel\",\"state\":{\"_model_module\":\"@jupyter-widgets/controls\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"ProgressStyleModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/base\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"StyleView\",\"bar_color\":null,\"description_width\":\"\"}},\"e2d93ccd31fc45b6bf324761498449f2\":{\"model_module\":\"@jupyter-widgets/controls\",\"model_module_version\":\"2.0.0\",\"model_name\":\"HTMLStyleModel\",\"state\":{\"_model_module\":\"@jupyter-widgets/controls\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"HTMLStyleModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/base\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"StyleView\",\"background\":null,\"description_width\":\"\",\"font_size\":null,\"text_color\":null}},\"f18698587b0c45589181aabdfb55f2fa\":{\"model_module\":\"@jupyter-widgets/controls\",\"model_module_version\":\"2.0.0\",\"model_name\":\"HTMLModel\",\"state\":{\"_dom_classes\":[],\"_model_module\":\"@jupyter-widgets/controls\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"HTMLModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/controls\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"HTMLView\",\"description\":\"\",\"description_allow_html\":false,\"layout\":\"IPY_MODEL_7ba2993def1b41a5af61c6e9988f562e\",\"placeholder\":\"​\",\"style\":\"IPY_MODEL_fa5d8e577ad143ed9e189048822fabdd\",\"tabbable\":null,\"tooltip\":null,\"value\":\" 49/49 [00:58&lt;00:00,  2.61s/it]\"}},\"f305e1dac9824d4bb46bfb029d3a398e\":{\"model_module\":\"@jupyter-widgets/base\",\"model_module_version\":\"2.0.0\",\"model_name\":\"LayoutModel\",\"state\":{\"_model_module\":\"@jupyter-widgets/base\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"LayoutModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/base\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"LayoutView\",\"align_content\":null,\"align_items\":null,\"align_self\":null,\"border_bottom\":null,\"border_left\":null,\"border_right\":null,\"border_top\":null,\"bottom\":null,\"display\":null,\"flex\":null,\"flex_flow\":null,\"grid_area\":null,\"grid_auto_columns\":null,\"grid_auto_flow\":null,\"grid_auto_rows\":null,\"grid_column\":null,\"grid_gap\":null,\"grid_row\":null,\"grid_template_areas\":null,\"grid_template_columns\":null,\"grid_template_rows\":null,\"height\":null,\"justify_content\":null,\"justify_items\":null,\"left\":null,\"margin\":null,\"max_height\":null,\"max_width\":null,\"min_height\":null,\"min_width\":null,\"object_fit\":null,\"object_position\":null,\"order\":null,\"overflow\":null,\"padding\":null,\"right\":null,\"top\":null,\"visibility\":null,\"width\":null}},\"f96111cbbfe1444f8a120b56a2f93b9f\":{\"model_module\":\"@jupyter-widgets/controls\",\"model_module_version\":\"2.0.0\",\"model_name\":\"HBoxModel\",\"state\":{\"_dom_classes\":[],\"_model_module\":\"@jupyter-widgets/controls\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"HBoxModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/controls\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"HBoxView\",\"box_style\":\"\",\"children\":[\"IPY_MODEL_62fdfcb4bae74ad89f4ebc06e6195203\",\"IPY_MODEL_1eb612f72dd54855a4723b35a4f5efb6\",\"IPY_MODEL_f18698587b0c45589181aabdfb55f2fa\"],\"layout\":\"IPY_MODEL_79ac37bfd34c49e1ace948c75f3dd42a\",\"tabbable\":null,\"tooltip\":null}},\"fa5d8e577ad143ed9e189048822fabdd\":{\"model_module\":\"@jupyter-widgets/controls\",\"model_module_version\":\"2.0.0\",\"model_name\":\"HTMLStyleModel\",\"state\":{\"_model_module\":\"@jupyter-widgets/controls\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"HTMLStyleModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/base\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"StyleView\",\"background\":null,\"description_width\":\"\",\"font_size\":null,\"text_color\":null}}},\"version_major\":2,\"version_minor\":0}\n</script>\n"
      ]
    }
  }
}