<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.23">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Diving Deeper Into Data – Pedro Leitão</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../_static/logo.jpg" rel="icon" type="image/jpeg">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-ce48a3f02a1a94fca2583af14ebdcdba.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-b0b4a5a44bd68b3ea90cf5591c8aa521.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="../../site_libs/quarto-contrib/nutshell-1.0.7/nutshell.js"></script>
<script src="../../site_libs/quarto-contrib/nutshell-1.0.7/nutshell_options.js"></script>
<script src="../../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>

      .quarto-title-block .quarto-title-banner {
        background-image: url(../../_static/banner-highlights-partial.jpg);
background-size: cover;
      }
</style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
<script data-collect-dnt="true" async="" src="https://scripts.simpleanalyticscdn.com/latest.js"></script>


<link rel="stylesheet" href="../../styles.css">
<meta property="og:title" content="Diving Deeper Into Data – Pedro Leitão">
<meta property="og:description" content="using pandas and matplotlib">
<meta property="og:image" content="https://pedroleitao.nl/_static/logo.jpg">
<meta property="og:site_name" content="Pedro Leitão">
<meta name="twitter:title" content="Diving Deeper Into Data – Pedro Leitão">
<meta name="twitter:description" content="using pandas and matplotlib">
<meta name="twitter:image" content="https://pedroleitao.nl/python-for-students/diving-into-data/index_files/figure-html/cell-18-output-1.png">
<meta name="twitter:image-height" content="525">
<meta name="twitter:image-width" content="966">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../_static/logo.jpg" alt="" class="navbar-logo">
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Bio</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../posts.html"> 
<span class="menu-text">All posts</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../experiments.html"> 
<span class="menu-text">Experiments</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../thoughts.html"> 
<span class="menu-text">Thoughts</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../howtos.html"> 
<span class="menu-text">Howto’s</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../python-for-students.html"> 
<span class="menu-text">Python for Students</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../dashboards.html"> 
<span class="menu-text">Dashboards</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/pedro-leitao"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://linkedin.com/in/nunoleitao"> <i class="bi bi-linkedin" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../posts.xml"> <i class="bi bi-rss" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Diving Deeper Into Data</h1>
            <p class="subtitle lead">using pandas and matplotlib</p>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#data-and-datasets" id="toc-data-and-datasets" class="nav-link active" data-scroll-target="#data-and-datasets">Data and datasets</a>
  <ul class="collapse">
  <li><a href="#downloading-the-dataset" id="toc-downloading-the-dataset" class="nav-link" data-scroll-target="#downloading-the-dataset">Downloading the dataset</a></li>
  </ul></li>
  <li><a href="#loading-and-working-with-data" id="toc-loading-and-working-with-data" class="nav-link" data-scroll-target="#loading-and-working-with-data">Loading and working with data</a></li>
  <li><a href="#the-importance-of-data-quality" id="toc-the-importance-of-data-quality" class="nav-link" data-scroll-target="#the-importance-of-data-quality">The importance of data quality</a>
  <ul class="collapse">
  <li><a href="#checking-for-missing-values" id="toc-checking-for-missing-values" class="nav-link" data-scroll-target="#checking-for-missing-values">Checking for missing values</a></li>
  <li><a href="#checking-for-duplicate-values" id="toc-checking-for-duplicate-values" class="nav-link" data-scroll-target="#checking-for-duplicate-values">Checking for duplicate values</a></li>
  <li><a href="#checking-for-incorrect-values" id="toc-checking-for-incorrect-values" class="nav-link" data-scroll-target="#checking-for-incorrect-values">Checking for incorrect values</a></li>
  </ul></li>
  <li><a href="#performing-simple-exploratory-data-analysis" id="toc-performing-simple-exploratory-data-analysis" class="nav-link" data-scroll-target="#performing-simple-exploratory-data-analysis">Performing simple exploratory data analysis</a>
  <ul class="collapse">
  <li><a href="#calculating-mean-values" id="toc-calculating-mean-values" class="nav-link" data-scroll-target="#calculating-mean-values">Calculating mean values</a></li>
  <li><a href="#distribution-of-data" id="toc-distribution-of-data" class="nav-link" data-scroll-target="#distribution-of-data">Distribution of data</a></li>
  <li><a href="#understanding-the-relationship-between-variables" id="toc-understanding-the-relationship-between-variables" class="nav-link" data-scroll-target="#understanding-the-relationship-between-variables">Understanding the relationship between variables</a></li>
  <li><a href="#categorical-data-and-grouping" id="toc-categorical-data-and-grouping" class="nav-link" data-scroll-target="#categorical-data-and-grouping">Categorical data and grouping</a></li>
  <li><a href="#using-dates-in-our-analysis" id="toc-using-dates-in-our-analysis" class="nav-link" data-scroll-target="#using-dates-in-our-analysis">Using dates in our analysis</a></li>
  <li><a href="#using-geographical-data-effectively" id="toc-using-geographical-data-effectively" class="nav-link" data-scroll-target="#using-geographical-data-effectively">Using geographical data effectively</a></li>
  </ul></li>
  <li><a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises">Exercises</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<p>By now we have covered a few basics - we learnt about different data types including lists, sequences and dictionaries, and we learnt how to use loops and conditions to manipulate data. We also learnt how to define simple functions, and how to load external modules to extend the functionality of Python.</p>
<p>Let us now dive a bit deeper into data, how to manipulate it, and how to use it to answer questions and get some insights. We will use the <code>pandas</code> library to work with data, and the <code>matplotlib</code> library to visualize it.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Learning Objectives
</div>
</div>
<div class="callout-body-container callout-body">
<p>The <code>pandas</code> library is a powerful, yet large library that is used for data manipulation and analysis. We will only scratch the surface of what it can do in this book. As you progress, you can and should refer to the <a href="https://pandas.pydata.org//docs/user_guide/10min.html">official documentation</a> to learn more, and to hone your skills.</p>
</div>
</div>
<section id="data-and-datasets" class="level2">
<h2 class="anchored" data-anchor-id="data-and-datasets">Data and datasets</h2>
<p>You will likely have come accross some data before that you had to work with, perhaps in Excel. There are also lots of different public datasets available online that you can use to practice your data analysis skills. A great resource for this is <a href="https://www.kaggle.com/datasets">Kaggle</a>, where you can find datasets on a wide range of topics.</p>
<p>For this section, we will use a public dataset from Kaggle which includes earthquake data from around the world. You can download the dataset from <a href="https://www.kaggle.com/datasets/usgs/earthquake-database">this link</a>. The dataset is in CSV format, which by now you should be familiar with and can load.</p>
<section id="downloading-the-dataset" class="level3">
<h3 class="anchored" data-anchor-id="downloading-the-dataset">Downloading the dataset</h3>
<p>There are several ways to get a public dataset into your computer - you can download it directly from the website, or you can use the <code>kaggle</code> command line tool to download it. Because we are practicing some programming skills, we will use the command line tool to download the dataset.</p>
<p>To install it you can use <code>conda</code>, as follows:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="ex">conda</span> install <span class="at">-c</span> conda-forge kaggle</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Once you have installed the tool, you need to create a profile in Kaggle and create an API key. Instead of rewriting the instructions here, just follow the excellent instructions by Christian Mills in <a href="https://christianjmills.com/posts/kaggle-obtain-api-key-tutorial//">this blog post</a>.</p>
<p>Once you have your API key, you can download the dataset using the following command:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="ex">kaggle</span> datasets download usgs/earthquake-database</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
About Downloading Datasets
</div>
</div>
<div class="callout-body-container callout-body">
<p>:class: tip, dropdown There are other ways to download the dataset, such as using packages like <a href="https://anaconda.org/anaconda/kagglehub">Kagglehub</a>, or <a href="https://anaconda.org/conda-forge/mlcroissant">mlcroissant</a>. But for now we will use the command line tool as the other approaches are programmatic.</p>
</div>
</div>
<p>Your new dataset will be in a compressed zip file named <code>earthquake-database.zip</code> ready to be explored!</p>
</section>
</section>
<section id="loading-and-working-with-data" class="level2">
<h2 class="anchored" data-anchor-id="loading-and-working-with-data">Loading and working with data</h2>
<p>Pandas can unpack zip files directly, let us see how to do it.</p>
<div id="59510241" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="59510241"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="59510241-1"><a href="#59510241-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="59510241-2"><a href="#59510241-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="59510241-3"><a href="#59510241-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Read the CSV directly from the zip</span></span>
<span id="59510241-4"><a href="#59510241-4" aria-hidden="true" tabindex="-1"></a>earthquakes <span class="op">=</span> pd.read_csv(<span class="st">"earthquake-database.zip"</span>, compression<span class="op">=</span><span class="st">"zip"</span>)</span>
<span id="59510241-5"><a href="#59510241-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="59510241-6"><a href="#59510241-6" aria-hidden="true" tabindex="-1"></a>earthquakes.head(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Date</th>
<th data-quarto-table-cell-role="th">Time</th>
<th data-quarto-table-cell-role="th">Latitude</th>
<th data-quarto-table-cell-role="th">Longitude</th>
<th data-quarto-table-cell-role="th">Type</th>
<th data-quarto-table-cell-role="th">Depth</th>
<th data-quarto-table-cell-role="th">Depth Error</th>
<th data-quarto-table-cell-role="th">Depth Seismic Stations</th>
<th data-quarto-table-cell-role="th">Magnitude</th>
<th data-quarto-table-cell-role="th">Magnitude Type</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">Magnitude Seismic Stations</th>
<th data-quarto-table-cell-role="th">Azimuthal Gap</th>
<th data-quarto-table-cell-role="th">Horizontal Distance</th>
<th data-quarto-table-cell-role="th">Horizontal Error</th>
<th data-quarto-table-cell-role="th">Root Mean Square</th>
<th data-quarto-table-cell-role="th">ID</th>
<th data-quarto-table-cell-role="th">Source</th>
<th data-quarto-table-cell-role="th">Location Source</th>
<th data-quarto-table-cell-role="th">Magnitude Source</th>
<th data-quarto-table-cell-role="th">Status</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>01/02/1965</td>
<td>13:44:18</td>
<td>19.246</td>
<td>145.616</td>
<td>Earthquake</td>
<td>131.6</td>
<td>NaN</td>
<td>NaN</td>
<td>6.0</td>
<td>MW</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>ISCGEM860706</td>
<td>ISCGEM</td>
<td>ISCGEM</td>
<td>ISCGEM</td>
<td>Automatic</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>01/04/1965</td>
<td>11:29:49</td>
<td>1.863</td>
<td>127.352</td>
<td>Earthquake</td>
<td>80.0</td>
<td>NaN</td>
<td>NaN</td>
<td>5.8</td>
<td>MW</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>ISCGEM860737</td>
<td>ISCGEM</td>
<td>ISCGEM</td>
<td>ISCGEM</td>
<td>Automatic</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>01/05/1965</td>
<td>18:05:58</td>
<td>-20.579</td>
<td>-173.972</td>
<td>Earthquake</td>
<td>20.0</td>
<td>NaN</td>
<td>NaN</td>
<td>6.2</td>
<td>MW</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>ISCGEM860762</td>
<td>ISCGEM</td>
<td>ISCGEM</td>
<td>ISCGEM</td>
<td>Automatic</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>01/08/1965</td>
<td>18:49:43</td>
<td>-59.076</td>
<td>-23.557</td>
<td>Earthquake</td>
<td>15.0</td>
<td>NaN</td>
<td>NaN</td>
<td>5.8</td>
<td>MW</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>ISCGEM860856</td>
<td>ISCGEM</td>
<td>ISCGEM</td>
<td>ISCGEM</td>
<td>Automatic</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>01/09/1965</td>
<td>13:32:50</td>
<td>11.938</td>
<td>126.427</td>
<td>Earthquake</td>
<td>15.0</td>
<td>NaN</td>
<td>NaN</td>
<td>5.8</td>
<td>MW</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>ISCGEM860890</td>
<td>ISCGEM</td>
<td>ISCGEM</td>
<td>ISCGEM</td>
<td>Automatic</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>01/10/1965</td>
<td>13:36:32</td>
<td>-13.405</td>
<td>166.629</td>
<td>Earthquake</td>
<td>35.0</td>
<td>NaN</td>
<td>NaN</td>
<td>6.7</td>
<td>MW</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>ISCGEM860922</td>
<td>ISCGEM</td>
<td>ISCGEM</td>
<td>ISCGEM</td>
<td>Automatic</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>01/12/1965</td>
<td>13:32:25</td>
<td>27.357</td>
<td>87.867</td>
<td>Earthquake</td>
<td>20.0</td>
<td>NaN</td>
<td>NaN</td>
<td>5.9</td>
<td>MW</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>ISCGEM861007</td>
<td>ISCGEM</td>
<td>ISCGEM</td>
<td>ISCGEM</td>
<td>Automatic</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>01/15/1965</td>
<td>23:17:42</td>
<td>-13.309</td>
<td>166.212</td>
<td>Earthquake</td>
<td>35.0</td>
<td>NaN</td>
<td>NaN</td>
<td>6.0</td>
<td>MW</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>ISCGEM861111</td>
<td>ISCGEM</td>
<td>ISCGEM</td>
<td>ISCGEM</td>
<td>Automatic</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>01/16/1965</td>
<td>11:32:37</td>
<td>-56.452</td>
<td>-27.043</td>
<td>Earthquake</td>
<td>95.0</td>
<td>NaN</td>
<td>NaN</td>
<td>6.0</td>
<td>MW</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>ISCGEMSUP861125</td>
<td>ISCGEMSUP</td>
<td>ISCGEM</td>
<td>ISCGEM</td>
<td>Automatic</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>01/17/1965</td>
<td>10:43:17</td>
<td>-24.563</td>
<td>178.487</td>
<td>Earthquake</td>
<td>565.0</td>
<td>NaN</td>
<td>NaN</td>
<td>5.8</td>
<td>MW</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>ISCGEM861148</td>
<td>ISCGEM</td>
<td>ISCGEM</td>
<td>ISCGEM</td>
<td>Automatic</td>
</tr>
</tbody>
</table>

<p>10 rows × 21 columns</p>
</div>
</div>
</div>
<p>There’s a few new things there. We loaded the file with <code>read_csv</code> as we encountered before, but this time we passed the <code>compression</code> argument to specify that the file is compressed. We also used the <code>head</code> method to show the first 10 rows of the dataframe. This is a very useful method to quickly check the contents of a dataset.</p>
<p>Pandas offers a few other methods to quickly check the contents of a dataframe, such as <code>info</code> and <code>describe</code>. Let us see how they work.</p>
<div id="c64fda02" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="c64fda02"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="c64fda02-1"><a href="#c64fda02-1" aria-hidden="true" tabindex="-1"></a>earthquakes.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="2">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Latitude</th>
<th data-quarto-table-cell-role="th">Longitude</th>
<th data-quarto-table-cell-role="th">Depth</th>
<th data-quarto-table-cell-role="th">Depth Error</th>
<th data-quarto-table-cell-role="th">Depth Seismic Stations</th>
<th data-quarto-table-cell-role="th">Magnitude</th>
<th data-quarto-table-cell-role="th">Magnitude Error</th>
<th data-quarto-table-cell-role="th">Magnitude Seismic Stations</th>
<th data-quarto-table-cell-role="th">Azimuthal Gap</th>
<th data-quarto-table-cell-role="th">Horizontal Distance</th>
<th data-quarto-table-cell-role="th">Horizontal Error</th>
<th data-quarto-table-cell-role="th">Root Mean Square</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">count</td>
<td>23412.000000</td>
<td>23412.000000</td>
<td>23412.000000</td>
<td>4461.000000</td>
<td>7097.000000</td>
<td>23412.000000</td>
<td>327.000000</td>
<td>2564.000000</td>
<td>7299.000000</td>
<td>1604.000000</td>
<td>1156.000000</td>
<td>17352.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">mean</td>
<td>1.679033</td>
<td>39.639961</td>
<td>70.767911</td>
<td>4.993115</td>
<td>275.364098</td>
<td>5.882531</td>
<td>0.071820</td>
<td>48.944618</td>
<td>44.163532</td>
<td>3.992660</td>
<td>7.662759</td>
<td>1.022784</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">std</td>
<td>30.113183</td>
<td>125.511959</td>
<td>122.651898</td>
<td>4.875184</td>
<td>162.141631</td>
<td>0.423066</td>
<td>0.051466</td>
<td>62.943106</td>
<td>32.141486</td>
<td>5.377262</td>
<td>10.430396</td>
<td>0.188545</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">min</td>
<td>-77.080000</td>
<td>-179.997000</td>
<td>-1.100000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>5.500000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.004505</td>
<td>0.085000</td>
<td>0.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">25%</td>
<td>-18.653000</td>
<td>-76.349750</td>
<td>14.522500</td>
<td>1.800000</td>
<td>146.000000</td>
<td>5.600000</td>
<td>0.046000</td>
<td>10.000000</td>
<td>24.100000</td>
<td>0.968750</td>
<td>5.300000</td>
<td>0.900000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">50%</td>
<td>-3.568500</td>
<td>103.982000</td>
<td>33.000000</td>
<td>3.500000</td>
<td>255.000000</td>
<td>5.700000</td>
<td>0.059000</td>
<td>28.000000</td>
<td>36.000000</td>
<td>2.319500</td>
<td>6.700000</td>
<td>1.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">75%</td>
<td>26.190750</td>
<td>145.026250</td>
<td>54.000000</td>
<td>6.300000</td>
<td>384.000000</td>
<td>6.000000</td>
<td>0.075500</td>
<td>66.000000</td>
<td>54.000000</td>
<td>4.724500</td>
<td>8.100000</td>
<td>1.130000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">max</td>
<td>86.005000</td>
<td>179.998000</td>
<td>700.000000</td>
<td>91.295000</td>
<td>934.000000</td>
<td>9.100000</td>
<td>0.410000</td>
<td>821.000000</td>
<td>360.000000</td>
<td>37.874000</td>
<td>99.000000</td>
<td>3.440000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>The <code>describe</code> method gives us a summary of the numerical columns in the dataframe. It shows the count of non-null values, the mean, standard deviation, minimum, maximum, and the quartiles of the data. This is a very useful method to quickly get an idea of the distribution of the data.</p>
<div id="caae53c4" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="caae53c4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="caae53c4-1"><a href="#caae53c4-1" aria-hidden="true" tabindex="-1"></a>earthquakes.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 23412 entries, 0 to 23411
Data columns (total 21 columns):
 #   Column                      Non-Null Count  Dtype  
---  ------                      --------------  -----  
 0   Date                        23412 non-null  object 
 1   Time                        23412 non-null  object 
 2   Latitude                    23412 non-null  float64
 3   Longitude                   23412 non-null  float64
 4   Type                        23412 non-null  object 
 5   Depth                       23412 non-null  float64
 6   Depth Error                 4461 non-null   float64
 7   Depth Seismic Stations      7097 non-null   float64
 8   Magnitude                   23412 non-null  float64
 9   Magnitude Type              23409 non-null  object 
 10  Magnitude Error             327 non-null    float64
 11  Magnitude Seismic Stations  2564 non-null   float64
 12  Azimuthal Gap               7299 non-null   float64
 13  Horizontal Distance         1604 non-null   float64
 14  Horizontal Error            1156 non-null   float64
 15  Root Mean Square            17352 non-null  float64
 16  ID                          23412 non-null  object 
 17  Source                      23412 non-null  object 
 18  Location Source             23412 non-null  object 
 19  Magnitude Source            23412 non-null  object 
 20  Status                      23412 non-null  object 
dtypes: float64(12), object(9)
memory usage: 3.8+ MB</code></pre>
</div>
</div>
<p><code>info</code> on the other hand gives us a summary of the dataframe, including the number of non-null values in each column (remember back to <a href="types-of-data">types of data</a>), the data type of each column, and the memory usage of the dataframe. This is useful to quickly check if there are any missing values. In the above output we can see that there are 23412 entries in the dataframe, and that there are some columns with missing data (<code>Depth Error</code> for example).</p>
</section>
<section id="the-importance-of-data-quality" class="level2">
<h2 class="anchored" data-anchor-id="the-importance-of-data-quality">The importance of data quality</h2>
<p>Data quality is a very important aspect of data analysis. If the data is not clean, the results of the analysis will not be reliable. There are many ways in which data can be of poor quality, such as missing, incorrect or inconsistent values. It is important to always check the quality of the data before starting any analysis, and Pandas offers a few methods to help with this.</p>
<p>Before you make use of a dataset, it is a good idea to perform a few checks to ensure that the data is clean. These can include:</p>
<ul>
<li>Checking for missing values</li>
<li>Checking for duplicate values</li>
<li>Checking for incorrect values</li>
</ul>
<p>Let us see how to do this with the earthquake dataset for a few simple cases. In practice, checking for correctness of a dataset can be a bit of an art requiring specific domain knowledge, but we will cover some basic cases here.</p>
<section id="checking-for-missing-values" class="level3">
<h3 class="anchored" data-anchor-id="checking-for-missing-values">Checking for missing values</h3>
<p>Frequently columns in a dataset will have missing or incomplete data. Pandas can handle missing data in a few ways, such as dropping the rows with missing data, filling the missing data with a value, or interpolating the missing data. Let us see what this looks like by showing the series for the <code>Depth Error</code> column.</p>
<div id="239dadb1" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="239dadb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="239dadb1-1"><a href="#239dadb1-1" aria-hidden="true" tabindex="-1"></a>earthquakes[<span class="st">"Depth Error"</span>].info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.series.Series'&gt;
RangeIndex: 23412 entries, 0 to 23411
Series name: Depth Error
Non-Null Count  Dtype  
--------------  -----  
4461 non-null   float64
dtypes: float64(1)
memory usage: 183.0 KB</code></pre>
</div>
</div>
<p>Notice how the range is 0 to 23411, but how the Non-Null Count is only 4461. This means that there are 18951 missing values in this column. We can use the <code>isnull</code> method to check for missing values across all columns in the dataframe.</p>
<div id="268a51ec" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="268a51ec"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="268a51ec-1"><a href="#268a51ec-1" aria-hidden="true" tabindex="-1"></a>earthquakes.isnull().<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>Date                              0
Time                              0
Latitude                          0
Longitude                         0
Type                              0
Depth                             0
Depth Error                   18951
Depth Seismic Stations        16315
Magnitude                         0
Magnitude Type                    3
Magnitude Error               23085
Magnitude Seismic Stations    20848
Azimuthal Gap                 16113
Horizontal Distance           21808
Horizontal Error              22256
Root Mean Square               6060
ID                                0
Source                            0
Location Source                   0
Magnitude Source                  0
Status                            0
dtype: int64</code></pre>
</div>
</div>
<p>Quite a few columns have missing values, such as <code>Depth Error</code>, <code>Depth Seismic Stations</code>, <code>Magnitude Error</code>, and <code>Magnitude Seismic Stations</code>.</p>
<p>Let us see what missing values look like in the dataframe.</p>
<div id="475d87b9" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="475d87b9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="475d87b9-1"><a href="#475d87b9-1" aria-hidden="true" tabindex="-1"></a>earthquakes[<span class="st">"Depth Error"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<pre><code>0        NaN
1        NaN
2        NaN
3        NaN
4        NaN
        ... 
23407    1.2
23408    2.0
23409    1.8
23410    1.8
23411    2.2
Name: Depth Error, Length: 23412, dtype: float64</code></pre>
</div>
</div>
<p>The entries with missing values are shown as <code>NaN</code>, which stands for “Not a Number”.</p>
<p>Pandas offers a few methods to handle missing values, such as <code>dropna</code> (will drop any rows with missing values), <code>fillna</code> (substitutes a missing value with a prescribed value), and <code>interpolate</code> (will fill in missing values with interpolated values).</p>
<p>As an example, let us drop any rows with a missing <code>Magnitude Type</code>.</p>
<div id="1341055a" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="1341055a"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="1341055a-1"><a href="#1341055a-1" aria-hidden="true" tabindex="-1"></a>earthquakes <span class="op">=</span> earthquakes.dropna(subset<span class="op">=</span>[<span class="st">"Magnitude Type"</span>], ignore_index<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <code>dropna</code> method has a few arguments that can be used to customize the behavior. In the example above, we used the <code>subset</code> argument to specify that we only want to drop rows where the <code>Magnitude Type</code> column is missing. We also used the <code>ignore_index</code> argument to reset the index of the dataframe after dropping the rows.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
About the <code>ignore_index</code> argument
</div>
</div>
<div class="callout-body-container callout-body">
<p>Dataframes in Pandas always have an index which is used to identify the rows. When you drop rows from a dataframe, the index is not automatically reset. This can be a problem if you want to iterate over the rows of the dataframe, as the index will have gaps. The <code>ignore_index</code> argument can be used to reset the index after dropping rows. You will come across many cases where you will need to reset the index of a dataframe, so it is good to be aware of this.</p>
</div>
</div>
<p>Let us now look at the dataframe again to see if the rows with missing <code>Magnitude Type</code> have been dropped.</p>
<div id="7ec80b4f" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="7ec80b4f"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="7ec80b4f-1"><a href="#7ec80b4f-1" aria-hidden="true" tabindex="-1"></a>earthquakes.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 23409 entries, 0 to 23408
Data columns (total 21 columns):
 #   Column                      Non-Null Count  Dtype  
---  ------                      --------------  -----  
 0   Date                        23409 non-null  object 
 1   Time                        23409 non-null  object 
 2   Latitude                    23409 non-null  float64
 3   Longitude                   23409 non-null  float64
 4   Type                        23409 non-null  object 
 5   Depth                       23409 non-null  float64
 6   Depth Error                 4461 non-null   float64
 7   Depth Seismic Stations      7097 non-null   float64
 8   Magnitude                   23409 non-null  float64
 9   Magnitude Type              23409 non-null  object 
 10  Magnitude Error             327 non-null    float64
 11  Magnitude Seismic Stations  2564 non-null   float64
 12  Azimuthal Gap               7299 non-null   float64
 13  Horizontal Distance         1604 non-null   float64
 14  Horizontal Error            1156 non-null   float64
 15  Root Mean Square            17352 non-null  float64
 16  ID                          23409 non-null  object 
 17  Source                      23409 non-null  object 
 18  Location Source             23409 non-null  object 
 19  Magnitude Source            23409 non-null  object 
 20  Status                      23409 non-null  object 
dtypes: float64(12), object(9)
memory usage: 3.8+ MB</code></pre>
</div>
</div>
<p>We now see 23409 entries in the dataframe, which means that 3 rows were dropped as expected, and RangeIndex correctly shows an index from 0 to 23408.</p>
<p>We could perform similar operations for other columns with missing values, such as <code>Depth Error</code>, <code>Depth Seismic Stations</code>, <code>Magnitude Error</code>, and <code>Magnitude Seismic Stations</code>, but for now we will leave it at that as we are just exemplifying the process.</p>
</section>
<section id="checking-for-duplicate-values" class="level3">
<h3 class="anchored" data-anchor-id="checking-for-duplicate-values">Checking for duplicate values</h3>
<p>Another common problem in datasets is duplicate values. These can occur for a variety of reasons, such as data entry errors, or errors in the data collection process. Pandas offers a few methods to check for duplicate values, such as <code>duplicated</code> and <code>drop_duplicates</code>.</p>
<p>As an example, let us check for duplicate values in the <code>ID</code> column. We do this by using the <code>duplicated</code> method, which returns a boolean series indicating whether a value is duplicated or not, and then using the <code>sum</code> method to count the number of duplicates.</p>
<div id="2c43d019" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="2c43d019"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="2c43d019-1"><a href="#2c43d019-1" aria-hidden="true" tabindex="-1"></a>earthquakes.duplicated(subset<span class="op">=</span>[<span class="st">"ID"</span>]).<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<pre><code>0</code></pre>
</div>
</div>
<p>The result was 0, which means that there are no duplicate values in the <code>ID</code> column, good!</p>
<p>Let us now check to try and find duplicate <code>Latitude</code> and <code>Longitude</code> values, as these could indicate that the same earthquake was recorded more than once by the same, or different stations.</p>
<div id="acb3160a" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="acb3160a"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="acb3160a-1"><a href="#acb3160a-1" aria-hidden="true" tabindex="-1"></a>earthquakes.duplicated(subset<span class="op">=</span>[<span class="st">"Latitude"</span>, <span class="st">"Longitude"</span>]).<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<pre><code>6</code></pre>
</div>
</div>
<p>There! We found 6 duplicates present. Let us now drop these duplicates with the <code>drop_duplicates</code> method.</p>
<div id="2a14e8b7" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="2a14e8b7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="2a14e8b7-1"><a href="#2a14e8b7-1" aria-hidden="true" tabindex="-1"></a>earthquakes <span class="op">=</span> earthquakes.drop_duplicates(</span>
<span id="2a14e8b7-2"><a href="#2a14e8b7-2" aria-hidden="true" tabindex="-1"></a>    subset<span class="op">=</span>[<span class="st">"Latitude"</span>, <span class="st">"Longitude"</span>], ignore_index<span class="op">=</span><span class="va">True</span></span>
<span id="2a14e8b7-3"><a href="#2a14e8b7-3" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="checking-for-incorrect-values" class="level3">
<h3 class="anchored" data-anchor-id="checking-for-incorrect-values">Checking for incorrect values</h3>
<p>Checking for incorrect values in a dataset can be a bit more challenging, as it requires some domain knowledge. For argument’s sake, let us check for large <code>Horizontal Error</code> values (in the dataset, <code>Horizontal Error</code> is the horizontal error of the location of the earthquake in kilometers, and let us assume that it should not be larger than 90 km).</p>
<div id="186bd5f5" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="186bd5f5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="186bd5f5-1"><a href="#186bd5f5-1" aria-hidden="true" tabindex="-1"></a>(earthquakes[<span class="st">"Horizontal Error"</span>] <span class="op">&gt;</span> <span class="dv">90</span>).<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<pre><code>14</code></pre>
</div>
</div>
<p>The above expression <code>earthquakes['Horizontal Error'] &gt; 90</code> returns a boolean series indicating whether the condition is met or not, and then we use the <code>sum</code> method to count the number of values that meet the condition. In this case, there are 14 earthquakes with a <code>Horizontal Error</code> larger than 90 km, which could be incorrect values. Let us now drop these rows.</p>
<div id="8fb6545e" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="8fb6545e"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="8fb6545e-1"><a href="#8fb6545e-1" aria-hidden="true" tabindex="-1"></a>earthquakes <span class="op">=</span> earthquakes.drop(</span>
<span id="8fb6545e-2"><a href="#8fb6545e-2" aria-hidden="true" tabindex="-1"></a>    earthquakes[earthquakes[<span class="st">"Horizontal Error"</span>] <span class="op">&gt;</span> <span class="dv">90</span>].index</span>
<span id="8fb6545e-3"><a href="#8fb6545e-3" aria-hidden="true" tabindex="-1"></a>).reset_index(drop<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The above code has a few more details than what we have seen until now. It works by first selecting the rows that meet the condition <code>earthquakes['Horizontal Error'] &gt; 90</code>, and then using the <code>index</code> attribute to get the index (0, 1, 2, etc.) of the rows that meet the condition. We then use the <code>drop</code> method to drop these rows, and finally use the <code>reset_index</code> method to reset the index of the dataframe as we have seen before when using the <code>ignore_index</code> argument of the <code>dropna</code> method.</p>
<p>Let’s now check the dataframe to see if the rows with large <code>Horizontal Error</code> values have been dropped.</p>
<div id="5aef2520" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="5aef2520"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="5aef2520-1"><a href="#5aef2520-1" aria-hidden="true" tabindex="-1"></a>(earthquakes[<span class="st">"Horizontal Error"</span>] <span class="op">&gt;</span> <span class="dv">90</span>).<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<pre><code>0</code></pre>
</div>
</div>
<p>Perfect! No more rows with large <code>Horizontal Error</code> values!</p>
</section>
</section>
<section id="performing-simple-exploratory-data-analysis" class="level2">
<h2 class="anchored" data-anchor-id="performing-simple-exploratory-data-analysis">Performing simple exploratory data analysis</h2>
<p>Now that we have cleaned the data, we can start performing some analysis. By analysis we mean answering questions about the data, such as:</p>
<ul>
<li>What is the average magnitude of earthquakes in the dataset?</li>
<li>What is the average depth of earthquakes ?</li>
<li>How many earthquakes were recorded per year ?</li>
<li>What is the average number of stations that recorded an earthquake ?</li>
</ul>
<section id="calculating-mean-values" class="level3">
<h3 class="anchored" data-anchor-id="calculating-mean-values">Calculating mean values</h3>
<div id="ab35b161" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="ab35b161"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="ab35b161-1"><a href="#ab35b161-1" aria-hidden="true" tabindex="-1"></a>earthquakes[<span class="st">"Magnitude"</span>].describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<pre><code>count    23389.000000
mean         5.882655
std          0.423149
min          5.500000
25%          5.600000
50%          5.700000
75%          6.000000
max          9.100000
Name: Magnitude, dtype: float64</code></pre>
</div>
</div>
<p>This code simply uses the <code>describe</code> method to show the summary statistics of the <code>Magnitude</code> column, which includes the mean value, as well as the standard deviation, minimum, maximum, and quartiles. Alternatively, we could calculate the mean value directly.</p>
<div id="656f3d85" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="656f3d85"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="656f3d85-1"><a href="#656f3d85-1" aria-hidden="true" tabindex="-1"></a>earthquakes[<span class="st">"Magnitude"</span>].mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<pre><code>5.882655094275087</code></pre>
</div>
</div>
</section>
<section id="distribution-of-data" class="level3">
<h3 class="anchored" data-anchor-id="distribution-of-data">Distribution of data</h3>
<p>One important aspect of data analysis is understanding the distribution of the data. This can be done by plotting histograms or density charts, which show the frequency of values in a dataset. As an example, let us look at the distribution of the <code>Magnitude</code> column.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
About Data Distribution
</div>
</div>
<div class="callout-body-container callout-body">
<p>Understanding the distribution of data is very important in data analysis, as it can help identify patterns and trends. For example, if the data is normally distributed, we can use statistical methods that assume a normal distribution. If the data is not normally distributed, we may need to use non-parametric methods instead.</p>
<p>A great introduction to statistics if you haven’t looked very deeply into the topic is Shafer and Zhang’s <a href="https://stats.libretexts.org/Bookshelves/Introductory_Statistics/Introductory_Statistics_(Shafer_and_Zhang)">Introductory Statistics</a>.</p>
</div>
</div>
<div id="e409d3ec" class="cell" data-tags="[&quot;hide-input&quot;]" data-execution_count="18">
<div class="sourceCode cell-code" id="e409d3ec"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="e409d3ec-1"><a href="#e409d3ec-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="e409d3ec-2"><a href="#e409d3ec-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="e409d3ec-3"><a href="#e409d3ec-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> norm</span>
<span id="e409d3ec-4"><a href="#e409d3ec-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="e409d3ec-5"><a href="#e409d3ec-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate normally distributed integers</span></span>
<span id="e409d3ec-6"><a href="#e409d3ec-6" aria-hidden="true" tabindex="-1"></a>normal_integers <span class="op">=</span> np.random.normal(loc<span class="op">=</span><span class="dv">0</span>, scale<span class="op">=</span><span class="dv">10</span>, size<span class="op">=</span><span class="dv">1000</span>)</span>
<span id="e409d3ec-7"><a href="#e409d3ec-7" aria-hidden="true" tabindex="-1"></a>normal_integers <span class="op">=</span> np.<span class="bu">round</span>(normal_integers).astype(<span class="bu">int</span>)</span>
<span id="e409d3ec-8"><a href="#e409d3ec-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="e409d3ec-9"><a href="#e409d3ec-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate data for the line (fitted normal distribution)</span></span>
<span id="e409d3ec-10"><a href="#e409d3ec-10" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.arange(<span class="bu">min</span>(normal_integers), <span class="bu">max</span>(normal_integers) <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="e409d3ec-11"><a href="#e409d3ec-11" aria-hidden="true" tabindex="-1"></a>pdf <span class="op">=</span> norm.pdf(x, loc<span class="op">=</span><span class="dv">0</span>, scale<span class="op">=</span><span class="dv">10</span>)  <span class="co"># Normal PDF based on the original distribution</span></span>
<span id="e409d3ec-12"><a href="#e409d3ec-12" aria-hidden="true" tabindex="-1"></a>pdf_scaled <span class="op">=</span> pdf <span class="op">*</span> <span class="bu">len</span>(normal_integers) <span class="op">*</span> (x[<span class="dv">1</span>] <span class="op">-</span> x[<span class="dv">0</span>])  <span class="co"># Scale to match histogram</span></span>
<span id="e409d3ec-13"><a href="#e409d3ec-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="e409d3ec-14"><a href="#e409d3ec-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the histogram</span></span>
<span id="e409d3ec-15"><a href="#e409d3ec-15" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">6</span>))</span>
<span id="e409d3ec-16"><a href="#e409d3ec-16" aria-hidden="true" tabindex="-1"></a>plt.hist(normal_integers, bins<span class="op">=</span><span class="dv">20</span>, edgecolor<span class="op">=</span><span class="st">"black"</span>, alpha<span class="op">=</span><span class="fl">0.7</span>, label<span class="op">=</span><span class="st">"Histogram"</span>)</span>
<span id="e409d3ec-17"><a href="#e409d3ec-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="e409d3ec-18"><a href="#e409d3ec-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Overlay the line</span></span>
<span id="e409d3ec-19"><a href="#e409d3ec-19" aria-hidden="true" tabindex="-1"></a>plt.plot(x, pdf_scaled, color<span class="op">=</span><span class="st">"red"</span>, label<span class="op">=</span><span class="st">"Normal Distribution Curve"</span>)</span>
<span id="e409d3ec-20"><a href="#e409d3ec-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="e409d3ec-21"><a href="#e409d3ec-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Add labels and title</span></span>
<span id="e409d3ec-22"><a href="#e409d3ec-22" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Histogram with Normal Distribution Curve"</span>)</span>
<span id="e409d3ec-23"><a href="#e409d3ec-23" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Value"</span>)</span>
<span id="e409d3ec-24"><a href="#e409d3ec-24" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Frequency"</span>)</span>
<span id="e409d3ec-25"><a href="#e409d3ec-25" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="e409d3ec-26"><a href="#e409d3ec-26" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>, linestyle<span class="op">=</span><span class="st">"--"</span>, alpha<span class="op">=</span><span class="fl">0.6</span>)</span>
<span id="e409d3ec-27"><a href="#e409d3ec-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="e409d3ec-28"><a href="#e409d3ec-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the plot</span></span>
<span id="e409d3ec-29"><a href="#e409d3ec-29" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/cell-18-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="index_files/figure-html/cell-18-output-1.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
<p>The usual process to understand a distribution is by dividing the data into ranges (also called “bins”), and then counting the number of values in each range. This is what the histogram shows. Let us see how this works.</p>
<div id="6f9103fa" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="6f9103fa"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="6f9103fa-1"><a href="#6f9103fa-1" aria-hidden="true" tabindex="-1"></a>earthquakes[<span class="st">"Magnitude"</span>].value_counts(bins<span class="op">=</span><span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<pre><code>(5.495, 6.4]    21084
(6.4, 7.3]       2023
(7.3, 8.2]        269
(8.2, 9.1]         13
Name: count, dtype: int64</code></pre>
</div>
</div>
<p>This code uses the <code>value_counts</code> method to count the number of earthquake magnitudes into four bins (<code>bins=4</code>), and returns a series with the counts. Any numerical columns in a dataframe can be divided into bins using this method.</p>
<p>We can also plot the histogram for the <code>Magnitude</code> column using the <code>plot</code> method and the <code>hist</code> plot kind.</p>
<div id="d1b6ba66" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="d1b6ba66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="d1b6ba66-1"><a href="#d1b6ba66-1" aria-hidden="true" tabindex="-1"></a>earthquakes[<span class="st">"Magnitude"</span>].plot(</span>
<span id="d1b6ba66-2"><a href="#d1b6ba66-2" aria-hidden="true" tabindex="-1"></a>    kind<span class="op">=</span><span class="st">"hist"</span>, bins<span class="op">=</span><span class="dv">4</span>, title<span class="op">=</span><span class="st">"Earthquakes Magnitude Distribution"</span>, figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">6</span>)</span>
<span id="d1b6ba66-3"><a href="#d1b6ba66-3" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/cell-20-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="index_files/figure-html/cell-20-output-1.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
<p>This creates a compelling visualisation of the distribution of magnitudes, and we can see there are a lot of earthquakes with small magnitudes!</p>
</section>
<section id="understanding-the-relationship-between-variables" class="level3">
<h3 class="anchored" data-anchor-id="understanding-the-relationship-between-variables">Understanding the relationship between variables</h3>
<p>Another important aspect of data analysis is understanding the relationship between variables. This can be done by computing the correlation between variables, which measures how closely related two variables are. The correlation coefficient ranges from -1 to 1, where -1 indicates a perfect negative correlation, 1 indicates a perfect positive correlation, and 0 indicates no correlation.</p>
<p>Pandas offers a <code>corr</code> method to compute the correlation between variables. Let us see how this works.</p>
<div id="eb9f326c" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="eb9f326c"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="eb9f326c-1"><a href="#eb9f326c-1" aria-hidden="true" tabindex="-1"></a>earthquakes[[<span class="st">"Magnitude"</span>, <span class="st">"Depth"</span>]].corr()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="20">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Magnitude</th>
<th data-quarto-table-cell-role="th">Depth</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Magnitude</td>
<td>1.000000</td>
<td>0.023299</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Depth</td>
<td>0.023299</td>
<td>1.000000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>What the resulting matrix shows is the correlation between <code>Magnitude</code> and <code>Depth</code>, which is 0.023, indicating a very weak positive correlation. This means that as the magnitude of an earthquake increases, the depth of the earthquake also increases, but only very slightly.</p>
<p>We can run a similar analysis for any number of other columns, for example, let us add <code>Horizontal Error</code> to the mix.</p>
<div id="dc39fd9e" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="dc39fd9e"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="dc39fd9e-1"><a href="#dc39fd9e-1" aria-hidden="true" tabindex="-1"></a>earthquakes[[<span class="st">"Magnitude"</span>, <span class="st">"Depth"</span>, <span class="st">"Horizontal Error"</span>]].corr()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Magnitude</th>
<th data-quarto-table-cell-role="th">Depth</th>
<th data-quarto-table-cell-role="th">Horizontal Error</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Magnitude</td>
<td>1.000000</td>
<td>0.023299</td>
<td>-0.128781</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Depth</td>
<td>0.023299</td>
<td>1.000000</td>
<td>0.146771</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Horizontal Error</td>
<td>-0.128781</td>
<td>0.146771</td>
<td>1.000000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Now we see a stronger correlation between <code>Depth</code> and <code>Horizontal Error</code>, which is 0.14. This means that as the depth of an earthquake increases, the horizontal error also increases, but again not by a large factor.</p>
<p>When performing this type of analysis between multiple columns, it is interesting to visualy represent the data. One way to do this is by using a scatter plot, which shows the relationship between two variables. Let us see how this works.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
About Scatter Plots
</div>
</div>
<div class="callout-body-container callout-body">
<p>Scatter plots are a very useful tool to visualize the relationship between two variables. They can help identify patterns and trends in the data, and can be used to identify outliers or anomalies. There are many other types of plots that can be used to visualize data, such as line plots, bar plots, and box plots, which we will use as we progress.</p>
</div>
</div>
<div id="5a3b4a71" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="5a3b4a71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="5a3b4a71-1"><a href="#5a3b4a71-1" aria-hidden="true" tabindex="-1"></a>earthquakes.plot(</span>
<span id="5a3b4a71-2"><a href="#5a3b4a71-2" aria-hidden="true" tabindex="-1"></a>    kind<span class="op">=</span><span class="st">"scatter"</span>,</span>
<span id="5a3b4a71-3"><a href="#5a3b4a71-3" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="st">"Depth"</span>,</span>
<span id="5a3b4a71-4"><a href="#5a3b4a71-4" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span><span class="st">"Horizontal Error"</span>,</span>
<span id="5a3b4a71-5"><a href="#5a3b4a71-5" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">"Earthquake Depth vs. Horizontal Error"</span>,</span>
<span id="5a3b4a71-6"><a href="#5a3b4a71-6" aria-hidden="true" tabindex="-1"></a>    cmap<span class="op">=</span><span class="st">"viridis"</span>,</span>
<span id="5a3b4a71-7"><a href="#5a3b4a71-7" aria-hidden="true" tabindex="-1"></a>    c<span class="op">=</span><span class="st">"Magnitude"</span>,</span>
<span id="5a3b4a71-8"><a href="#5a3b4a71-8" aria-hidden="true" tabindex="-1"></a>    figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">6</span>),</span>
<span id="5a3b4a71-9"><a href="#5a3b4a71-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/cell-23-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img src="index_files/figure-html/cell-23-output-1.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
<p>This plot is showing a visual representation of the correlation between <code>Depth</code> and <code>Horizontal Error</code>, and colored by <code>Magnitude</code>. We can see that there is no clear relationship between the two variables, which is consistent with the correlation coefficient we calculated earlier. The <code>c</code> argument is used to color the points by the <code>Magnitude</code> column, and the <code>cmap</code> argument is used to specify the color map to use. Let us do a similar plot for <code>Depth</code> and <code>Magnitude</code>.</p>
</section>
<section id="categorical-data-and-grouping" class="level3">
<h3 class="anchored" data-anchor-id="categorical-data-and-grouping">Categorical data and grouping</h3>
<p>You will have noticed that some of the columns in the dataset are strings of text, such as <code>Type</code> and <code>Source</code>. These are called <em>categorical</em> data and can be used to group the data and perform analysis. Pandas offers a few methods to work with categorical data, such as <code>groupby</code> and <code>pivot_table</code>.</p>
<p>As an example, let us group the data by the <code>Type</code> column and calculate the average magnitude of each type of earthquake.</p>
<div id="187bec2a" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="187bec2a"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="187bec2a-1"><a href="#187bec2a-1" aria-hidden="true" tabindex="-1"></a>earthquakes.groupby(<span class="st">"Type"</span>)[<span class="st">"Magnitude"</span>].mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<pre><code>Type
Earthquake           5.882775
Explosion            5.850000
Nuclear Explosion    5.864417
Rock Burst           6.200000
Name: Magnitude, dtype: float64</code></pre>
</div>
</div>
<p>What this series shows us is the average magnitude of each type of earthquake. For example, the average magnitude of <code>Earthquake</code> is aproximately 5.88, and the average magnitude of <code>Nuclear Explosion</code> is 5.86.</p>
<p>We can also use the <code>pivot_table</code> method to group the data by multiple columns. A pivot table is a way to summarize data in a table format, and can be used to perform more complex analysis. Let us see how this works, this time by grouping the data by <code>Type</code> and <code>Source</code>.</p>
<div id="fedb024f" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="fedb024f"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="fedb024f-1"><a href="#fedb024f-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pivot Type and Magnitude</span></span>
<span id="fedb024f-2"><a href="#fedb024f-2" aria-hidden="true" tabindex="-1"></a>earthquakes.pivot_table(values<span class="op">=</span><span class="st">"Magnitude"</span>, index<span class="op">=</span>[<span class="st">"Type"</span>, <span class="st">"Source"</span>], aggfunc<span class="op">=</span><span class="st">"mean"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Magnitude</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Type</th>
<th data-quarto-table-cell-role="th">Source</th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td rowspan="12" data-quarto-table-cell-role="th" data-valign="top">Earthquake</td>
<td data-quarto-table-cell-role="th">AK</td>
<td>5.858333</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">CI</td>
<td>6.037778</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">GCMT</td>
<td>5.885455</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">ISCGEM</td>
<td>6.007805</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">ISCGEMSUP</td>
<td>6.000833</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">NC</td>
<td>6.029804</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">NN</td>
<td>5.725000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">OFFICIAL</td>
<td>8.712500</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">PR</td>
<td>5.800000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SE</td>
<td>5.800000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">US</td>
<td>5.865256</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">UW</td>
<td>5.966667</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Explosion</td>
<td data-quarto-table-cell-role="th">US</td>
<td>5.850000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Nuclear Explosion</td>
<td data-quarto-table-cell-role="th">US</td>
<td>5.864417</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Rock Burst</td>
<td data-quarto-table-cell-role="th">US</td>
<td>6.200000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>What this table shows us is the average magnitude of each type of earthquake, grouped by the source of the data, which is a more complex analysis than what we did before. A pivot table can be used to group data by multiple columns, and to perform more complex calculations, such as calculating the sum, mean, or median of a column. In the example above we used the <code>aggfunc</code> argument to specify that we want to calculate the mean of the <code>Magnitude</code> column. We could have used <code>aggfunc='median'</code> to calculate the median of the <code>Magnitude</code> column instead (<code>aggfunc</code> stands for “aggregation function”).</p>
</section>
<section id="using-dates-in-our-analysis" class="level3">
<h3 class="anchored" data-anchor-id="using-dates-in-our-analysis">Using dates in our analysis</h3>
<p>Let’s now calculate the average magnitude of the earthquakes that occurred in a given year. If you look back at the data, you will see that the <code>Date</code> column contains the date and time of each earthquake. We can use this column to select a given year, and then calculate the average magnitude of the earthquakes that occurred in that year.</p>
<p>Notice however the <code>Date</code> format is an <code>object</code> type, which means that it is a string. We need to convert it to a <code>datetime</code> object to be able to extract the year. We can do this with the <code>to_datetime</code> method.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
About <code>datetime</code> Objects
</div>
</div>
<div class="callout-body-container callout-body">
<p><code>datetime</code> objects are a very useful data type in Python, and Pandas offers a lot of functionality to work with them. You will come across them frequently when working with time series data, and it is good to be familiar with them.</p>
</div>
</div>
<div id="7bb270d5" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="7bb270d5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="7bb270d5-1"><a href="#7bb270d5-1" aria-hidden="true" tabindex="-1"></a>earthquakes[<span class="st">"Date"</span>] <span class="op">=</span> pd.to_datetime(</span>
<span id="7bb270d5-2"><a href="#7bb270d5-2" aria-hidden="true" tabindex="-1"></a>    earthquakes[<span class="st">"Date"</span>], <span class="bu">format</span><span class="op">=</span><span class="st">"%m/</span><span class="sc">%d</span><span class="st">/%Y"</span>, errors<span class="op">=</span><span class="st">"coerce"</span></span>
<span id="7bb270d5-3"><a href="#7bb270d5-3" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The above looks a bit special, but it is actually quite simple. We are using the <code>to_datetime</code> method of the Pandas library to convert dates formated as ‘month/day/year’ (commonly used in the United States, unlike ‘day/month/year’ used in Europe) to a <code>datetime</code> object, with <code>errors='coerce'</code> instructing the method to return <code>NaT</code> (Not a Time) for any dates that cannot be converted.</p>
<p>Now let us extract the year from the <code>Date</code> column, and add it as a new column to the dataframe.</p>
<div id="32cb82d9" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="32cb82d9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="32cb82d9-1"><a href="#32cb82d9-1" aria-hidden="true" tabindex="-1"></a>earthquakes[<span class="st">"Year"</span>] <span class="op">=</span> earthquakes[<span class="st">"Date"</span>].dt.year</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The above code uses the <code>dt</code> accessor to access the <code>year</code> attribute of the <code>Date</code> column, and then assigns it to a new column named <code>Year</code>.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
About Accessors
</div>
</div>
<div class="callout-body-container callout-body">
<p>An accessor is a way to access the elements of a data structure. In this case, the <code>dt</code> accessor is used to access the elements of a <code>datetime</code> object, such as the year, month, day, etc. Accessors are useful when working with data structures that contain complex data types, such as <code>datetime</code> objects.</p>
</div>
</div>
<p>We can now check the dataframe to see if the <code>Year</code> column was added.</p>
<div id="94d1ec38" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="94d1ec38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="94d1ec38-1"><a href="#94d1ec38-1" aria-hidden="true" tabindex="-1"></a>earthquakes[<span class="st">"Year"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="27">
<pre><code>0        1965.0
1        1965.0
2        1965.0
3        1965.0
4        1965.0
          ...  
23384    2016.0
23385    2016.0
23386    2016.0
23387    2016.0
23388    2016.0
Name: Year, Length: 23389, dtype: float64</code></pre>
</div>
</div>
<p>Worked! Did you notice however that the <code>Year</code> column is a <code>float</code> ? This is because the <code>dt.year</code> accessor returns a <code>float</code> type. We can convert it to an <code>int</code> type just to make it look nicer, but also because it makes more sense to have years as integers. We do this with the <code>astype</code> method.</p>
<div id="0224752c" class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="0224752c"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="0224752c-1"><a href="#0224752c-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fill NaN values before converting</span></span>
<span id="0224752c-2"><a href="#0224752c-2" aria-hidden="true" tabindex="-1"></a>earthquakes[<span class="st">"Year"</span>] <span class="op">=</span> earthquakes[<span class="st">"Year"</span>].fillna(<span class="dv">0</span>).astype(<span class="bu">int</span>)</span>
<span id="0224752c-3"><a href="#0224752c-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="0224752c-4"><a href="#0224752c-4" aria-hidden="true" tabindex="-1"></a>earthquakes[<span class="st">"Year"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="28">
<pre><code>0        1965
1        1965
2        1965
3        1965
4        1965
         ... 
23384    2016
23385    2016
23386    2016
23387    2016
23388    2016
Name: Year, Length: 23389, dtype: int64</code></pre>
</div>
</div>
<p>Now that we have a <code>Year</code> column, we can calculate the average magnitude of the earthquakes that occurred in a given year.</p>
<div id="4419809c" class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="4419809c"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="4419809c-1"><a href="#4419809c-1" aria-hidden="true" tabindex="-1"></a>earthquakes[earthquakes[<span class="st">"Year"</span>] <span class="op">==</span> <span class="dv">1972</span>][<span class="st">"Magnitude"</span>].mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="29">
<pre><code>5.943814432989692</code></pre>
</div>
</div>
<p>Great! We can even plot some of this data in interesting ways using the <code>matplotlib</code> library. Let us see how to do this.</p>
<div id="319c6ea9" class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="319c6ea9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="319c6ea9-1"><a href="#319c6ea9-1" aria-hidden="true" tabindex="-1"></a>earthquakes[earthquakes[<span class="st">"Year"</span>] <span class="op">==</span> <span class="dv">1972</span>].plot(</span>
<span id="319c6ea9-2"><a href="#319c6ea9-2" aria-hidden="true" tabindex="-1"></a>    kind<span class="op">=</span><span class="st">"scatter"</span>,</span>
<span id="319c6ea9-3"><a href="#319c6ea9-3" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="st">"Date"</span>,</span>
<span id="319c6ea9-4"><a href="#319c6ea9-4" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span><span class="st">"Magnitude"</span>,</span>
<span id="319c6ea9-5"><a href="#319c6ea9-5" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">"Earthquakes in 1972"</span>,</span>
<span id="319c6ea9-6"><a href="#319c6ea9-6" aria-hidden="true" tabindex="-1"></a>    colormap<span class="op">=</span><span class="st">"rainbow"</span>,</span>
<span id="319c6ea9-7"><a href="#319c6ea9-7" aria-hidden="true" tabindex="-1"></a>    c<span class="op">=</span><span class="st">"Depth"</span>,</span>
<span id="319c6ea9-8"><a href="#319c6ea9-8" aria-hidden="true" tabindex="-1"></a>    figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">6</span>),</span>
<span id="319c6ea9-9"><a href="#319c6ea9-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/cell-31-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img src="index_files/figure-html/cell-31-output-1.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
<p>Here we are plotting the Date vs the Magnitude of the earthquakes. The <code>plot</code> method is used to create the plot, and the <code>scatter</code> plot kind is used to create a scatter plot. The <code>c</code> argument is used to color the points by the <code>Depth</code> column, and the <code>cmap</code> argument is used to specify the color map to use. The <code>x</code> and <code>y</code> attributes are used to set the columns for the x and y axes, and the <code>title</code> method is used to set the title of the plot.</p>
<p>We can also use the <code>plot</code> method to create a line plot, which shows the relationship between two variables over time. We could for example plot the average magnitude of earthquakes over time by aggregating the data by a given time period.</p>
<div id="8e72ae74" class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="8e72ae74"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="8e72ae74-1"><a href="#8e72ae74-1" aria-hidden="true" tabindex="-1"></a>avg_magnitude_per_year <span class="op">=</span> earthquakes.resample(rule<span class="op">=</span><span class="st">"YE"</span>, on<span class="op">=</span><span class="st">"Date"</span>)[<span class="st">"Magnitude"</span>].mean()</span>
<span id="8e72ae74-2"><a href="#8e72ae74-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="8e72ae74-3"><a href="#8e72ae74-3" aria-hidden="true" tabindex="-1"></a>avg_magnitude_per_year.plot(</span>
<span id="8e72ae74-4"><a href="#8e72ae74-4" aria-hidden="true" tabindex="-1"></a>    kind<span class="op">=</span><span class="st">"line"</span>,</span>
<span id="8e72ae74-5"><a href="#8e72ae74-5" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">"Average Earthquake Magnitude per Year"</span>,</span>
<span id="8e72ae74-6"><a href="#8e72ae74-6" aria-hidden="true" tabindex="-1"></a>    ylabel<span class="op">=</span><span class="st">"Average Magnitude"</span>,</span>
<span id="8e72ae74-7"><a href="#8e72ae74-7" aria-hidden="true" tabindex="-1"></a>    figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">6</span>),</span>
<span id="8e72ae74-8"><a href="#8e72ae74-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/cell-32-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img src="index_files/figure-html/cell-32-output-1.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
<p>In the above code, we are taking a few steps:</p>
<ul>
<li>We are resampling the data by year using the <code>resample</code> method (<code>rule='YE'</code> means that we are resampling by year).</li>
<li>We are calculating the mean of the <code>Magnitude</code> column for each year using the <code>mean</code> method.</li>
<li>We then use the <code>plot</code> method to create a line plot of the data.</li>
</ul>
<p>To make this clearer, let us show the calculated <code>avg_magnitude_per_year</code> series for the first five years.</p>
<div id="53cd596a" class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="53cd596a"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="53cd596a-1"><a href="#53cd596a-1" aria-hidden="true" tabindex="-1"></a>avg_magnitude_per_year.head(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="32">
<pre><code>Date
1965-12-31    6.014159
1966-12-31    6.040948
1967-12-31    6.003922
1968-12-31    6.081848
1969-12-31    6.009938
Name: Magnitude, dtype: float64</code></pre>
</div>
</div>
</section>
<section id="using-geographical-data-effectively" class="level3">
<h3 class="anchored" data-anchor-id="using-geographical-data-effectively">Using geographical data effectively</h3>
<p>You will have noticed (hopefully) that the dataset contains geographical data in the form of <code>Latitude</code> and <code>Longitude</code>. This data can be used to create maps and to perform spatial analysis. For example, we could create a map of the earthquakes in the dataset, or we could filter out the earthquakes that occurred in a given region of the planet.</p>
<p>Let us take a simple example, and filter out the earthquakes that occurred around the region of the Azores islands. We will consider the region to be between 36 and 42 degrees latitude, and between -31 and -24 degrees longitude.</p>
<div id="92852822" class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="92852822"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="92852822-1"><a href="#92852822-1" aria-hidden="true" tabindex="-1"></a>azores_earthquakes <span class="op">=</span> earthquakes[</span>
<span id="92852822-2"><a href="#92852822-2" aria-hidden="true" tabindex="-1"></a>    earthquakes[<span class="st">"Latitude"</span>].between(<span class="dv">36</span>, <span class="dv">42</span>) <span class="op">&amp;</span> earthquakes[<span class="st">"Longitude"</span>].between(<span class="op">-</span><span class="dv">31</span>, <span class="op">-</span><span class="dv">24</span>)</span>
<span id="92852822-3"><a href="#92852822-3" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="92852822-4"><a href="#92852822-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="92852822-5"><a href="#92852822-5" aria-hidden="true" tabindex="-1"></a>azores_earthquakes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="33">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Date</th>
<th data-quarto-table-cell-role="th">Time</th>
<th data-quarto-table-cell-role="th">Latitude</th>
<th data-quarto-table-cell-role="th">Longitude</th>
<th data-quarto-table-cell-role="th">Type</th>
<th data-quarto-table-cell-role="th">Depth</th>
<th data-quarto-table-cell-role="th">Depth Error</th>
<th data-quarto-table-cell-role="th">Depth Seismic Stations</th>
<th data-quarto-table-cell-role="th">Magnitude</th>
<th data-quarto-table-cell-role="th">Magnitude Type</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">Azimuthal Gap</th>
<th data-quarto-table-cell-role="th">Horizontal Distance</th>
<th data-quarto-table-cell-role="th">Horizontal Error</th>
<th data-quarto-table-cell-role="th">Root Mean Square</th>
<th data-quarto-table-cell-role="th">ID</th>
<th data-quarto-table-cell-role="th">Source</th>
<th data-quarto-table-cell-role="th">Location Source</th>
<th data-quarto-table-cell-role="th">Magnitude Source</th>
<th data-quarto-table-cell-role="th">Status</th>
<th data-quarto-table-cell-role="th">Year</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">5381</td>
<td>1980-01-01</td>
<td>16:42:40</td>
<td>38.815</td>
<td>-27.780</td>
<td>Earthquake</td>
<td>10.0</td>
<td>NaN</td>
<td>NaN</td>
<td>6.7</td>
<td>MS</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>USP00014TU</td>
<td>US</td>
<td>US</td>
<td>US</td>
<td>Reviewed</td>
<td>1980</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9065</td>
<td>1988-07-22</td>
<td>21:16:04</td>
<td>39.862</td>
<td>-29.589</td>
<td>Earthquake</td>
<td>10.0</td>
<td>NaN</td>
<td>NaN</td>
<td>5.5</td>
<td>MW</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1.00</td>
<td>USP0003J40</td>
<td>US</td>
<td>US</td>
<td>HRV</td>
<td>Reviewed</td>
<td>1988</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">9230</td>
<td>1988-11-21</td>
<td>16:55:53</td>
<td>37.938</td>
<td>-26.142</td>
<td>Earthquake</td>
<td>10.8</td>
<td>2.9</td>
<td>NaN</td>
<td>5.9</td>
<td>MW</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.90</td>
<td>USP0003P1Z</td>
<td>US</td>
<td>US</td>
<td>HRV</td>
<td>Reviewed</td>
<td>1988</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9301</td>
<td>1989-01-21</td>
<td>02:52:20</td>
<td>38.147</td>
<td>-26.243</td>
<td>Earthquake</td>
<td>10.0</td>
<td>NaN</td>
<td>NaN</td>
<td>5.7</td>
<td>MW</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.80</td>
<td>USP0003R1R</td>
<td>US</td>
<td>US</td>
<td>HRV</td>
<td>Reviewed</td>
<td>1989</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">9512</td>
<td>1989-06-26</td>
<td>10:38:39</td>
<td>39.112</td>
<td>-28.242</td>
<td>Earthquake</td>
<td>11.3</td>
<td>NaN</td>
<td>NaN</td>
<td>5.9</td>
<td>MW</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1.10</td>
<td>USP0003WP5</td>
<td>US</td>
<td>US</td>
<td>NC</td>
<td>Reviewed</td>
<td>1989</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">12920</td>
<td>1996-03-09</td>
<td>22:35:38</td>
<td>37.034</td>
<td>-24.374</td>
<td>Earthquake</td>
<td>10.0</td>
<td>NaN</td>
<td>NaN</td>
<td>5.7</td>
<td>MWC</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1.20</td>
<td>USP0007EJ0</td>
<td>US</td>
<td>US</td>
<td>HRV</td>
<td>Reviewed</td>
<td>1996</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">13564</td>
<td>1997-06-27</td>
<td>04:39:53</td>
<td>38.334</td>
<td>-26.684</td>
<td>Earthquake</td>
<td>10.0</td>
<td>NaN</td>
<td>NaN</td>
<td>5.9</td>
<td>MWC</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1.09</td>
<td>USP0008416</td>
<td>US</td>
<td>US</td>
<td>HRV</td>
<td>Reviewed</td>
<td>1997</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">14010</td>
<td>1998-07-09</td>
<td>05:19:07</td>
<td>38.650</td>
<td>-28.626</td>
<td>Earthquake</td>
<td>10.0</td>
<td>NaN</td>
<td>NaN</td>
<td>6.2</td>
<td>MWB</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.98</td>
<td>USP0008R70</td>
<td>US</td>
<td>US</td>
<td>US</td>
<td>Reviewed</td>
<td>1998</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16548</td>
<td>2003-12-23</td>
<td>14:02:04</td>
<td>40.135</td>
<td>-29.692</td>
<td>Earthquake</td>
<td>10.0</td>
<td>NaN</td>
<td>282.0</td>
<td>5.6</td>
<td>MWC</td>
<td>...</td>
<td>60.8</td>
<td>NaN</td>
<td>NaN</td>
<td>0.91</td>
<td>USP000CFW0</td>
<td>US</td>
<td>US</td>
<td>HRV</td>
<td>Reviewed</td>
<td>2003</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">18364</td>
<td>2007-04-05</td>
<td>03:56:50</td>
<td>37.306</td>
<td>-24.621</td>
<td>Earthquake</td>
<td>14.0</td>
<td>NaN</td>
<td>627.0</td>
<td>6.3</td>
<td>MWC</td>
<td>...</td>
<td>23.5</td>
<td>NaN</td>
<td>NaN</td>
<td>0.82</td>
<td>USP000F8R5</td>
<td>US</td>
<td>US</td>
<td>GCMT</td>
<td>Reviewed</td>
<td>2007</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">18369</td>
<td>2007-04-07</td>
<td>07:09:25</td>
<td>37.306</td>
<td>-24.494</td>
<td>Earthquake</td>
<td>8.0</td>
<td>NaN</td>
<td>645.0</td>
<td>6.1</td>
<td>MWC</td>
<td>...</td>
<td>19.5</td>
<td>NaN</td>
<td>NaN</td>
<td>0.95</td>
<td>USP000F8YJ</td>
<td>US</td>
<td>US</td>
<td>GCMT</td>
<td>Reviewed</td>
<td>2007</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">21706</td>
<td>2013-04-30</td>
<td>06:25:23</td>
<td>37.592</td>
<td>-24.913</td>
<td>Earthquake</td>
<td>10.0</td>
<td>NaN</td>
<td>599.0</td>
<td>5.9</td>
<td>MWW</td>
<td>...</td>
<td>27.3</td>
<td>NaN</td>
<td>NaN</td>
<td>0.77</td>
<td>US2013PQAF</td>
<td>US</td>
<td>US</td>
<td>US</td>
<td>Reviewed</td>
<td>2013</td>
</tr>
</tbody>
</table>

<p>12 rows × 22 columns</p>
</div>
</div>
</div>
<p>The above code should be self explanatory - we are filtering the dataframe by selecting the rows where the <code>Latitude</code> is between 36 and 42 degrees, and (the symbol <code>&amp;</code> means “and”) the <code>Longitude</code> is between -31 and -24 degrees. Now that we have the list, let us calculate the minimum, maximum, and average magnitude of the earthquakes that occurred in this region.</p>
<div id="308205b8" class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="308205b8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="308205b8-1"><a href="#308205b8-1" aria-hidden="true" tabindex="-1"></a>azores_min_magnitude <span class="op">=</span> azores_earthquakes[<span class="st">"Magnitude"</span>].<span class="bu">min</span>()</span>
<span id="308205b8-2"><a href="#308205b8-2" aria-hidden="true" tabindex="-1"></a>azores_max_magnitude <span class="op">=</span> azores_earthquakes[<span class="st">"Magnitude"</span>].<span class="bu">max</span>()</span>
<span id="308205b8-3"><a href="#308205b8-3" aria-hidden="true" tabindex="-1"></a>azores_mean_magnitude <span class="op">=</span> azores_earthquakes[<span class="st">"Magnitude"</span>].mean()</span>
<span id="308205b8-4"><a href="#308205b8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="308205b8-5"><a href="#308205b8-5" aria-hidden="true" tabindex="-1"></a>azores_min_magnitude, azores_max_magnitude, azores_mean_magnitude</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="34">
<pre><code>(5.5, 6.7, 5.95)</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
About Box Plots
</div>
</div>
<div class="callout-body-container callout-body">
<p>There’s a neat type of plot called a <code>boxplot</code> that can be used to visualize the distribution of data. It shows the median, quartiles, and outliers of the data. We don’t need to go into the details of how it works for now, but it is useful to know that it exists and that it can be used to visualize the distribution of a given column.</p>
</div>
</div>
<div id="5d6a1f49" class="cell" data-tags="[&quot;hide-input&quot;]" data-execution_count="36">
<div class="sourceCode cell-code" id="5d6a1f49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="5d6a1f49-1"><a href="#5d6a1f49-1" aria-hidden="true" tabindex="-1"></a>azores_earthquakes[<span class="st">"Magnitude"</span>].plot(</span>
<span id="5d6a1f49-2"><a href="#5d6a1f49-2" aria-hidden="true" tabindex="-1"></a>    kind<span class="op">=</span><span class="st">"box"</span>,</span>
<span id="5d6a1f49-3"><a href="#5d6a1f49-3" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">"Azores Earthquakes Magnitude Distribution"</span>,</span>
<span id="5d6a1f49-4"><a href="#5d6a1f49-4" aria-hidden="true" tabindex="-1"></a>    figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">6</span>),</span>
<span id="5d6a1f49-5"><a href="#5d6a1f49-5" aria-hidden="true" tabindex="-1"></a>    vert<span class="op">=</span><span class="va">False</span>,</span>
<span id="5d6a1f49-6"><a href="#5d6a1f49-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="5d6a1f49-7"><a href="#5d6a1f49-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="5d6a1f49-8"><a href="#5d6a1f49-8" aria-hidden="true" tabindex="-1"></a>plt.text(</span>
<span id="5d6a1f49-9"><a href="#5d6a1f49-9" aria-hidden="true" tabindex="-1"></a>    azores_min_magnitude,</span>
<span id="5d6a1f49-10"><a href="#5d6a1f49-10" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>,</span>
<span id="5d6a1f49-11"><a href="#5d6a1f49-11" aria-hidden="true" tabindex="-1"></a>    <span class="ss">f"Min: </span><span class="sc">{</span>azores_min_magnitude<span class="sc">:.2f}</span><span class="ss">"</span>,</span>
<span id="5d6a1f49-12"><a href="#5d6a1f49-12" aria-hidden="true" tabindex="-1"></a>    va<span class="op">=</span><span class="st">"center"</span>,</span>
<span id="5d6a1f49-13"><a href="#5d6a1f49-13" aria-hidden="true" tabindex="-1"></a>    ha<span class="op">=</span><span class="st">"left"</span>,</span>
<span id="5d6a1f49-14"><a href="#5d6a1f49-14" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span><span class="st">"blue"</span>,</span>
<span id="5d6a1f49-15"><a href="#5d6a1f49-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="5d6a1f49-16"><a href="#5d6a1f49-16" aria-hidden="true" tabindex="-1"></a>plt.text(</span>
<span id="5d6a1f49-17"><a href="#5d6a1f49-17" aria-hidden="true" tabindex="-1"></a>    azores_max_magnitude,</span>
<span id="5d6a1f49-18"><a href="#5d6a1f49-18" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>,</span>
<span id="5d6a1f49-19"><a href="#5d6a1f49-19" aria-hidden="true" tabindex="-1"></a>    <span class="ss">f"Max: </span><span class="sc">{</span>azores_max_magnitude<span class="sc">:.2f}</span><span class="ss">"</span>,</span>
<span id="5d6a1f49-20"><a href="#5d6a1f49-20" aria-hidden="true" tabindex="-1"></a>    va<span class="op">=</span><span class="st">"center"</span>,</span>
<span id="5d6a1f49-21"><a href="#5d6a1f49-21" aria-hidden="true" tabindex="-1"></a>    ha<span class="op">=</span><span class="st">"right"</span>,</span>
<span id="5d6a1f49-22"><a href="#5d6a1f49-22" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span><span class="st">"red"</span>,</span>
<span id="5d6a1f49-23"><a href="#5d6a1f49-23" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="5d6a1f49-24"><a href="#5d6a1f49-24" aria-hidden="true" tabindex="-1"></a>plt.text(</span>
<span id="5d6a1f49-25"><a href="#5d6a1f49-25" aria-hidden="true" tabindex="-1"></a>    azores_mean_magnitude,</span>
<span id="5d6a1f49-26"><a href="#5d6a1f49-26" aria-hidden="true" tabindex="-1"></a>    <span class="fl">1.1</span>,</span>
<span id="5d6a1f49-27"><a href="#5d6a1f49-27" aria-hidden="true" tabindex="-1"></a>    <span class="ss">f"Mean: </span><span class="sc">{</span>azores_mean_magnitude<span class="sc">:.2f}</span><span class="ss">"</span>,</span>
<span id="5d6a1f49-28"><a href="#5d6a1f49-28" aria-hidden="true" tabindex="-1"></a>    va<span class="op">=</span><span class="st">"center"</span>,</span>
<span id="5d6a1f49-29"><a href="#5d6a1f49-29" aria-hidden="true" tabindex="-1"></a>    ha<span class="op">=</span><span class="st">"center"</span>,</span>
<span id="5d6a1f49-30"><a href="#5d6a1f49-30" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span><span class="st">"green"</span>,</span>
<span id="5d6a1f49-31"><a href="#5d6a1f49-31" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="5d6a1f49-32"><a href="#5d6a1f49-32" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/cell-36-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6"><img src="index_files/figure-html/cell-36-output-1.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
<p>Because we have a small dataset, we can also plot the earthquakes on a map. For this we will use the <code>folium</code> library which we can install with the <code>conda</code> command (by now you should be able to do this without further instruction).</p>
<div id="67409768" class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="67409768"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="67409768-1"><a href="#67409768-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> folium</span>
<span id="67409768-2"><a href="#67409768-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="67409768-3"><a href="#67409768-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a map centered around the Azores</span></span>
<span id="67409768-4"><a href="#67409768-4" aria-hidden="true" tabindex="-1"></a>azores_map <span class="op">=</span> folium.Map(location<span class="op">=</span>[<span class="dv">38</span>, <span class="op">-</span><span class="dv">28</span>], zoom_start<span class="op">=</span><span class="fl">6.5</span>)</span>
<span id="67409768-5"><a href="#67409768-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="67409768-6"><a href="#67409768-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Add markers for each earthquake</span></span>
<span id="67409768-7"><a href="#67409768-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> _, row <span class="kw">in</span> azores_earthquakes.iterrows():</span>
<span id="67409768-8"><a href="#67409768-8" aria-hidden="true" tabindex="-1"></a>    folium.CircleMarker(</span>
<span id="67409768-9"><a href="#67409768-9" aria-hidden="true" tabindex="-1"></a>        location<span class="op">=</span>[row[<span class="st">"Latitude"</span>], row[<span class="st">"Longitude"</span>]],</span>
<span id="67409768-10"><a href="#67409768-10" aria-hidden="true" tabindex="-1"></a>        radius<span class="op">=</span>row[<span class="st">"Magnitude"</span>],  <span class="co"># Scale the circle size by magnitude</span></span>
<span id="67409768-11"><a href="#67409768-11" aria-hidden="true" tabindex="-1"></a>        color<span class="op">=</span><span class="st">"blue"</span>,</span>
<span id="67409768-12"><a href="#67409768-12" aria-hidden="true" tabindex="-1"></a>        fill<span class="op">=</span><span class="va">True</span>,</span>
<span id="67409768-13"><a href="#67409768-13" aria-hidden="true" tabindex="-1"></a>        fill_opacity<span class="op">=</span><span class="fl">0.3</span>,</span>
<span id="67409768-14"><a href="#67409768-14" aria-hidden="true" tabindex="-1"></a>        popup<span class="op">=</span><span class="ss">f"Year: </span><span class="sc">{</span><span class="bu">int</span>(row[<span class="st">'Year'</span>])<span class="sc">}</span><span class="ss"> Magnitude: </span><span class="sc">{</span>row[<span class="st">'Magnitude'</span>]<span class="sc">}</span><span class="ss">, Depth: </span><span class="sc">{</span>row[<span class="st">'Depth'</span>]<span class="sc">}</span><span class="ss"> km"</span>,</span>
<span id="67409768-15"><a href="#67409768-15" aria-hidden="true" tabindex="-1"></a>    ).add_to(azores_map)</span>
<span id="67409768-16"><a href="#67409768-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="67409768-17"><a href="#67409768-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the map</span></span>
<span id="67409768-18"><a href="#67409768-18" aria-hidden="true" tabindex="-1"></a>azores_map</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="36">
<div style="width:100%;"><div style="position:relative;width:100%;height:0;padding-bottom:60%;"><span style="color:#565656">Make this Notebook Trusted to load map: File -&gt; Trust Notebook</span><iframe srcdoc="<!DOCTYPE html>
<html>
<head>
    
    <meta http-equiv=&quot;content-type&quot; content=&quot;text/html; charset=UTF-8&quot; />
    
        <script>
            L_NO_TOUCH = false;
            L_DISABLE_3D = false;
        </script>
    
    <style>html, body {width: 100%;height: 100%;margin: 0;padding: 0;}</style>
    <style>#map {position:absolute;top:0;bottom:0;right:0;left:0;}</style>
    <script src=&quot;https://cdn.jsdelivr.net/npm/leaflet@1.9.3/dist/leaflet.js&quot;></script>
    <script src=&quot;https://code.jquery.com/jquery-3.7.1.min.js&quot;></script>
    <script src=&quot;https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js&quot;></script>
    <script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/Leaflet.awesome-markers/2.0.2/leaflet.awesome-markers.js&quot;></script>
    <link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/npm/leaflet@1.9.3/dist/leaflet.css&quot;/>
    <link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css&quot;/>
    <link rel=&quot;stylesheet&quot; href=&quot;https://netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap-glyphicons.css&quot;/>
    <link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.2.0/css/all.min.css&quot;/>
    <link rel=&quot;stylesheet&quot; href=&quot;https://cdnjs.cloudflare.com/ajax/libs/Leaflet.awesome-markers/2.0.2/leaflet.awesome-markers.css&quot;/>
    <link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/gh/python-visualization/folium/folium/templates/leaflet.awesome.rotate.min.css&quot;/>
    
            <meta name=&quot;viewport&quot; content=&quot;width=device-width,
                initial-scale=1.0, maximum-scale=1.0, user-scalable=no&quot; />
            <style>
                #map_d0465e53d4a5e8e5172c1ef0019ec0d0 {
                    position: relative;
                    width: 100.0%;
                    height: 100.0%;
                    left: 0.0%;
                    top: 0.0%;
                }
                .leaflet-container { font-size: 1rem; }
            </style>
        
</head>
<body>
    
    
            <div class=&quot;folium-map&quot; id=&quot;map_d0465e53d4a5e8e5172c1ef0019ec0d0&quot; ></div>
        
</body>
<script>
    
    
            var map_d0465e53d4a5e8e5172c1ef0019ec0d0 = L.map(
                &quot;map_d0465e53d4a5e8e5172c1ef0019ec0d0&quot;,
                {
                    center: [38.0, -28.0],
                    crs: L.CRS.EPSG3857,
                    ...{
  &quot;zoom&quot;: 6.5,
  &quot;zoomControl&quot;: true,
  &quot;preferCanvas&quot;: false,
}

                }
            );

            

        
    
            var tile_layer_4c8fcf93f95ba32f1130e52df2aa4600 = L.tileLayer(
                &quot;https://tile.openstreetmap.org/{z}/{x}/{y}.png&quot;,
                {
  &quot;minZoom&quot;: 0,
  &quot;maxZoom&quot;: 19,
  &quot;maxNativeZoom&quot;: 19,
  &quot;noWrap&quot;: false,
  &quot;attribution&quot;: &quot;\u0026copy; \u003ca href=\&quot;https://www.openstreetmap.org/copyright\&quot;\u003eOpenStreetMap\u003c/a\u003e contributors&quot;,
  &quot;subdomains&quot;: &quot;abc&quot;,
  &quot;detectRetina&quot;: false,
  &quot;tms&quot;: false,
  &quot;opacity&quot;: 1,
}

            );
        
    
            tile_layer_4c8fcf93f95ba32f1130e52df2aa4600.addTo(map_d0465e53d4a5e8e5172c1ef0019ec0d0);
        
    
            var circle_marker_552bedb8e53bb087c06a3c6f497117ef = L.circleMarker(
                [38.815, -27.78],
                {&quot;bubblingMouseEvents&quot;: true, &quot;color&quot;: &quot;blue&quot;, &quot;dashArray&quot;: null, &quot;dashOffset&quot;: null, &quot;fill&quot;: true, &quot;fillColor&quot;: &quot;blue&quot;, &quot;fillOpacity&quot;: 0.3, &quot;fillRule&quot;: &quot;evenodd&quot;, &quot;lineCap&quot;: &quot;round&quot;, &quot;lineJoin&quot;: &quot;round&quot;, &quot;opacity&quot;: 1.0, &quot;radius&quot;: 6.7, &quot;stroke&quot;: true, &quot;weight&quot;: 3}
            ).addTo(map_d0465e53d4a5e8e5172c1ef0019ec0d0);
        
    
        var popup_583927a385d65902fcfb9b9798d478b1 = L.popup({
  &quot;maxWidth&quot;: &quot;100%&quot;,
});

        
            
                var html_cd5a7d8e15430e24b5da1a5641f0de8d = $(`<div id=&quot;html_cd5a7d8e15430e24b5da1a5641f0de8d&quot; style=&quot;width: 100.0%; height: 100.0%;&quot;>Year: 1980 Magnitude: 6.7, Depth: 10.0 km</div>`)[0];
                popup_583927a385d65902fcfb9b9798d478b1.setContent(html_cd5a7d8e15430e24b5da1a5641f0de8d);
            
        

        circle_marker_552bedb8e53bb087c06a3c6f497117ef.bindPopup(popup_583927a385d65902fcfb9b9798d478b1)
        ;

        
    
    
            var circle_marker_b04151f34b6b87754bdf9423fba9805e = L.circleMarker(
                [39.862, -29.589],
                {&quot;bubblingMouseEvents&quot;: true, &quot;color&quot;: &quot;blue&quot;, &quot;dashArray&quot;: null, &quot;dashOffset&quot;: null, &quot;fill&quot;: true, &quot;fillColor&quot;: &quot;blue&quot;, &quot;fillOpacity&quot;: 0.3, &quot;fillRule&quot;: &quot;evenodd&quot;, &quot;lineCap&quot;: &quot;round&quot;, &quot;lineJoin&quot;: &quot;round&quot;, &quot;opacity&quot;: 1.0, &quot;radius&quot;: 5.5, &quot;stroke&quot;: true, &quot;weight&quot;: 3}
            ).addTo(map_d0465e53d4a5e8e5172c1ef0019ec0d0);
        
    
        var popup_51894e4d1d9c7e88ece4c8a1f505b919 = L.popup({
  &quot;maxWidth&quot;: &quot;100%&quot;,
});

        
            
                var html_0e18ecdfce53435de754c3133f130a3f = $(`<div id=&quot;html_0e18ecdfce53435de754c3133f130a3f&quot; style=&quot;width: 100.0%; height: 100.0%;&quot;>Year: 1988 Magnitude: 5.5, Depth: 10.0 km</div>`)[0];
                popup_51894e4d1d9c7e88ece4c8a1f505b919.setContent(html_0e18ecdfce53435de754c3133f130a3f);
            
        

        circle_marker_b04151f34b6b87754bdf9423fba9805e.bindPopup(popup_51894e4d1d9c7e88ece4c8a1f505b919)
        ;

        
    
    
            var circle_marker_bcf8873395882fa7c4b4940663ad932a = L.circleMarker(
                [37.938, -26.142],
                {&quot;bubblingMouseEvents&quot;: true, &quot;color&quot;: &quot;blue&quot;, &quot;dashArray&quot;: null, &quot;dashOffset&quot;: null, &quot;fill&quot;: true, &quot;fillColor&quot;: &quot;blue&quot;, &quot;fillOpacity&quot;: 0.3, &quot;fillRule&quot;: &quot;evenodd&quot;, &quot;lineCap&quot;: &quot;round&quot;, &quot;lineJoin&quot;: &quot;round&quot;, &quot;opacity&quot;: 1.0, &quot;radius&quot;: 5.9, &quot;stroke&quot;: true, &quot;weight&quot;: 3}
            ).addTo(map_d0465e53d4a5e8e5172c1ef0019ec0d0);
        
    
        var popup_712595b7370f1e66107a1d74de606f65 = L.popup({
  &quot;maxWidth&quot;: &quot;100%&quot;,
});

        
            
                var html_d15903d1dd625ecd054054fc382f9c9e = $(`<div id=&quot;html_d15903d1dd625ecd054054fc382f9c9e&quot; style=&quot;width: 100.0%; height: 100.0%;&quot;>Year: 1988 Magnitude: 5.9, Depth: 10.8 km</div>`)[0];
                popup_712595b7370f1e66107a1d74de606f65.setContent(html_d15903d1dd625ecd054054fc382f9c9e);
            
        

        circle_marker_bcf8873395882fa7c4b4940663ad932a.bindPopup(popup_712595b7370f1e66107a1d74de606f65)
        ;

        
    
    
            var circle_marker_4469ba1a7f6794d8b75c342e4093e469 = L.circleMarker(
                [38.147, -26.243],
                {&quot;bubblingMouseEvents&quot;: true, &quot;color&quot;: &quot;blue&quot;, &quot;dashArray&quot;: null, &quot;dashOffset&quot;: null, &quot;fill&quot;: true, &quot;fillColor&quot;: &quot;blue&quot;, &quot;fillOpacity&quot;: 0.3, &quot;fillRule&quot;: &quot;evenodd&quot;, &quot;lineCap&quot;: &quot;round&quot;, &quot;lineJoin&quot;: &quot;round&quot;, &quot;opacity&quot;: 1.0, &quot;radius&quot;: 5.7, &quot;stroke&quot;: true, &quot;weight&quot;: 3}
            ).addTo(map_d0465e53d4a5e8e5172c1ef0019ec0d0);
        
    
        var popup_7df37d604238f754b1ee9199855e5046 = L.popup({
  &quot;maxWidth&quot;: &quot;100%&quot;,
});

        
            
                var html_8ff3f1e2f3f8f4917eec4c6a51b3ae91 = $(`<div id=&quot;html_8ff3f1e2f3f8f4917eec4c6a51b3ae91&quot; style=&quot;width: 100.0%; height: 100.0%;&quot;>Year: 1989 Magnitude: 5.7, Depth: 10.0 km</div>`)[0];
                popup_7df37d604238f754b1ee9199855e5046.setContent(html_8ff3f1e2f3f8f4917eec4c6a51b3ae91);
            
        

        circle_marker_4469ba1a7f6794d8b75c342e4093e469.bindPopup(popup_7df37d604238f754b1ee9199855e5046)
        ;

        
    
    
            var circle_marker_87d1886c36162921604da16d4441b690 = L.circleMarker(
                [39.112, -28.242],
                {&quot;bubblingMouseEvents&quot;: true, &quot;color&quot;: &quot;blue&quot;, &quot;dashArray&quot;: null, &quot;dashOffset&quot;: null, &quot;fill&quot;: true, &quot;fillColor&quot;: &quot;blue&quot;, &quot;fillOpacity&quot;: 0.3, &quot;fillRule&quot;: &quot;evenodd&quot;, &quot;lineCap&quot;: &quot;round&quot;, &quot;lineJoin&quot;: &quot;round&quot;, &quot;opacity&quot;: 1.0, &quot;radius&quot;: 5.9, &quot;stroke&quot;: true, &quot;weight&quot;: 3}
            ).addTo(map_d0465e53d4a5e8e5172c1ef0019ec0d0);
        
    
        var popup_354c66f93c07fdfa1490996debb4d275 = L.popup({
  &quot;maxWidth&quot;: &quot;100%&quot;,
});

        
            
                var html_476dc22d865545c2cc231d75c2da042b = $(`<div id=&quot;html_476dc22d865545c2cc231d75c2da042b&quot; style=&quot;width: 100.0%; height: 100.0%;&quot;>Year: 1989 Magnitude: 5.9, Depth: 11.3 km</div>`)[0];
                popup_354c66f93c07fdfa1490996debb4d275.setContent(html_476dc22d865545c2cc231d75c2da042b);
            
        

        circle_marker_87d1886c36162921604da16d4441b690.bindPopup(popup_354c66f93c07fdfa1490996debb4d275)
        ;

        
    
    
            var circle_marker_36513e0c9d90f6061b4e5f20e9b632d0 = L.circleMarker(
                [37.034, -24.374],
                {&quot;bubblingMouseEvents&quot;: true, &quot;color&quot;: &quot;blue&quot;, &quot;dashArray&quot;: null, &quot;dashOffset&quot;: null, &quot;fill&quot;: true, &quot;fillColor&quot;: &quot;blue&quot;, &quot;fillOpacity&quot;: 0.3, &quot;fillRule&quot;: &quot;evenodd&quot;, &quot;lineCap&quot;: &quot;round&quot;, &quot;lineJoin&quot;: &quot;round&quot;, &quot;opacity&quot;: 1.0, &quot;radius&quot;: 5.7, &quot;stroke&quot;: true, &quot;weight&quot;: 3}
            ).addTo(map_d0465e53d4a5e8e5172c1ef0019ec0d0);
        
    
        var popup_d6afa535594fd748fd4e8d45886fc35c = L.popup({
  &quot;maxWidth&quot;: &quot;100%&quot;,
});

        
            
                var html_e03b15e58ca8d2011963066b803e4a99 = $(`<div id=&quot;html_e03b15e58ca8d2011963066b803e4a99&quot; style=&quot;width: 100.0%; height: 100.0%;&quot;>Year: 1996 Magnitude: 5.7, Depth: 10.0 km</div>`)[0];
                popup_d6afa535594fd748fd4e8d45886fc35c.setContent(html_e03b15e58ca8d2011963066b803e4a99);
            
        

        circle_marker_36513e0c9d90f6061b4e5f20e9b632d0.bindPopup(popup_d6afa535594fd748fd4e8d45886fc35c)
        ;

        
    
    
            var circle_marker_c60974712cd860c2319179dcbafdde93 = L.circleMarker(
                [38.334, -26.684],
                {&quot;bubblingMouseEvents&quot;: true, &quot;color&quot;: &quot;blue&quot;, &quot;dashArray&quot;: null, &quot;dashOffset&quot;: null, &quot;fill&quot;: true, &quot;fillColor&quot;: &quot;blue&quot;, &quot;fillOpacity&quot;: 0.3, &quot;fillRule&quot;: &quot;evenodd&quot;, &quot;lineCap&quot;: &quot;round&quot;, &quot;lineJoin&quot;: &quot;round&quot;, &quot;opacity&quot;: 1.0, &quot;radius&quot;: 5.9, &quot;stroke&quot;: true, &quot;weight&quot;: 3}
            ).addTo(map_d0465e53d4a5e8e5172c1ef0019ec0d0);
        
    
        var popup_8eacd60f0ae0f3fc336e03b5de6b0ada = L.popup({
  &quot;maxWidth&quot;: &quot;100%&quot;,
});

        
            
                var html_d42b08fbb3ce9a91804dcc5c2a11998c = $(`<div id=&quot;html_d42b08fbb3ce9a91804dcc5c2a11998c&quot; style=&quot;width: 100.0%; height: 100.0%;&quot;>Year: 1997 Magnitude: 5.9, Depth: 10.0 km</div>`)[0];
                popup_8eacd60f0ae0f3fc336e03b5de6b0ada.setContent(html_d42b08fbb3ce9a91804dcc5c2a11998c);
            
        

        circle_marker_c60974712cd860c2319179dcbafdde93.bindPopup(popup_8eacd60f0ae0f3fc336e03b5de6b0ada)
        ;

        
    
    
            var circle_marker_4285ebeaf65a63765c510a6af1844a5a = L.circleMarker(
                [38.65, -28.626],
                {&quot;bubblingMouseEvents&quot;: true, &quot;color&quot;: &quot;blue&quot;, &quot;dashArray&quot;: null, &quot;dashOffset&quot;: null, &quot;fill&quot;: true, &quot;fillColor&quot;: &quot;blue&quot;, &quot;fillOpacity&quot;: 0.3, &quot;fillRule&quot;: &quot;evenodd&quot;, &quot;lineCap&quot;: &quot;round&quot;, &quot;lineJoin&quot;: &quot;round&quot;, &quot;opacity&quot;: 1.0, &quot;radius&quot;: 6.2, &quot;stroke&quot;: true, &quot;weight&quot;: 3}
            ).addTo(map_d0465e53d4a5e8e5172c1ef0019ec0d0);
        
    
        var popup_4cbc34187f34a147ec11c09768272904 = L.popup({
  &quot;maxWidth&quot;: &quot;100%&quot;,
});

        
            
                var html_8b644c448f43d4f7b38f67c07741d68d = $(`<div id=&quot;html_8b644c448f43d4f7b38f67c07741d68d&quot; style=&quot;width: 100.0%; height: 100.0%;&quot;>Year: 1998 Magnitude: 6.2, Depth: 10.0 km</div>`)[0];
                popup_4cbc34187f34a147ec11c09768272904.setContent(html_8b644c448f43d4f7b38f67c07741d68d);
            
        

        circle_marker_4285ebeaf65a63765c510a6af1844a5a.bindPopup(popup_4cbc34187f34a147ec11c09768272904)
        ;

        
    
    
            var circle_marker_3f3fd60b6754984a3f5a81596ee42bee = L.circleMarker(
                [40.135, -29.692],
                {&quot;bubblingMouseEvents&quot;: true, &quot;color&quot;: &quot;blue&quot;, &quot;dashArray&quot;: null, &quot;dashOffset&quot;: null, &quot;fill&quot;: true, &quot;fillColor&quot;: &quot;blue&quot;, &quot;fillOpacity&quot;: 0.3, &quot;fillRule&quot;: &quot;evenodd&quot;, &quot;lineCap&quot;: &quot;round&quot;, &quot;lineJoin&quot;: &quot;round&quot;, &quot;opacity&quot;: 1.0, &quot;radius&quot;: 5.6, &quot;stroke&quot;: true, &quot;weight&quot;: 3}
            ).addTo(map_d0465e53d4a5e8e5172c1ef0019ec0d0);
        
    
        var popup_90ff89daed854e5f1531dfeb5b22df9f = L.popup({
  &quot;maxWidth&quot;: &quot;100%&quot;,
});

        
            
                var html_27764bede0820ca1583804fa71b27638 = $(`<div id=&quot;html_27764bede0820ca1583804fa71b27638&quot; style=&quot;width: 100.0%; height: 100.0%;&quot;>Year: 2003 Magnitude: 5.6, Depth: 10.0 km</div>`)[0];
                popup_90ff89daed854e5f1531dfeb5b22df9f.setContent(html_27764bede0820ca1583804fa71b27638);
            
        

        circle_marker_3f3fd60b6754984a3f5a81596ee42bee.bindPopup(popup_90ff89daed854e5f1531dfeb5b22df9f)
        ;

        
    
    
            var circle_marker_9b5d5531372b32be225bf71e5b44d2b7 = L.circleMarker(
                [37.306, -24.621],
                {&quot;bubblingMouseEvents&quot;: true, &quot;color&quot;: &quot;blue&quot;, &quot;dashArray&quot;: null, &quot;dashOffset&quot;: null, &quot;fill&quot;: true, &quot;fillColor&quot;: &quot;blue&quot;, &quot;fillOpacity&quot;: 0.3, &quot;fillRule&quot;: &quot;evenodd&quot;, &quot;lineCap&quot;: &quot;round&quot;, &quot;lineJoin&quot;: &quot;round&quot;, &quot;opacity&quot;: 1.0, &quot;radius&quot;: 6.3, &quot;stroke&quot;: true, &quot;weight&quot;: 3}
            ).addTo(map_d0465e53d4a5e8e5172c1ef0019ec0d0);
        
    
        var popup_145cbc094cbdaad790a3ba329b3e0ed3 = L.popup({
  &quot;maxWidth&quot;: &quot;100%&quot;,
});

        
            
                var html_e706f9add15ba98c71aaabbb8d84b617 = $(`<div id=&quot;html_e706f9add15ba98c71aaabbb8d84b617&quot; style=&quot;width: 100.0%; height: 100.0%;&quot;>Year: 2007 Magnitude: 6.3, Depth: 14.0 km</div>`)[0];
                popup_145cbc094cbdaad790a3ba329b3e0ed3.setContent(html_e706f9add15ba98c71aaabbb8d84b617);
            
        

        circle_marker_9b5d5531372b32be225bf71e5b44d2b7.bindPopup(popup_145cbc094cbdaad790a3ba329b3e0ed3)
        ;

        
    
    
            var circle_marker_486d3ec6356a1890af57bb2774a22345 = L.circleMarker(
                [37.306, -24.494],
                {&quot;bubblingMouseEvents&quot;: true, &quot;color&quot;: &quot;blue&quot;, &quot;dashArray&quot;: null, &quot;dashOffset&quot;: null, &quot;fill&quot;: true, &quot;fillColor&quot;: &quot;blue&quot;, &quot;fillOpacity&quot;: 0.3, &quot;fillRule&quot;: &quot;evenodd&quot;, &quot;lineCap&quot;: &quot;round&quot;, &quot;lineJoin&quot;: &quot;round&quot;, &quot;opacity&quot;: 1.0, &quot;radius&quot;: 6.1, &quot;stroke&quot;: true, &quot;weight&quot;: 3}
            ).addTo(map_d0465e53d4a5e8e5172c1ef0019ec0d0);
        
    
        var popup_200c55409333ad1673a8254649445fd4 = L.popup({
  &quot;maxWidth&quot;: &quot;100%&quot;,
});

        
            
                var html_132b2245a4a894b114294b2ab0c77c13 = $(`<div id=&quot;html_132b2245a4a894b114294b2ab0c77c13&quot; style=&quot;width: 100.0%; height: 100.0%;&quot;>Year: 2007 Magnitude: 6.1, Depth: 8.0 km</div>`)[0];
                popup_200c55409333ad1673a8254649445fd4.setContent(html_132b2245a4a894b114294b2ab0c77c13);
            
        

        circle_marker_486d3ec6356a1890af57bb2774a22345.bindPopup(popup_200c55409333ad1673a8254649445fd4)
        ;

        
    
    
            var circle_marker_a2243d5d89f5e21264fa18a3e83435cc = L.circleMarker(
                [37.592, -24.913],
                {&quot;bubblingMouseEvents&quot;: true, &quot;color&quot;: &quot;blue&quot;, &quot;dashArray&quot;: null, &quot;dashOffset&quot;: null, &quot;fill&quot;: true, &quot;fillColor&quot;: &quot;blue&quot;, &quot;fillOpacity&quot;: 0.3, &quot;fillRule&quot;: &quot;evenodd&quot;, &quot;lineCap&quot;: &quot;round&quot;, &quot;lineJoin&quot;: &quot;round&quot;, &quot;opacity&quot;: 1.0, &quot;radius&quot;: 5.9, &quot;stroke&quot;: true, &quot;weight&quot;: 3}
            ).addTo(map_d0465e53d4a5e8e5172c1ef0019ec0d0);
        
    
        var popup_236e1821500e82972ff906945c100144 = L.popup({
  &quot;maxWidth&quot;: &quot;100%&quot;,
});

        
            
                var html_e3ca819c86562c409b61da9094d32806 = $(`<div id=&quot;html_e3ca819c86562c409b61da9094d32806&quot; style=&quot;width: 100.0%; height: 100.0%;&quot;>Year: 2013 Magnitude: 5.9, Depth: 10.0 km</div>`)[0];
                popup_236e1821500e82972ff906945c100144.setContent(html_e3ca819c86562c409b61da9094d32806);
            
        

        circle_marker_a2243d5d89f5e21264fa18a3e83435cc.bindPopup(popup_236e1821500e82972ff906945c100144)
        ;

        
    
</script>
</html>" style="position:absolute;width:100%;height:100%;left:0;top:0;border:none !important;" allowfullscreen="" webkitallowfullscreen="" mozallowfullscreen=""></iframe></div></div>
</div>
</div>
<p>The code above produces an interactive map which you can zoom in and out of, and click on the markers to see the details of each earthquake. To do so we follow a few steps:</p>
<ul>
<li>We create a <code>Map</code> object using the <code>folium</code> library, and set the center of the map roughly to the Azores islands.</li>
<li>We iterate over the rows of the <code>azores_earthquakes</code> dataframe with a <code>for</code> loop, and add a marker for each earthquake to the map.</li>
<li>We then display the map.</li>
</ul>
</section>
</section>
<section id="exercises" class="level2">
<h2 class="anchored" data-anchor-id="exercises">Exercises</h2>
<ol type="1">
<li>Calculate the average depth of the earthquakes that occurred in a given year.</li>
<li>Calculate the average number of stations that recorded an earthquake (you can uniquely identify an earthquake with the <code>ID</code> column) in a given year.</li>
<li>Calculate the average magnitude of the earthquakes that occurred in a given year, grouped by the <code>Type</code> column.</li>
<li>Explain the above code that creates a map of the earthquakes in the dataset. What does each line do?</li>
</ol>


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-reuse"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div class="quarto-appendix-contents"><div>This work is licensed under CC BY <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">(View License)</a></div></div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/pedroleitao\.nl");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Written with love, take time to think and ponder.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://quarto.org">
      <i class="bi bi-arrow-through-heart" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="http://www.frankscanteen.com">
      <i class="bi bi-cup-hot" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://www.instagram.com/bilhanovarestaurante">
      <i class="bi bi-egg-fried" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>
<script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




</body></html>